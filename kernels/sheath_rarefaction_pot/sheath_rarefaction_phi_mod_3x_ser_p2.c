#include <gkyl_sheath_rarefaction_pot_kernels.h> 


GKYL_CU_DH void sheath_rarefaction_phi_mod_kinetic_elc_lower_3x_ser_p2(double elem_q, double mElc, double tempElcBoltz, const double *momsElc, double mIon, const double *momsIon, const double *phiWall, double *phi) 
{ 
  // elem_q: elementary charge.
  // mElc: electron mass.
  // tempElcBoltz: electron temperature in Boltzmann electron model.
  // momsElc: m0, m1, m2par (and m2perp, but not used) moments of electrons.
  // mIon: ion mass.
  // momsIon: m0, m1, m2par (and m2perp, but not used) moments of ions.
  // phi: electrostatic potential.

  double phiNodal[20];
  phiNodal[0] = 2.371708245126284*phi[19]+2.371708245126284*phi[18]+2.371708245126284*phi[17]-1.369306393762915*phi[16]-1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]-1.369306393762915*phi[12]-1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]+1.060660171779821*phi[5]+1.060660171779821*phi[4]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[1] = -(1.185854122563142*phi[17])-1.369306393762915*phi[16]-1.369306393762915*phi[14]+0.6846531968814574*phi[13]+0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]+1.060660171779821*phi[6]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[2] = -(2.371708245126284*phi[19])-2.371708245126284*phi[18]+2.371708245126284*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]+1.369306393762915*phi[12]-1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]-1.060660171779821*phi[5]-1.060660171779821*phi[4]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[3] = -(1.185854122563142*phi[18])-1.369306393762915*phi[15]+0.6846531968814574*phi[14]-1.369306393762915*phi[13]+0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[5]-0.6123724356957944*phi[3]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[4] = 1.185854122563142*phi[18]+1.369306393762915*phi[15]+0.6846531968814574*phi[14]-1.369306393762915*phi[13]-0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[5]-0.6123724356957944*phi[3]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[5] = -(2.371708245126284*phi[19])+2.371708245126284*phi[18]-2.371708245126284*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]-1.369306393762915*phi[12]+1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]+1.060660171779821*phi[5]-1.060660171779821*phi[4]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[6] = 1.185854122563142*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[14]+0.6846531968814574*phi[13]-0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]-1.060660171779821*phi[6]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[7] = 2.371708245126284*phi[19]-2.371708245126284*phi[18]-2.371708245126284*phi[17]+1.369306393762915*phi[16]+1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]+1.369306393762915*phi[12]+1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]-1.060660171779821*phi[5]+1.060660171779821*phi[4]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[8] = -(1.185854122563142*phi[19])+0.6846531968814574*phi[16]+0.6846531968814574*phi[15]-1.369306393762915*phi[12]-1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[4]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[9] = 1.185854122563142*phi[19]+0.6846531968814574*phi[16]-0.6846531968814574*phi[15]+1.369306393762915*phi[12]-1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[4]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[10] = 1.185854122563142*phi[19]-0.6846531968814574*phi[16]+0.6846531968814574*phi[15]-1.369306393762915*phi[12]+1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[4]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[11] = -(1.185854122563142*phi[19])-0.6846531968814574*phi[16]-0.6846531968814574*phi[15]+1.369306393762915*phi[12]+1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[4]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[12] = 2.371708245126284*phi[19]-2.371708245126284*phi[18]-2.371708245126284*phi[17]-1.369306393762915*phi[16]-1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]-1.369306393762915*phi[12]-1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]-1.060660171779821*phi[5]+1.060660171779821*phi[4]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[13] = 1.185854122563142*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[14]-0.6846531968814574*phi[13]+0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]-1.060660171779821*phi[6]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[14] = -(2.371708245126284*phi[19])+2.371708245126284*phi[18]-2.371708245126284*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]+1.369306393762915*phi[12]-1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]+1.060660171779821*phi[5]-1.060660171779821*phi[4]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[15] = 1.185854122563142*phi[18]-1.369306393762915*phi[15]-0.6846531968814574*phi[14]+1.369306393762915*phi[13]+0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[5]+0.6123724356957944*phi[3]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[16] = -(1.185854122563142*phi[18])+1.369306393762915*phi[15]-0.6846531968814574*phi[14]+1.369306393762915*phi[13]-0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[5]+0.6123724356957944*phi[3]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[17] = -(2.371708245126284*phi[19])-2.371708245126284*phi[18]+2.371708245126284*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]-1.369306393762915*phi[12]+1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]-1.060660171779821*phi[5]-1.060660171779821*phi[4]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[18] = -(1.185854122563142*phi[17])+1.369306393762915*phi[16]+1.369306393762915*phi[14]-0.6846531968814574*phi[13]-0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]+1.060660171779821*phi[6]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[19] = 2.371708245126284*phi[19]+2.371708245126284*phi[18]+2.371708245126284*phi[17]+1.369306393762915*phi[16]+1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]+1.369306393762915*phi[12]+1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]+1.060660171779821*phi[5]+1.060660171779821*phi[4]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 

  const double *m0Ion = &momsIon[0];
  const double *m1Ion = &momsIon[20];
  const double *m2parIon = &momsIon[40];

  double m0iSurfNodal[8];
  double m1iSurfNodal[8];
  double m2pariSurfNodal[8];
  m0iSurfNodal[0] = 2.371708245126284*m0Ion[19]+2.371708245126284*m0Ion[18]+2.371708245126284*m0Ion[17]-1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[15]-1.369306393762915*m0Ion[14]-1.369306393762915*m0Ion[13]-1.369306393762915*m0Ion[12]-1.369306393762915*m0Ion[11]-1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[6]+1.060660171779821*m0Ion[5]+1.060660171779821*m0Ion[4]-0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[1] = -(1.185854122563142*m0Ion[17])-1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[14]+0.6846531968814574*m0Ion[13]+0.6846531968814574*m0Ion[11]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]-0.3952847075210473*m0Ion[7]+1.060660171779821*m0Ion[6]-0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[2] = -(2.371708245126284*m0Ion[19])-2.371708245126284*m0Ion[18]+2.371708245126284*m0Ion[17]-1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[15]-1.369306393762915*m0Ion[14]-1.369306393762915*m0Ion[13]+1.369306393762915*m0Ion[12]-1.369306393762915*m0Ion[11]+1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[6]-1.060660171779821*m0Ion[5]-1.060660171779821*m0Ion[4]-0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[3] = -(1.185854122563142*m0Ion[18])-1.369306393762915*m0Ion[15]+0.6846531968814574*m0Ion[14]-1.369306393762915*m0Ion[13]+0.6846531968814574*m0Ion[12]+0.7905694150420947*m0Ion[9]-0.3952847075210473*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[5]-0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[4] = 1.185854122563142*m0Ion[18]+1.369306393762915*m0Ion[15]+0.6846531968814574*m0Ion[14]-1.369306393762915*m0Ion[13]-0.6846531968814574*m0Ion[12]+0.7905694150420947*m0Ion[9]-0.3952847075210473*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[5]-0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[5] = -(2.371708245126284*m0Ion[19])+2.371708245126284*m0Ion[18]-2.371708245126284*m0Ion[17]+1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[15]-1.369306393762915*m0Ion[14]-1.369306393762915*m0Ion[13]-1.369306393762915*m0Ion[12]+1.369306393762915*m0Ion[11]+1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[6]+1.060660171779821*m0Ion[5]-1.060660171779821*m0Ion[4]-0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[6] = 1.185854122563142*m0Ion[17]+1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[14]+0.6846531968814574*m0Ion[13]-0.6846531968814574*m0Ion[11]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]-0.3952847075210473*m0Ion[7]-1.060660171779821*m0Ion[6]-0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[7] = 2.371708245126284*m0Ion[19]-2.371708245126284*m0Ion[18]-2.371708245126284*m0Ion[17]+1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[15]-1.369306393762915*m0Ion[14]-1.369306393762915*m0Ion[13]+1.369306393762915*m0Ion[12]+1.369306393762915*m0Ion[11]-1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[6]-1.060660171779821*m0Ion[5]+1.060660171779821*m0Ion[4]-0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m1iSurfNodal[0] = 2.371708245126284*m1Ion[19]+2.371708245126284*m1Ion[18]+2.371708245126284*m1Ion[17]-1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[15]-1.369306393762915*m1Ion[14]-1.369306393762915*m1Ion[13]-1.369306393762915*m1Ion[12]-1.369306393762915*m1Ion[11]-1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[6]+1.060660171779821*m1Ion[5]+1.060660171779821*m1Ion[4]-0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[1] = -(1.185854122563142*m1Ion[17])-1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[14]+0.6846531968814574*m1Ion[13]+0.6846531968814574*m1Ion[11]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]-0.3952847075210473*m1Ion[7]+1.060660171779821*m1Ion[6]-0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[2] = -(2.371708245126284*m1Ion[19])-2.371708245126284*m1Ion[18]+2.371708245126284*m1Ion[17]-1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[15]-1.369306393762915*m1Ion[14]-1.369306393762915*m1Ion[13]+1.369306393762915*m1Ion[12]-1.369306393762915*m1Ion[11]+1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[6]-1.060660171779821*m1Ion[5]-1.060660171779821*m1Ion[4]-0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[3] = -(1.185854122563142*m1Ion[18])-1.369306393762915*m1Ion[15]+0.6846531968814574*m1Ion[14]-1.369306393762915*m1Ion[13]+0.6846531968814574*m1Ion[12]+0.7905694150420947*m1Ion[9]-0.3952847075210473*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[5]-0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[4] = 1.185854122563142*m1Ion[18]+1.369306393762915*m1Ion[15]+0.6846531968814574*m1Ion[14]-1.369306393762915*m1Ion[13]-0.6846531968814574*m1Ion[12]+0.7905694150420947*m1Ion[9]-0.3952847075210473*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[5]-0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[5] = -(2.371708245126284*m1Ion[19])+2.371708245126284*m1Ion[18]-2.371708245126284*m1Ion[17]+1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[15]-1.369306393762915*m1Ion[14]-1.369306393762915*m1Ion[13]-1.369306393762915*m1Ion[12]+1.369306393762915*m1Ion[11]+1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[6]+1.060660171779821*m1Ion[5]-1.060660171779821*m1Ion[4]-0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[6] = 1.185854122563142*m1Ion[17]+1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[14]+0.6846531968814574*m1Ion[13]-0.6846531968814574*m1Ion[11]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]-0.3952847075210473*m1Ion[7]-1.060660171779821*m1Ion[6]-0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[7] = 2.371708245126284*m1Ion[19]-2.371708245126284*m1Ion[18]-2.371708245126284*m1Ion[17]+1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[15]-1.369306393762915*m1Ion[14]-1.369306393762915*m1Ion[13]+1.369306393762915*m1Ion[12]+1.369306393762915*m1Ion[11]-1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[6]-1.060660171779821*m1Ion[5]+1.060660171779821*m1Ion[4]-0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m2pariSurfNodal[0] = 2.371708245126284*m2parIon[19]+2.371708245126284*m2parIon[18]+2.371708245126284*m2parIon[17]-1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[15]-1.369306393762915*m2parIon[14]-1.369306393762915*m2parIon[13]-1.369306393762915*m2parIon[12]-1.369306393762915*m2parIon[11]-1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[6]+1.060660171779821*m2parIon[5]+1.060660171779821*m2parIon[4]-0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[1] = -(1.185854122563142*m2parIon[17])-1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[14]+0.6846531968814574*m2parIon[13]+0.6846531968814574*m2parIon[11]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]-0.3952847075210473*m2parIon[7]+1.060660171779821*m2parIon[6]-0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[2] = -(2.371708245126284*m2parIon[19])-2.371708245126284*m2parIon[18]+2.371708245126284*m2parIon[17]-1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[15]-1.369306393762915*m2parIon[14]-1.369306393762915*m2parIon[13]+1.369306393762915*m2parIon[12]-1.369306393762915*m2parIon[11]+1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[6]-1.060660171779821*m2parIon[5]-1.060660171779821*m2parIon[4]-0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[3] = -(1.185854122563142*m2parIon[18])-1.369306393762915*m2parIon[15]+0.6846531968814574*m2parIon[14]-1.369306393762915*m2parIon[13]+0.6846531968814574*m2parIon[12]+0.7905694150420947*m2parIon[9]-0.3952847075210473*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[5]-0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[4] = 1.185854122563142*m2parIon[18]+1.369306393762915*m2parIon[15]+0.6846531968814574*m2parIon[14]-1.369306393762915*m2parIon[13]-0.6846531968814574*m2parIon[12]+0.7905694150420947*m2parIon[9]-0.3952847075210473*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[5]-0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[5] = -(2.371708245126284*m2parIon[19])+2.371708245126284*m2parIon[18]-2.371708245126284*m2parIon[17]+1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[15]-1.369306393762915*m2parIon[14]-1.369306393762915*m2parIon[13]-1.369306393762915*m2parIon[12]+1.369306393762915*m2parIon[11]+1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[6]+1.060660171779821*m2parIon[5]-1.060660171779821*m2parIon[4]-0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[6] = 1.185854122563142*m2parIon[17]+1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[14]+0.6846531968814574*m2parIon[13]-0.6846531968814574*m2parIon[11]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]-0.3952847075210473*m2parIon[7]-1.060660171779821*m2parIon[6]-0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[7] = 2.371708245126284*m2parIon[19]-2.371708245126284*m2parIon[18]-2.371708245126284*m2parIon[17]+1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[15]-1.369306393762915*m2parIon[14]-1.369306393762915*m2parIon[13]+1.369306393762915*m2parIon[12]+1.369306393762915*m2parIon[11]-1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[6]-1.060660171779821*m2parIon[5]+1.060660171779821*m2parIon[4]-0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 

  const double *m0Elc = &momsElc[0];
  const double *m1Elc = &momsElc[20];
  const double *m2parElc = &momsElc[40];

  double m0eSurfNodal[8];
  double m1eSurfNodal[8];
  double m2pareSurfNodal[8];
  m0eSurfNodal[0] = 2.371708245126284*m0Elc[19]+2.371708245126284*m0Elc[18]+2.371708245126284*m0Elc[17]-1.369306393762915*m0Elc[16]-1.369306393762915*m0Elc[15]-1.369306393762915*m0Elc[14]-1.369306393762915*m0Elc[13]-1.369306393762915*m0Elc[12]-1.369306393762915*m0Elc[11]-1.837117307087383*m0Elc[10]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]+0.7905694150420947*m0Elc[7]+1.060660171779821*m0Elc[6]+1.060660171779821*m0Elc[5]+1.060660171779821*m0Elc[4]-0.6123724356957944*m0Elc[3]-0.6123724356957944*m0Elc[2]-0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[1] = -(1.185854122563142*m0Elc[17])-1.369306393762915*m0Elc[16]-1.369306393762915*m0Elc[14]+0.6846531968814574*m0Elc[13]+0.6846531968814574*m0Elc[11]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]-0.3952847075210473*m0Elc[7]+1.060660171779821*m0Elc[6]-0.6123724356957944*m0Elc[3]-0.6123724356957944*m0Elc[2]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[2] = -(2.371708245126284*m0Elc[19])-2.371708245126284*m0Elc[18]+2.371708245126284*m0Elc[17]-1.369306393762915*m0Elc[16]+1.369306393762915*m0Elc[15]-1.369306393762915*m0Elc[14]-1.369306393762915*m0Elc[13]+1.369306393762915*m0Elc[12]-1.369306393762915*m0Elc[11]+1.837117307087383*m0Elc[10]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]+0.7905694150420947*m0Elc[7]+1.060660171779821*m0Elc[6]-1.060660171779821*m0Elc[5]-1.060660171779821*m0Elc[4]-0.6123724356957944*m0Elc[3]-0.6123724356957944*m0Elc[2]+0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[3] = -(1.185854122563142*m0Elc[18])-1.369306393762915*m0Elc[15]+0.6846531968814574*m0Elc[14]-1.369306393762915*m0Elc[13]+0.6846531968814574*m0Elc[12]+0.7905694150420947*m0Elc[9]-0.3952847075210473*m0Elc[8]+0.7905694150420947*m0Elc[7]+1.060660171779821*m0Elc[5]-0.6123724356957944*m0Elc[3]-0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[4] = 1.185854122563142*m0Elc[18]+1.369306393762915*m0Elc[15]+0.6846531968814574*m0Elc[14]-1.369306393762915*m0Elc[13]-0.6846531968814574*m0Elc[12]+0.7905694150420947*m0Elc[9]-0.3952847075210473*m0Elc[8]+0.7905694150420947*m0Elc[7]-1.060660171779821*m0Elc[5]-0.6123724356957944*m0Elc[3]+0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[5] = -(2.371708245126284*m0Elc[19])+2.371708245126284*m0Elc[18]-2.371708245126284*m0Elc[17]+1.369306393762915*m0Elc[16]-1.369306393762915*m0Elc[15]-1.369306393762915*m0Elc[14]-1.369306393762915*m0Elc[13]-1.369306393762915*m0Elc[12]+1.369306393762915*m0Elc[11]+1.837117307087383*m0Elc[10]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]+0.7905694150420947*m0Elc[7]-1.060660171779821*m0Elc[6]+1.060660171779821*m0Elc[5]-1.060660171779821*m0Elc[4]-0.6123724356957944*m0Elc[3]+0.6123724356957944*m0Elc[2]-0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[6] = 1.185854122563142*m0Elc[17]+1.369306393762915*m0Elc[16]-1.369306393762915*m0Elc[14]+0.6846531968814574*m0Elc[13]-0.6846531968814574*m0Elc[11]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]-0.3952847075210473*m0Elc[7]-1.060660171779821*m0Elc[6]-0.6123724356957944*m0Elc[3]+0.6123724356957944*m0Elc[2]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[7] = 2.371708245126284*m0Elc[19]-2.371708245126284*m0Elc[18]-2.371708245126284*m0Elc[17]+1.369306393762915*m0Elc[16]+1.369306393762915*m0Elc[15]-1.369306393762915*m0Elc[14]-1.369306393762915*m0Elc[13]+1.369306393762915*m0Elc[12]+1.369306393762915*m0Elc[11]-1.837117307087383*m0Elc[10]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]+0.7905694150420947*m0Elc[7]-1.060660171779821*m0Elc[6]-1.060660171779821*m0Elc[5]+1.060660171779821*m0Elc[4]-0.6123724356957944*m0Elc[3]+0.6123724356957944*m0Elc[2]+0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m1eSurfNodal[0] = 2.371708245126284*m1Elc[19]+2.371708245126284*m1Elc[18]+2.371708245126284*m1Elc[17]-1.369306393762915*m1Elc[16]-1.369306393762915*m1Elc[15]-1.369306393762915*m1Elc[14]-1.369306393762915*m1Elc[13]-1.369306393762915*m1Elc[12]-1.369306393762915*m1Elc[11]-1.837117307087383*m1Elc[10]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]+0.7905694150420947*m1Elc[7]+1.060660171779821*m1Elc[6]+1.060660171779821*m1Elc[5]+1.060660171779821*m1Elc[4]-0.6123724356957944*m1Elc[3]-0.6123724356957944*m1Elc[2]-0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[1] = -(1.185854122563142*m1Elc[17])-1.369306393762915*m1Elc[16]-1.369306393762915*m1Elc[14]+0.6846531968814574*m1Elc[13]+0.6846531968814574*m1Elc[11]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]-0.3952847075210473*m1Elc[7]+1.060660171779821*m1Elc[6]-0.6123724356957944*m1Elc[3]-0.6123724356957944*m1Elc[2]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[2] = -(2.371708245126284*m1Elc[19])-2.371708245126284*m1Elc[18]+2.371708245126284*m1Elc[17]-1.369306393762915*m1Elc[16]+1.369306393762915*m1Elc[15]-1.369306393762915*m1Elc[14]-1.369306393762915*m1Elc[13]+1.369306393762915*m1Elc[12]-1.369306393762915*m1Elc[11]+1.837117307087383*m1Elc[10]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]+0.7905694150420947*m1Elc[7]+1.060660171779821*m1Elc[6]-1.060660171779821*m1Elc[5]-1.060660171779821*m1Elc[4]-0.6123724356957944*m1Elc[3]-0.6123724356957944*m1Elc[2]+0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[3] = -(1.185854122563142*m1Elc[18])-1.369306393762915*m1Elc[15]+0.6846531968814574*m1Elc[14]-1.369306393762915*m1Elc[13]+0.6846531968814574*m1Elc[12]+0.7905694150420947*m1Elc[9]-0.3952847075210473*m1Elc[8]+0.7905694150420947*m1Elc[7]+1.060660171779821*m1Elc[5]-0.6123724356957944*m1Elc[3]-0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[4] = 1.185854122563142*m1Elc[18]+1.369306393762915*m1Elc[15]+0.6846531968814574*m1Elc[14]-1.369306393762915*m1Elc[13]-0.6846531968814574*m1Elc[12]+0.7905694150420947*m1Elc[9]-0.3952847075210473*m1Elc[8]+0.7905694150420947*m1Elc[7]-1.060660171779821*m1Elc[5]-0.6123724356957944*m1Elc[3]+0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[5] = -(2.371708245126284*m1Elc[19])+2.371708245126284*m1Elc[18]-2.371708245126284*m1Elc[17]+1.369306393762915*m1Elc[16]-1.369306393762915*m1Elc[15]-1.369306393762915*m1Elc[14]-1.369306393762915*m1Elc[13]-1.369306393762915*m1Elc[12]+1.369306393762915*m1Elc[11]+1.837117307087383*m1Elc[10]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]+0.7905694150420947*m1Elc[7]-1.060660171779821*m1Elc[6]+1.060660171779821*m1Elc[5]-1.060660171779821*m1Elc[4]-0.6123724356957944*m1Elc[3]+0.6123724356957944*m1Elc[2]-0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[6] = 1.185854122563142*m1Elc[17]+1.369306393762915*m1Elc[16]-1.369306393762915*m1Elc[14]+0.6846531968814574*m1Elc[13]-0.6846531968814574*m1Elc[11]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]-0.3952847075210473*m1Elc[7]-1.060660171779821*m1Elc[6]-0.6123724356957944*m1Elc[3]+0.6123724356957944*m1Elc[2]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[7] = 2.371708245126284*m1Elc[19]-2.371708245126284*m1Elc[18]-2.371708245126284*m1Elc[17]+1.369306393762915*m1Elc[16]+1.369306393762915*m1Elc[15]-1.369306393762915*m1Elc[14]-1.369306393762915*m1Elc[13]+1.369306393762915*m1Elc[12]+1.369306393762915*m1Elc[11]-1.837117307087383*m1Elc[10]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]+0.7905694150420947*m1Elc[7]-1.060660171779821*m1Elc[6]-1.060660171779821*m1Elc[5]+1.060660171779821*m1Elc[4]-0.6123724356957944*m1Elc[3]+0.6123724356957944*m1Elc[2]+0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m2pareSurfNodal[0] = 2.371708245126284*m2parElc[19]+2.371708245126284*m2parElc[18]+2.371708245126284*m2parElc[17]-1.369306393762915*m2parElc[16]-1.369306393762915*m2parElc[15]-1.369306393762915*m2parElc[14]-1.369306393762915*m2parElc[13]-1.369306393762915*m2parElc[12]-1.369306393762915*m2parElc[11]-1.837117307087383*m2parElc[10]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]+0.7905694150420947*m2parElc[7]+1.060660171779821*m2parElc[6]+1.060660171779821*m2parElc[5]+1.060660171779821*m2parElc[4]-0.6123724356957944*m2parElc[3]-0.6123724356957944*m2parElc[2]-0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[1] = -(1.185854122563142*m2parElc[17])-1.369306393762915*m2parElc[16]-1.369306393762915*m2parElc[14]+0.6846531968814574*m2parElc[13]+0.6846531968814574*m2parElc[11]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]-0.3952847075210473*m2parElc[7]+1.060660171779821*m2parElc[6]-0.6123724356957944*m2parElc[3]-0.6123724356957944*m2parElc[2]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[2] = -(2.371708245126284*m2parElc[19])-2.371708245126284*m2parElc[18]+2.371708245126284*m2parElc[17]-1.369306393762915*m2parElc[16]+1.369306393762915*m2parElc[15]-1.369306393762915*m2parElc[14]-1.369306393762915*m2parElc[13]+1.369306393762915*m2parElc[12]-1.369306393762915*m2parElc[11]+1.837117307087383*m2parElc[10]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]+0.7905694150420947*m2parElc[7]+1.060660171779821*m2parElc[6]-1.060660171779821*m2parElc[5]-1.060660171779821*m2parElc[4]-0.6123724356957944*m2parElc[3]-0.6123724356957944*m2parElc[2]+0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[3] = -(1.185854122563142*m2parElc[18])-1.369306393762915*m2parElc[15]+0.6846531968814574*m2parElc[14]-1.369306393762915*m2parElc[13]+0.6846531968814574*m2parElc[12]+0.7905694150420947*m2parElc[9]-0.3952847075210473*m2parElc[8]+0.7905694150420947*m2parElc[7]+1.060660171779821*m2parElc[5]-0.6123724356957944*m2parElc[3]-0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[4] = 1.185854122563142*m2parElc[18]+1.369306393762915*m2parElc[15]+0.6846531968814574*m2parElc[14]-1.369306393762915*m2parElc[13]-0.6846531968814574*m2parElc[12]+0.7905694150420947*m2parElc[9]-0.3952847075210473*m2parElc[8]+0.7905694150420947*m2parElc[7]-1.060660171779821*m2parElc[5]-0.6123724356957944*m2parElc[3]+0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[5] = -(2.371708245126284*m2parElc[19])+2.371708245126284*m2parElc[18]-2.371708245126284*m2parElc[17]+1.369306393762915*m2parElc[16]-1.369306393762915*m2parElc[15]-1.369306393762915*m2parElc[14]-1.369306393762915*m2parElc[13]-1.369306393762915*m2parElc[12]+1.369306393762915*m2parElc[11]+1.837117307087383*m2parElc[10]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]+0.7905694150420947*m2parElc[7]-1.060660171779821*m2parElc[6]+1.060660171779821*m2parElc[5]-1.060660171779821*m2parElc[4]-0.6123724356957944*m2parElc[3]+0.6123724356957944*m2parElc[2]-0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[6] = 1.185854122563142*m2parElc[17]+1.369306393762915*m2parElc[16]-1.369306393762915*m2parElc[14]+0.6846531968814574*m2parElc[13]-0.6846531968814574*m2parElc[11]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]-0.3952847075210473*m2parElc[7]-1.060660171779821*m2parElc[6]-0.6123724356957944*m2parElc[3]+0.6123724356957944*m2parElc[2]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[7] = 2.371708245126284*m2parElc[19]-2.371708245126284*m2parElc[18]-2.371708245126284*m2parElc[17]+1.369306393762915*m2parElc[16]+1.369306393762915*m2parElc[15]-1.369306393762915*m2parElc[14]-1.369306393762915*m2parElc[13]+1.369306393762915*m2parElc[12]+1.369306393762915*m2parElc[11]-1.837117307087383*m2parElc[10]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]+0.7905694150420947*m2parElc[7]-1.060660171779821*m2parElc[6]-1.060660171779821*m2parElc[5]+1.060660171779821*m2parElc[4]-0.6123724356957944*m2parElc[3]+0.6123724356957944*m2parElc[2]+0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 

  double phiWallNodal[8];
  phiWallNodal[0] = -(1.9364916731037085*phiWall[7])-1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]+1.5*phiWall[3]-0.8660254037844386*phiWall[2]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[1] = 0.9682458365518543*phiWall[6]+1.118033988749895*phiWall[5]-0.5590169943749475*phiWall[4]-0.8660254037844386*phiWall[2]+0.5*phiWall[0]; 
  phiWallNodal[2] = 1.9364916731037085*phiWall[7]-1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]-1.5*phiWall[3]-0.8660254037844386*phiWall[2]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[3] = 0.9682458365518543*phiWall[7]-0.5590169943749475*phiWall[5]+1.118033988749895*phiWall[4]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[4] = -(0.9682458365518543*phiWall[7])-0.5590169943749475*phiWall[5]+1.118033988749895*phiWall[4]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[5] = -(1.9364916731037085*phiWall[7])+1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]-1.5*phiWall[3]+0.8660254037844386*phiWall[2]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[6] = -(0.9682458365518543*phiWall[6])+1.118033988749895*phiWall[5]-0.5590169943749475*phiWall[4]+0.8660254037844386*phiWall[2]+0.5*phiWall[0]; 
  phiWallNodal[7] = 1.9364916731037085*phiWall[7]+1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]+1.5*phiWall[3]+0.8660254037844386*phiWall[2]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 

  double upar_i;
  double Tpar_i;
  double upar_e;
  double Tpar_e;
  double c_s;
  double Delta_phi_r;

  upar_i = m1iSurfNodal[0]/m0iSurfNodal[0];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[0]*mIon*upar_i-1.0*m2pariSurfNodal[0]*mIon))/m0iSurfNodal[0]));

  upar_e = m1eSurfNodal[0]/m0eSurfNodal[0];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[0]*mElc*upar_e-1.0*m2pareSurfNodal[0]*mElc))/m0eSurfNodal[0]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[0] = fmax(phiNodal[0] + Delta_phi_r, phiWallNodal[0]);

  upar_i = m1iSurfNodal[1]/m0iSurfNodal[1];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[1]*mIon*upar_i-1.0*m2pariSurfNodal[1]*mIon))/m0iSurfNodal[1]));

  upar_e = m1eSurfNodal[1]/m0eSurfNodal[1];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[1]*mElc*upar_e-1.0*m2pareSurfNodal[1]*mElc))/m0eSurfNodal[1]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[1] = fmax(phiNodal[1] + Delta_phi_r, phiWallNodal[1]);

  upar_i = m1iSurfNodal[2]/m0iSurfNodal[2];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[2]*mIon*upar_i-1.0*m2pariSurfNodal[2]*mIon))/m0iSurfNodal[2]));

  upar_e = m1eSurfNodal[2]/m0eSurfNodal[2];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[2]*mElc*upar_e-1.0*m2pareSurfNodal[2]*mElc))/m0eSurfNodal[2]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[2] = fmax(phiNodal[2] + Delta_phi_r, phiWallNodal[2]);

  upar_i = m1iSurfNodal[3]/m0iSurfNodal[3];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[3]*mIon*upar_i-1.0*m2pariSurfNodal[3]*mIon))/m0iSurfNodal[3]));

  upar_e = m1eSurfNodal[3]/m0eSurfNodal[3];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[3]*mElc*upar_e-1.0*m2pareSurfNodal[3]*mElc))/m0eSurfNodal[3]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[3] = fmax(phiNodal[3] + Delta_phi_r, phiWallNodal[3]);

  upar_i = m1iSurfNodal[4]/m0iSurfNodal[4];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[4]*mIon*upar_i-1.0*m2pariSurfNodal[4]*mIon))/m0iSurfNodal[4]));

  upar_e = m1eSurfNodal[4]/m0eSurfNodal[4];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[4]*mElc*upar_e-1.0*m2pareSurfNodal[4]*mElc))/m0eSurfNodal[4]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[4] = fmax(phiNodal[4] + Delta_phi_r, phiWallNodal[4]);

  upar_i = m1iSurfNodal[5]/m0iSurfNodal[5];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[5]*mIon*upar_i-1.0*m2pariSurfNodal[5]*mIon))/m0iSurfNodal[5]));

  upar_e = m1eSurfNodal[5]/m0eSurfNodal[5];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[5]*mElc*upar_e-1.0*m2pareSurfNodal[5]*mElc))/m0eSurfNodal[5]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[5] = fmax(phiNodal[5] + Delta_phi_r, phiWallNodal[5]);

  upar_i = m1iSurfNodal[6]/m0iSurfNodal[6];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[6]*mIon*upar_i-1.0*m2pariSurfNodal[6]*mIon))/m0iSurfNodal[6]));

  upar_e = m1eSurfNodal[6]/m0eSurfNodal[6];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[6]*mElc*upar_e-1.0*m2pareSurfNodal[6]*mElc))/m0eSurfNodal[6]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[6] = fmax(phiNodal[6] + Delta_phi_r, phiWallNodal[6]);

  upar_i = m1iSurfNodal[7]/m0iSurfNodal[7];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[7]*mIon*upar_i-1.0*m2pariSurfNodal[7]*mIon))/m0iSurfNodal[7]));

  upar_e = m1eSurfNodal[7]/m0eSurfNodal[7];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[7]*mElc*upar_e-1.0*m2pareSurfNodal[7]*mElc))/m0eSurfNodal[7]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[7] = fmax(phiNodal[7] + Delta_phi_r, phiWallNodal[7]);

  phi[0] = -(0.3535533905932737*phiNodal[19])+0.4714045207910317*phiNodal[18]-0.3535533905932737*phiNodal[17]+0.4714045207910317*phiNodal[16]+0.4714045207910317*phiNodal[15]-0.3535533905932737*phiNodal[14]+0.4714045207910317*phiNodal[13]-0.3535533905932737*phiNodal[12]+0.4714045207910317*phiNodal[11]+0.4714045207910317*phiNodal[10]+0.4714045207910317*phiNodal[9]+0.4714045207910317*phiNodal[8]-0.3535533905932737*phiNodal[7]+0.4714045207910317*phiNodal[6]-0.3535533905932737*phiNodal[5]+0.4714045207910317*phiNodal[4]+0.4714045207910317*phiNodal[3]-0.3535533905932737*phiNodal[2]+0.4714045207910317*phiNodal[1]-0.3535533905932737*phiNodal[0]; 
  phi[1] = -(0.06804138174397717*phiNodal[19])+0.06804138174397717*phiNodal[17]+0.27216552697590873*phiNodal[16]-0.27216552697590873*phiNodal[15]-0.06804138174397717*phiNodal[14]+0.06804138174397717*phiNodal[12]+0.27216552697590873*phiNodal[11]-0.27216552697590873*phiNodal[10]+0.27216552697590873*phiNodal[9]-0.27216552697590873*phiNodal[8]-0.06804138174397717*phiNodal[7]+0.06804138174397717*phiNodal[5]+0.27216552697590873*phiNodal[4]-0.27216552697590873*phiNodal[3]-0.06804138174397717*phiNodal[2]+0.06804138174397717*phiNodal[0]; 
  phi[2] = -(0.06804138174397717*phiNodal[19])+0.27216552697590873*phiNodal[18]-0.06804138174397717*phiNodal[17]+0.06804138174397717*phiNodal[14]-0.27216552697590873*phiNodal[13]+0.06804138174397717*phiNodal[12]+0.27216552697590873*phiNodal[11]+0.27216552697590873*phiNodal[10]-0.27216552697590873*phiNodal[9]-0.27216552697590873*phiNodal[8]-0.06804138174397717*phiNodal[7]+0.27216552697590873*phiNodal[6]-0.06804138174397717*phiNodal[5]+0.06804138174397717*phiNodal[2]-0.27216552697590873*phiNodal[1]+0.06804138174397717*phiNodal[0]; 
  phi[3] = -(0.06804138174397717*phiNodal[19])+0.27216552697590873*phiNodal[18]-0.06804138174397717*phiNodal[17]+0.27216552697590873*phiNodal[16]+0.27216552697590873*phiNodal[15]-0.06804138174397717*phiNodal[14]+0.27216552697590873*phiNodal[13]-0.06804138174397717*phiNodal[12]+0.06804138174397717*phiNodal[7]-0.27216552697590873*phiNodal[6]+0.06804138174397717*phiNodal[5]-0.27216552697590873*phiNodal[4]-0.27216552697590873*phiNodal[3]+0.06804138174397717*phiNodal[2]-0.27216552697590873*phiNodal[1]+0.06804138174397717*phiNodal[0]; 
  phi[4] = 0.0392837100659193*phiNodal[19]-0.0392837100659193*phiNodal[17]-0.0392837100659193*phiNodal[14]+0.0392837100659193*phiNodal[12]+0.15713484026367722*phiNodal[11]-0.15713484026367722*phiNodal[10]-0.15713484026367722*phiNodal[9]+0.15713484026367722*phiNodal[8]+0.0392837100659193*phiNodal[7]-0.0392837100659193*phiNodal[5]-0.0392837100659193*phiNodal[2]+0.0392837100659193*phiNodal[0]; 
  phi[5] = 0.0392837100659193*phiNodal[19]-0.0392837100659193*phiNodal[17]+0.15713484026367722*phiNodal[16]-0.15713484026367722*phiNodal[15]+0.0392837100659193*phiNodal[14]-0.0392837100659193*phiNodal[12]-0.0392837100659193*phiNodal[7]+0.0392837100659193*phiNodal[5]-0.15713484026367722*phiNodal[4]+0.15713484026367722*phiNodal[3]-0.0392837100659193*phiNodal[2]+0.0392837100659193*phiNodal[0]; 
  phi[6] = 0.0392837100659193*phiNodal[19]+0.15713484026367722*phiNodal[18]+0.0392837100659193*phiNodal[17]-0.0392837100659193*phiNodal[14]-0.15713484026367722*phiNodal[13]-0.0392837100659193*phiNodal[12]-0.0392837100659193*phiNodal[7]-0.15713484026367722*phiNodal[6]-0.0392837100659193*phiNodal[5]+0.0392837100659193*phiNodal[2]+0.15713484026367722*phiNodal[1]+0.0392837100659193*phiNodal[0]; 
  phi[7] = 0.10540925533894596*phiNodal[19]-0.21081851067789195*phiNodal[18]+0.10540925533894596*phiNodal[17]+0.10540925533894596*phiNodal[14]-0.21081851067789195*phiNodal[13]+0.10540925533894596*phiNodal[12]+0.10540925533894596*phiNodal[7]-0.21081851067789195*phiNodal[6]+0.10540925533894596*phiNodal[5]+0.10540925533894596*phiNodal[2]-0.21081851067789195*phiNodal[1]+0.10540925533894596*phiNodal[0]; 
  phi[8] = 0.10540925533894596*phiNodal[19]+0.10540925533894596*phiNodal[17]-0.21081851067789195*phiNodal[16]-0.21081851067789195*phiNodal[15]+0.10540925533894596*phiNodal[14]+0.10540925533894596*phiNodal[12]+0.10540925533894596*phiNodal[7]+0.10540925533894596*phiNodal[5]-0.21081851067789195*phiNodal[4]-0.21081851067789195*phiNodal[3]+0.10540925533894596*phiNodal[2]+0.10540925533894596*phiNodal[0]; 
  phi[9] = 0.10540925533894596*phiNodal[19]+0.10540925533894596*phiNodal[17]+0.10540925533894596*phiNodal[14]+0.10540925533894596*phiNodal[12]-0.21081851067789195*phiNodal[11]-0.21081851067789195*phiNodal[10]-0.21081851067789195*phiNodal[9]-0.21081851067789195*phiNodal[8]+0.10540925533894596*phiNodal[7]+0.10540925533894596*phiNodal[5]+0.10540925533894596*phiNodal[2]+0.10540925533894596*phiNodal[0]; 
  phi[10] = 0.06804138174397717*phiNodal[19]-0.06804138174397717*phiNodal[17]-0.06804138174397717*phiNodal[14]+0.06804138174397717*phiNodal[12]-0.06804138174397717*phiNodal[7]+0.06804138174397717*phiNodal[5]+0.06804138174397717*phiNodal[2]-0.06804138174397717*phiNodal[0]; 
  phi[11] = 0.06085806194501844*phiNodal[19]-0.1217161238900369*phiNodal[18]+0.06085806194501844*phiNodal[17]-0.06085806194501844*phiNodal[14]+0.1217161238900369*phiNodal[13]-0.06085806194501844*phiNodal[12]+0.06085806194501844*phiNodal[7]-0.1217161238900369*phiNodal[6]+0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]+0.1217161238900369*phiNodal[1]-0.06085806194501844*phiNodal[0]; 
  phi[12] = 0.06085806194501844*phiNodal[19]-0.06085806194501844*phiNodal[17]-0.1217161238900369*phiNodal[16]+0.1217161238900369*phiNodal[15]+0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]+0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]-0.1217161238900369*phiNodal[4]+0.1217161238900369*phiNodal[3]+0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[13] = 0.06085806194501844*phiNodal[19]-0.1217161238900369*phiNodal[18]+0.06085806194501844*phiNodal[17]+0.06085806194501844*phiNodal[14]-0.1217161238900369*phiNodal[13]+0.06085806194501844*phiNodal[12]-0.06085806194501844*phiNodal[7]+0.1217161238900369*phiNodal[6]-0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]+0.1217161238900369*phiNodal[1]-0.06085806194501844*phiNodal[0]; 
  phi[14] = 0.06085806194501844*phiNodal[19]+0.06085806194501844*phiNodal[17]-0.1217161238900369*phiNodal[16]-0.1217161238900369*phiNodal[15]+0.06085806194501844*phiNodal[14]+0.06085806194501844*phiNodal[12]-0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]+0.1217161238900369*phiNodal[4]+0.1217161238900369*phiNodal[3]-0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[15] = 0.06085806194501844*phiNodal[19]-0.06085806194501844*phiNodal[17]+0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]-0.1217161238900369*phiNodal[11]+0.1217161238900369*phiNodal[10]-0.1217161238900369*phiNodal[9]+0.1217161238900369*phiNodal[8]+0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]+0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[16] = 0.06085806194501844*phiNodal[19]+0.06085806194501844*phiNodal[17]-0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]-0.1217161238900369*phiNodal[11]-0.1217161238900369*phiNodal[10]+0.1217161238900369*phiNodal[9]+0.1217161238900369*phiNodal[8]+0.06085806194501844*phiNodal[7]+0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[17] = 0.03513641844631532*phiNodal[19]-0.07027283689263064*phiNodal[18]+0.03513641844631532*phiNodal[17]-0.03513641844631532*phiNodal[14]+0.07027283689263064*phiNodal[13]-0.03513641844631532*phiNodal[12]-0.03513641844631532*phiNodal[7]+0.07027283689263064*phiNodal[6]-0.03513641844631532*phiNodal[5]+0.03513641844631532*phiNodal[2]-0.07027283689263064*phiNodal[1]+0.03513641844631532*phiNodal[0]; 
  phi[18] = 0.03513641844631532*phiNodal[19]-0.03513641844631532*phiNodal[17]-0.07027283689263064*phiNodal[16]+0.07027283689263064*phiNodal[15]+0.03513641844631532*phiNodal[14]-0.03513641844631532*phiNodal[12]-0.03513641844631532*phiNodal[7]+0.03513641844631532*phiNodal[5]+0.07027283689263064*phiNodal[4]-0.07027283689263064*phiNodal[3]-0.03513641844631532*phiNodal[2]+0.03513641844631532*phiNodal[0]; 
  phi[19] = 0.03513641844631532*phiNodal[19]-0.03513641844631532*phiNodal[17]-0.03513641844631532*phiNodal[14]+0.03513641844631532*phiNodal[12]-0.07027283689263064*phiNodal[11]+0.07027283689263064*phiNodal[10]+0.07027283689263064*phiNodal[9]-0.07027283689263064*phiNodal[8]+0.03513641844631532*phiNodal[7]-0.03513641844631532*phiNodal[5]-0.03513641844631532*phiNodal[2]+0.03513641844631532*phiNodal[0]; 
 
}

GKYL_CU_DH void sheath_rarefaction_phi_mod_kinetic_elc_upper_3x_ser_p2(double elem_q, double mElc, double tempElcBoltz, const double *momsElc, double mIon, const double *momsIon, const double *phiWall, double *phi) 
{ 
  // elem_q: elementary charge.
  // mElc: electron mass.
  // tempElcBoltz: electron temperature in Boltzmann electron model.
  // momsElc: m0, m1, m2par (and m2perp, but not used) moments of electrons.
  // mIon: ion mass.
  // momsIon: m0, m1, m2par (and m2perp, but not used) moments of ions.
  // phi: electrostatic potential.

  double phiNodal[20];
  phiNodal[0] = 2.371708245126284*phi[19]+2.371708245126284*phi[18]+2.371708245126284*phi[17]-1.369306393762915*phi[16]-1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]-1.369306393762915*phi[12]-1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]+1.060660171779821*phi[5]+1.060660171779821*phi[4]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[1] = -(1.185854122563142*phi[17])-1.369306393762915*phi[16]-1.369306393762915*phi[14]+0.6846531968814574*phi[13]+0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]+1.060660171779821*phi[6]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[2] = -(2.371708245126284*phi[19])-2.371708245126284*phi[18]+2.371708245126284*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]+1.369306393762915*phi[12]-1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]-1.060660171779821*phi[5]-1.060660171779821*phi[4]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[3] = -(1.185854122563142*phi[18])-1.369306393762915*phi[15]+0.6846531968814574*phi[14]-1.369306393762915*phi[13]+0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[5]-0.6123724356957944*phi[3]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[4] = 1.185854122563142*phi[18]+1.369306393762915*phi[15]+0.6846531968814574*phi[14]-1.369306393762915*phi[13]-0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[5]-0.6123724356957944*phi[3]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[5] = -(2.371708245126284*phi[19])+2.371708245126284*phi[18]-2.371708245126284*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]-1.369306393762915*phi[12]+1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]+1.060660171779821*phi[5]-1.060660171779821*phi[4]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[6] = 1.185854122563142*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[14]+0.6846531968814574*phi[13]-0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]-1.060660171779821*phi[6]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[7] = 2.371708245126284*phi[19]-2.371708245126284*phi[18]-2.371708245126284*phi[17]+1.369306393762915*phi[16]+1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]+1.369306393762915*phi[12]+1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]-1.060660171779821*phi[5]+1.060660171779821*phi[4]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[8] = -(1.185854122563142*phi[19])+0.6846531968814574*phi[16]+0.6846531968814574*phi[15]-1.369306393762915*phi[12]-1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[4]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[9] = 1.185854122563142*phi[19]+0.6846531968814574*phi[16]-0.6846531968814574*phi[15]+1.369306393762915*phi[12]-1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[4]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[10] = 1.185854122563142*phi[19]-0.6846531968814574*phi[16]+0.6846531968814574*phi[15]-1.369306393762915*phi[12]+1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[4]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[11] = -(1.185854122563142*phi[19])-0.6846531968814574*phi[16]-0.6846531968814574*phi[15]+1.369306393762915*phi[12]+1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[4]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[12] = 2.371708245126284*phi[19]-2.371708245126284*phi[18]-2.371708245126284*phi[17]-1.369306393762915*phi[16]-1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]-1.369306393762915*phi[12]-1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]-1.060660171779821*phi[5]+1.060660171779821*phi[4]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[13] = 1.185854122563142*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[14]-0.6846531968814574*phi[13]+0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]-1.060660171779821*phi[6]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[14] = -(2.371708245126284*phi[19])+2.371708245126284*phi[18]-2.371708245126284*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]+1.369306393762915*phi[12]-1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]+1.060660171779821*phi[5]-1.060660171779821*phi[4]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[15] = 1.185854122563142*phi[18]-1.369306393762915*phi[15]-0.6846531968814574*phi[14]+1.369306393762915*phi[13]+0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[5]+0.6123724356957944*phi[3]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[16] = -(1.185854122563142*phi[18])+1.369306393762915*phi[15]-0.6846531968814574*phi[14]+1.369306393762915*phi[13]-0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[5]+0.6123724356957944*phi[3]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[17] = -(2.371708245126284*phi[19])-2.371708245126284*phi[18]+2.371708245126284*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]-1.369306393762915*phi[12]+1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]-1.060660171779821*phi[5]-1.060660171779821*phi[4]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[18] = -(1.185854122563142*phi[17])+1.369306393762915*phi[16]+1.369306393762915*phi[14]-0.6846531968814574*phi[13]-0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]+1.060660171779821*phi[6]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[19] = 2.371708245126284*phi[19]+2.371708245126284*phi[18]+2.371708245126284*phi[17]+1.369306393762915*phi[16]+1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]+1.369306393762915*phi[12]+1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]+1.060660171779821*phi[5]+1.060660171779821*phi[4]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 

  const double *m0Ion = &momsIon[0];
  const double *m1Ion = &momsIon[20];
  const double *m2parIon = &momsIon[40];

  double m0iSurfNodal[8];
  double m1iSurfNodal[8];
  double m2pariSurfNodal[8];
  m0iSurfNodal[0] = 2.371708245126284*m0Ion[19]-2.371708245126284*m0Ion[18]-2.371708245126284*m0Ion[17]-1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[15]+1.369306393762915*m0Ion[14]+1.369306393762915*m0Ion[13]-1.369306393762915*m0Ion[12]-1.369306393762915*m0Ion[11]+1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[6]-1.060660171779821*m0Ion[5]+1.060660171779821*m0Ion[4]+0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[1] = 1.185854122563142*m0Ion[17]-1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[14]-0.6846531968814574*m0Ion[13]+0.6846531968814574*m0Ion[11]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]-0.3952847075210473*m0Ion[7]-1.060660171779821*m0Ion[6]+0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[2] = -(2.371708245126284*m0Ion[19])+2.371708245126284*m0Ion[18]-2.371708245126284*m0Ion[17]-1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[15]+1.369306393762915*m0Ion[14]+1.369306393762915*m0Ion[13]+1.369306393762915*m0Ion[12]-1.369306393762915*m0Ion[11]-1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[6]+1.060660171779821*m0Ion[5]-1.060660171779821*m0Ion[4]+0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[3] = 1.185854122563142*m0Ion[18]-1.369306393762915*m0Ion[15]-0.6846531968814574*m0Ion[14]+1.369306393762915*m0Ion[13]+0.6846531968814574*m0Ion[12]+0.7905694150420947*m0Ion[9]-0.3952847075210473*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[5]+0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[4] = -(1.185854122563142*m0Ion[18])+1.369306393762915*m0Ion[15]-0.6846531968814574*m0Ion[14]+1.369306393762915*m0Ion[13]-0.6846531968814574*m0Ion[12]+0.7905694150420947*m0Ion[9]-0.3952847075210473*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[5]+0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[5] = -(2.371708245126284*m0Ion[19])-2.371708245126284*m0Ion[18]+2.371708245126284*m0Ion[17]+1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[15]+1.369306393762915*m0Ion[14]+1.369306393762915*m0Ion[13]-1.369306393762915*m0Ion[12]+1.369306393762915*m0Ion[11]-1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[6]-1.060660171779821*m0Ion[5]-1.060660171779821*m0Ion[4]+0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[6] = -(1.185854122563142*m0Ion[17])+1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[14]-0.6846531968814574*m0Ion[13]-0.6846531968814574*m0Ion[11]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]-0.3952847075210473*m0Ion[7]+1.060660171779821*m0Ion[6]+0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[7] = 2.371708245126284*m0Ion[19]+2.371708245126284*m0Ion[18]+2.371708245126284*m0Ion[17]+1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[15]+1.369306393762915*m0Ion[14]+1.369306393762915*m0Ion[13]+1.369306393762915*m0Ion[12]+1.369306393762915*m0Ion[11]+1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[6]+1.060660171779821*m0Ion[5]+1.060660171779821*m0Ion[4]+0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m1iSurfNodal[0] = 2.371708245126284*m1Ion[19]-2.371708245126284*m1Ion[18]-2.371708245126284*m1Ion[17]-1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[15]+1.369306393762915*m1Ion[14]+1.369306393762915*m1Ion[13]-1.369306393762915*m1Ion[12]-1.369306393762915*m1Ion[11]+1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[6]-1.060660171779821*m1Ion[5]+1.060660171779821*m1Ion[4]+0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[1] = 1.185854122563142*m1Ion[17]-1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[14]-0.6846531968814574*m1Ion[13]+0.6846531968814574*m1Ion[11]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]-0.3952847075210473*m1Ion[7]-1.060660171779821*m1Ion[6]+0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[2] = -(2.371708245126284*m1Ion[19])+2.371708245126284*m1Ion[18]-2.371708245126284*m1Ion[17]-1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[15]+1.369306393762915*m1Ion[14]+1.369306393762915*m1Ion[13]+1.369306393762915*m1Ion[12]-1.369306393762915*m1Ion[11]-1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[6]+1.060660171779821*m1Ion[5]-1.060660171779821*m1Ion[4]+0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[3] = 1.185854122563142*m1Ion[18]-1.369306393762915*m1Ion[15]-0.6846531968814574*m1Ion[14]+1.369306393762915*m1Ion[13]+0.6846531968814574*m1Ion[12]+0.7905694150420947*m1Ion[9]-0.3952847075210473*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[5]+0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[4] = -(1.185854122563142*m1Ion[18])+1.369306393762915*m1Ion[15]-0.6846531968814574*m1Ion[14]+1.369306393762915*m1Ion[13]-0.6846531968814574*m1Ion[12]+0.7905694150420947*m1Ion[9]-0.3952847075210473*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[5]+0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[5] = -(2.371708245126284*m1Ion[19])-2.371708245126284*m1Ion[18]+2.371708245126284*m1Ion[17]+1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[15]+1.369306393762915*m1Ion[14]+1.369306393762915*m1Ion[13]-1.369306393762915*m1Ion[12]+1.369306393762915*m1Ion[11]-1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[6]-1.060660171779821*m1Ion[5]-1.060660171779821*m1Ion[4]+0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[6] = -(1.185854122563142*m1Ion[17])+1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[14]-0.6846531968814574*m1Ion[13]-0.6846531968814574*m1Ion[11]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]-0.3952847075210473*m1Ion[7]+1.060660171779821*m1Ion[6]+0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[7] = 2.371708245126284*m1Ion[19]+2.371708245126284*m1Ion[18]+2.371708245126284*m1Ion[17]+1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[15]+1.369306393762915*m1Ion[14]+1.369306393762915*m1Ion[13]+1.369306393762915*m1Ion[12]+1.369306393762915*m1Ion[11]+1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[6]+1.060660171779821*m1Ion[5]+1.060660171779821*m1Ion[4]+0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m2pariSurfNodal[0] = 2.371708245126284*m2parIon[19]-2.371708245126284*m2parIon[18]-2.371708245126284*m2parIon[17]-1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[15]+1.369306393762915*m2parIon[14]+1.369306393762915*m2parIon[13]-1.369306393762915*m2parIon[12]-1.369306393762915*m2parIon[11]+1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[6]-1.060660171779821*m2parIon[5]+1.060660171779821*m2parIon[4]+0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[1] = 1.185854122563142*m2parIon[17]-1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[14]-0.6846531968814574*m2parIon[13]+0.6846531968814574*m2parIon[11]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]-0.3952847075210473*m2parIon[7]-1.060660171779821*m2parIon[6]+0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[2] = -(2.371708245126284*m2parIon[19])+2.371708245126284*m2parIon[18]-2.371708245126284*m2parIon[17]-1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[15]+1.369306393762915*m2parIon[14]+1.369306393762915*m2parIon[13]+1.369306393762915*m2parIon[12]-1.369306393762915*m2parIon[11]-1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[6]+1.060660171779821*m2parIon[5]-1.060660171779821*m2parIon[4]+0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[3] = 1.185854122563142*m2parIon[18]-1.369306393762915*m2parIon[15]-0.6846531968814574*m2parIon[14]+1.369306393762915*m2parIon[13]+0.6846531968814574*m2parIon[12]+0.7905694150420947*m2parIon[9]-0.3952847075210473*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[5]+0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[4] = -(1.185854122563142*m2parIon[18])+1.369306393762915*m2parIon[15]-0.6846531968814574*m2parIon[14]+1.369306393762915*m2parIon[13]-0.6846531968814574*m2parIon[12]+0.7905694150420947*m2parIon[9]-0.3952847075210473*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[5]+0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[5] = -(2.371708245126284*m2parIon[19])-2.371708245126284*m2parIon[18]+2.371708245126284*m2parIon[17]+1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[15]+1.369306393762915*m2parIon[14]+1.369306393762915*m2parIon[13]-1.369306393762915*m2parIon[12]+1.369306393762915*m2parIon[11]-1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[6]-1.060660171779821*m2parIon[5]-1.060660171779821*m2parIon[4]+0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[6] = -(1.185854122563142*m2parIon[17])+1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[14]-0.6846531968814574*m2parIon[13]-0.6846531968814574*m2parIon[11]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]-0.3952847075210473*m2parIon[7]+1.060660171779821*m2parIon[6]+0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[7] = 2.371708245126284*m2parIon[19]+2.371708245126284*m2parIon[18]+2.371708245126284*m2parIon[17]+1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[15]+1.369306393762915*m2parIon[14]+1.369306393762915*m2parIon[13]+1.369306393762915*m2parIon[12]+1.369306393762915*m2parIon[11]+1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[6]+1.060660171779821*m2parIon[5]+1.060660171779821*m2parIon[4]+0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 

  const double *m0Elc = &momsElc[0];
  const double *m1Elc = &momsElc[20];
  const double *m2parElc = &momsElc[40];

  double m0eSurfNodal[8];
  double m1eSurfNodal[8];
  double m2pareSurfNodal[8];
  m0eSurfNodal[0] = 2.371708245126284*m0Elc[19]-2.371708245126284*m0Elc[18]-2.371708245126284*m0Elc[17]-1.369306393762915*m0Elc[16]-1.369306393762915*m0Elc[15]+1.369306393762915*m0Elc[14]+1.369306393762915*m0Elc[13]-1.369306393762915*m0Elc[12]-1.369306393762915*m0Elc[11]+1.837117307087383*m0Elc[10]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]+0.7905694150420947*m0Elc[7]-1.060660171779821*m0Elc[6]-1.060660171779821*m0Elc[5]+1.060660171779821*m0Elc[4]+0.6123724356957944*m0Elc[3]-0.6123724356957944*m0Elc[2]-0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[1] = 1.185854122563142*m0Elc[17]-1.369306393762915*m0Elc[16]+1.369306393762915*m0Elc[14]-0.6846531968814574*m0Elc[13]+0.6846531968814574*m0Elc[11]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]-0.3952847075210473*m0Elc[7]-1.060660171779821*m0Elc[6]+0.6123724356957944*m0Elc[3]-0.6123724356957944*m0Elc[2]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[2] = -(2.371708245126284*m0Elc[19])+2.371708245126284*m0Elc[18]-2.371708245126284*m0Elc[17]-1.369306393762915*m0Elc[16]+1.369306393762915*m0Elc[15]+1.369306393762915*m0Elc[14]+1.369306393762915*m0Elc[13]+1.369306393762915*m0Elc[12]-1.369306393762915*m0Elc[11]-1.837117307087383*m0Elc[10]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]+0.7905694150420947*m0Elc[7]-1.060660171779821*m0Elc[6]+1.060660171779821*m0Elc[5]-1.060660171779821*m0Elc[4]+0.6123724356957944*m0Elc[3]-0.6123724356957944*m0Elc[2]+0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[3] = 1.185854122563142*m0Elc[18]-1.369306393762915*m0Elc[15]-0.6846531968814574*m0Elc[14]+1.369306393762915*m0Elc[13]+0.6846531968814574*m0Elc[12]+0.7905694150420947*m0Elc[9]-0.3952847075210473*m0Elc[8]+0.7905694150420947*m0Elc[7]-1.060660171779821*m0Elc[5]+0.6123724356957944*m0Elc[3]-0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[4] = -(1.185854122563142*m0Elc[18])+1.369306393762915*m0Elc[15]-0.6846531968814574*m0Elc[14]+1.369306393762915*m0Elc[13]-0.6846531968814574*m0Elc[12]+0.7905694150420947*m0Elc[9]-0.3952847075210473*m0Elc[8]+0.7905694150420947*m0Elc[7]+1.060660171779821*m0Elc[5]+0.6123724356957944*m0Elc[3]+0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[5] = -(2.371708245126284*m0Elc[19])-2.371708245126284*m0Elc[18]+2.371708245126284*m0Elc[17]+1.369306393762915*m0Elc[16]-1.369306393762915*m0Elc[15]+1.369306393762915*m0Elc[14]+1.369306393762915*m0Elc[13]-1.369306393762915*m0Elc[12]+1.369306393762915*m0Elc[11]-1.837117307087383*m0Elc[10]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]+0.7905694150420947*m0Elc[7]+1.060660171779821*m0Elc[6]-1.060660171779821*m0Elc[5]-1.060660171779821*m0Elc[4]+0.6123724356957944*m0Elc[3]+0.6123724356957944*m0Elc[2]-0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[6] = -(1.185854122563142*m0Elc[17])+1.369306393762915*m0Elc[16]+1.369306393762915*m0Elc[14]-0.6846531968814574*m0Elc[13]-0.6846531968814574*m0Elc[11]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]-0.3952847075210473*m0Elc[7]+1.060660171779821*m0Elc[6]+0.6123724356957944*m0Elc[3]+0.6123724356957944*m0Elc[2]+0.3535533905932737*m0Elc[0]; 
  m0eSurfNodal[7] = 2.371708245126284*m0Elc[19]+2.371708245126284*m0Elc[18]+2.371708245126284*m0Elc[17]+1.369306393762915*m0Elc[16]+1.369306393762915*m0Elc[15]+1.369306393762915*m0Elc[14]+1.369306393762915*m0Elc[13]+1.369306393762915*m0Elc[12]+1.369306393762915*m0Elc[11]+1.837117307087383*m0Elc[10]+0.7905694150420947*m0Elc[9]+0.7905694150420947*m0Elc[8]+0.7905694150420947*m0Elc[7]+1.060660171779821*m0Elc[6]+1.060660171779821*m0Elc[5]+1.060660171779821*m0Elc[4]+0.6123724356957944*m0Elc[3]+0.6123724356957944*m0Elc[2]+0.6123724356957944*m0Elc[1]+0.3535533905932737*m0Elc[0]; 
  m1eSurfNodal[0] = 2.371708245126284*m1Elc[19]-2.371708245126284*m1Elc[18]-2.371708245126284*m1Elc[17]-1.369306393762915*m1Elc[16]-1.369306393762915*m1Elc[15]+1.369306393762915*m1Elc[14]+1.369306393762915*m1Elc[13]-1.369306393762915*m1Elc[12]-1.369306393762915*m1Elc[11]+1.837117307087383*m1Elc[10]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]+0.7905694150420947*m1Elc[7]-1.060660171779821*m1Elc[6]-1.060660171779821*m1Elc[5]+1.060660171779821*m1Elc[4]+0.6123724356957944*m1Elc[3]-0.6123724356957944*m1Elc[2]-0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[1] = 1.185854122563142*m1Elc[17]-1.369306393762915*m1Elc[16]+1.369306393762915*m1Elc[14]-0.6846531968814574*m1Elc[13]+0.6846531968814574*m1Elc[11]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]-0.3952847075210473*m1Elc[7]-1.060660171779821*m1Elc[6]+0.6123724356957944*m1Elc[3]-0.6123724356957944*m1Elc[2]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[2] = -(2.371708245126284*m1Elc[19])+2.371708245126284*m1Elc[18]-2.371708245126284*m1Elc[17]-1.369306393762915*m1Elc[16]+1.369306393762915*m1Elc[15]+1.369306393762915*m1Elc[14]+1.369306393762915*m1Elc[13]+1.369306393762915*m1Elc[12]-1.369306393762915*m1Elc[11]-1.837117307087383*m1Elc[10]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]+0.7905694150420947*m1Elc[7]-1.060660171779821*m1Elc[6]+1.060660171779821*m1Elc[5]-1.060660171779821*m1Elc[4]+0.6123724356957944*m1Elc[3]-0.6123724356957944*m1Elc[2]+0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[3] = 1.185854122563142*m1Elc[18]-1.369306393762915*m1Elc[15]-0.6846531968814574*m1Elc[14]+1.369306393762915*m1Elc[13]+0.6846531968814574*m1Elc[12]+0.7905694150420947*m1Elc[9]-0.3952847075210473*m1Elc[8]+0.7905694150420947*m1Elc[7]-1.060660171779821*m1Elc[5]+0.6123724356957944*m1Elc[3]-0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[4] = -(1.185854122563142*m1Elc[18])+1.369306393762915*m1Elc[15]-0.6846531968814574*m1Elc[14]+1.369306393762915*m1Elc[13]-0.6846531968814574*m1Elc[12]+0.7905694150420947*m1Elc[9]-0.3952847075210473*m1Elc[8]+0.7905694150420947*m1Elc[7]+1.060660171779821*m1Elc[5]+0.6123724356957944*m1Elc[3]+0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[5] = -(2.371708245126284*m1Elc[19])-2.371708245126284*m1Elc[18]+2.371708245126284*m1Elc[17]+1.369306393762915*m1Elc[16]-1.369306393762915*m1Elc[15]+1.369306393762915*m1Elc[14]+1.369306393762915*m1Elc[13]-1.369306393762915*m1Elc[12]+1.369306393762915*m1Elc[11]-1.837117307087383*m1Elc[10]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]+0.7905694150420947*m1Elc[7]+1.060660171779821*m1Elc[6]-1.060660171779821*m1Elc[5]-1.060660171779821*m1Elc[4]+0.6123724356957944*m1Elc[3]+0.6123724356957944*m1Elc[2]-0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[6] = -(1.185854122563142*m1Elc[17])+1.369306393762915*m1Elc[16]+1.369306393762915*m1Elc[14]-0.6846531968814574*m1Elc[13]-0.6846531968814574*m1Elc[11]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]-0.3952847075210473*m1Elc[7]+1.060660171779821*m1Elc[6]+0.6123724356957944*m1Elc[3]+0.6123724356957944*m1Elc[2]+0.3535533905932737*m1Elc[0]; 
  m1eSurfNodal[7] = 2.371708245126284*m1Elc[19]+2.371708245126284*m1Elc[18]+2.371708245126284*m1Elc[17]+1.369306393762915*m1Elc[16]+1.369306393762915*m1Elc[15]+1.369306393762915*m1Elc[14]+1.369306393762915*m1Elc[13]+1.369306393762915*m1Elc[12]+1.369306393762915*m1Elc[11]+1.837117307087383*m1Elc[10]+0.7905694150420947*m1Elc[9]+0.7905694150420947*m1Elc[8]+0.7905694150420947*m1Elc[7]+1.060660171779821*m1Elc[6]+1.060660171779821*m1Elc[5]+1.060660171779821*m1Elc[4]+0.6123724356957944*m1Elc[3]+0.6123724356957944*m1Elc[2]+0.6123724356957944*m1Elc[1]+0.3535533905932737*m1Elc[0]; 
  m2pareSurfNodal[0] = 2.371708245126284*m2parElc[19]-2.371708245126284*m2parElc[18]-2.371708245126284*m2parElc[17]-1.369306393762915*m2parElc[16]-1.369306393762915*m2parElc[15]+1.369306393762915*m2parElc[14]+1.369306393762915*m2parElc[13]-1.369306393762915*m2parElc[12]-1.369306393762915*m2parElc[11]+1.837117307087383*m2parElc[10]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]+0.7905694150420947*m2parElc[7]-1.060660171779821*m2parElc[6]-1.060660171779821*m2parElc[5]+1.060660171779821*m2parElc[4]+0.6123724356957944*m2parElc[3]-0.6123724356957944*m2parElc[2]-0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[1] = 1.185854122563142*m2parElc[17]-1.369306393762915*m2parElc[16]+1.369306393762915*m2parElc[14]-0.6846531968814574*m2parElc[13]+0.6846531968814574*m2parElc[11]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]-0.3952847075210473*m2parElc[7]-1.060660171779821*m2parElc[6]+0.6123724356957944*m2parElc[3]-0.6123724356957944*m2parElc[2]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[2] = -(2.371708245126284*m2parElc[19])+2.371708245126284*m2parElc[18]-2.371708245126284*m2parElc[17]-1.369306393762915*m2parElc[16]+1.369306393762915*m2parElc[15]+1.369306393762915*m2parElc[14]+1.369306393762915*m2parElc[13]+1.369306393762915*m2parElc[12]-1.369306393762915*m2parElc[11]-1.837117307087383*m2parElc[10]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]+0.7905694150420947*m2parElc[7]-1.060660171779821*m2parElc[6]+1.060660171779821*m2parElc[5]-1.060660171779821*m2parElc[4]+0.6123724356957944*m2parElc[3]-0.6123724356957944*m2parElc[2]+0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[3] = 1.185854122563142*m2parElc[18]-1.369306393762915*m2parElc[15]-0.6846531968814574*m2parElc[14]+1.369306393762915*m2parElc[13]+0.6846531968814574*m2parElc[12]+0.7905694150420947*m2parElc[9]-0.3952847075210473*m2parElc[8]+0.7905694150420947*m2parElc[7]-1.060660171779821*m2parElc[5]+0.6123724356957944*m2parElc[3]-0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[4] = -(1.185854122563142*m2parElc[18])+1.369306393762915*m2parElc[15]-0.6846531968814574*m2parElc[14]+1.369306393762915*m2parElc[13]-0.6846531968814574*m2parElc[12]+0.7905694150420947*m2parElc[9]-0.3952847075210473*m2parElc[8]+0.7905694150420947*m2parElc[7]+1.060660171779821*m2parElc[5]+0.6123724356957944*m2parElc[3]+0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[5] = -(2.371708245126284*m2parElc[19])-2.371708245126284*m2parElc[18]+2.371708245126284*m2parElc[17]+1.369306393762915*m2parElc[16]-1.369306393762915*m2parElc[15]+1.369306393762915*m2parElc[14]+1.369306393762915*m2parElc[13]-1.369306393762915*m2parElc[12]+1.369306393762915*m2parElc[11]-1.837117307087383*m2parElc[10]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]+0.7905694150420947*m2parElc[7]+1.060660171779821*m2parElc[6]-1.060660171779821*m2parElc[5]-1.060660171779821*m2parElc[4]+0.6123724356957944*m2parElc[3]+0.6123724356957944*m2parElc[2]-0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[6] = -(1.185854122563142*m2parElc[17])+1.369306393762915*m2parElc[16]+1.369306393762915*m2parElc[14]-0.6846531968814574*m2parElc[13]-0.6846531968814574*m2parElc[11]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]-0.3952847075210473*m2parElc[7]+1.060660171779821*m2parElc[6]+0.6123724356957944*m2parElc[3]+0.6123724356957944*m2parElc[2]+0.3535533905932737*m2parElc[0]; 
  m2pareSurfNodal[7] = 2.371708245126284*m2parElc[19]+2.371708245126284*m2parElc[18]+2.371708245126284*m2parElc[17]+1.369306393762915*m2parElc[16]+1.369306393762915*m2parElc[15]+1.369306393762915*m2parElc[14]+1.369306393762915*m2parElc[13]+1.369306393762915*m2parElc[12]+1.369306393762915*m2parElc[11]+1.837117307087383*m2parElc[10]+0.7905694150420947*m2parElc[9]+0.7905694150420947*m2parElc[8]+0.7905694150420947*m2parElc[7]+1.060660171779821*m2parElc[6]+1.060660171779821*m2parElc[5]+1.060660171779821*m2parElc[4]+0.6123724356957944*m2parElc[3]+0.6123724356957944*m2parElc[2]+0.6123724356957944*m2parElc[1]+0.3535533905932737*m2parElc[0]; 

  double phiWallNodal[8];
  phiWallNodal[0] = -(1.9364916731037085*phiWall[7])-1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]+1.5*phiWall[3]-0.8660254037844386*phiWall[2]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[1] = 0.9682458365518543*phiWall[6]+1.118033988749895*phiWall[5]-0.5590169943749475*phiWall[4]-0.8660254037844386*phiWall[2]+0.5*phiWall[0]; 
  phiWallNodal[2] = 1.9364916731037085*phiWall[7]-1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]-1.5*phiWall[3]-0.8660254037844386*phiWall[2]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[3] = 0.9682458365518543*phiWall[7]-0.5590169943749475*phiWall[5]+1.118033988749895*phiWall[4]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[4] = -(0.9682458365518543*phiWall[7])-0.5590169943749475*phiWall[5]+1.118033988749895*phiWall[4]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[5] = -(1.9364916731037085*phiWall[7])+1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]-1.5*phiWall[3]+0.8660254037844386*phiWall[2]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[6] = -(0.9682458365518543*phiWall[6])+1.118033988749895*phiWall[5]-0.5590169943749475*phiWall[4]+0.8660254037844386*phiWall[2]+0.5*phiWall[0]; 
  phiWallNodal[7] = 1.9364916731037085*phiWall[7]+1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]+1.5*phiWall[3]+0.8660254037844386*phiWall[2]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 

  double upar_i;
  double Tpar_i;
  double upar_e;
  double Tpar_e;
  double c_s;
  double Delta_phi_r;

  upar_i = m1iSurfNodal[0]/m0iSurfNodal[0];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[0]*mIon*upar_i-1.0*m2pariSurfNodal[0]*mIon))/m0iSurfNodal[0]));

  upar_e = m1eSurfNodal[0]/m0eSurfNodal[0];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[0]*mElc*upar_e-1.0*m2pareSurfNodal[0]*mElc))/m0eSurfNodal[0]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[12] = fmax(phiNodal[12] + Delta_phi_r, phiWallNodal[0]);

  upar_i = m1iSurfNodal[1]/m0iSurfNodal[1];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[1]*mIon*upar_i-1.0*m2pariSurfNodal[1]*mIon))/m0iSurfNodal[1]));

  upar_e = m1eSurfNodal[1]/m0eSurfNodal[1];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[1]*mElc*upar_e-1.0*m2pareSurfNodal[1]*mElc))/m0eSurfNodal[1]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[13] = fmax(phiNodal[13] + Delta_phi_r, phiWallNodal[1]);

  upar_i = m1iSurfNodal[2]/m0iSurfNodal[2];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[2]*mIon*upar_i-1.0*m2pariSurfNodal[2]*mIon))/m0iSurfNodal[2]));

  upar_e = m1eSurfNodal[2]/m0eSurfNodal[2];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[2]*mElc*upar_e-1.0*m2pareSurfNodal[2]*mElc))/m0eSurfNodal[2]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[14] = fmax(phiNodal[14] + Delta_phi_r, phiWallNodal[2]);

  upar_i = m1iSurfNodal[3]/m0iSurfNodal[3];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[3]*mIon*upar_i-1.0*m2pariSurfNodal[3]*mIon))/m0iSurfNodal[3]));

  upar_e = m1eSurfNodal[3]/m0eSurfNodal[3];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[3]*mElc*upar_e-1.0*m2pareSurfNodal[3]*mElc))/m0eSurfNodal[3]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[15] = fmax(phiNodal[15] + Delta_phi_r, phiWallNodal[3]);

  upar_i = m1iSurfNodal[4]/m0iSurfNodal[4];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[4]*mIon*upar_i-1.0*m2pariSurfNodal[4]*mIon))/m0iSurfNodal[4]));

  upar_e = m1eSurfNodal[4]/m0eSurfNodal[4];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[4]*mElc*upar_e-1.0*m2pareSurfNodal[4]*mElc))/m0eSurfNodal[4]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[16] = fmax(phiNodal[16] + Delta_phi_r, phiWallNodal[4]);

  upar_i = m1iSurfNodal[5]/m0iSurfNodal[5];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[5]*mIon*upar_i-1.0*m2pariSurfNodal[5]*mIon))/m0iSurfNodal[5]));

  upar_e = m1eSurfNodal[5]/m0eSurfNodal[5];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[5]*mElc*upar_e-1.0*m2pareSurfNodal[5]*mElc))/m0eSurfNodal[5]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[17] = fmax(phiNodal[17] + Delta_phi_r, phiWallNodal[5]);

  upar_i = m1iSurfNodal[6]/m0iSurfNodal[6];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[6]*mIon*upar_i-1.0*m2pariSurfNodal[6]*mIon))/m0iSurfNodal[6]));

  upar_e = m1eSurfNodal[6]/m0eSurfNodal[6];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[6]*mElc*upar_e-1.0*m2pareSurfNodal[6]*mElc))/m0eSurfNodal[6]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[18] = fmax(phiNodal[18] + Delta_phi_r, phiWallNodal[6]);

  upar_i = m1iSurfNodal[7]/m0iSurfNodal[7];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[7]*mIon*upar_i-1.0*m2pariSurfNodal[7]*mIon))/m0iSurfNodal[7]));

  upar_e = m1eSurfNodal[7]/m0eSurfNodal[7];
  Tpar_e = fmax(0.0, -((1.0*(m1eSurfNodal[7]*mElc*upar_e-1.0*m2pareSurfNodal[7]*mElc))/m0eSurfNodal[7]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[19] = fmax(phiNodal[19] + Delta_phi_r, phiWallNodal[7]);

  phi[0] = -(0.3535533905932737*phiNodal[19])+0.4714045207910317*phiNodal[18]-0.3535533905932737*phiNodal[17]+0.4714045207910317*phiNodal[16]+0.4714045207910317*phiNodal[15]-0.3535533905932737*phiNodal[14]+0.4714045207910317*phiNodal[13]-0.3535533905932737*phiNodal[12]+0.4714045207910317*phiNodal[11]+0.4714045207910317*phiNodal[10]+0.4714045207910317*phiNodal[9]+0.4714045207910317*phiNodal[8]-0.3535533905932737*phiNodal[7]+0.4714045207910317*phiNodal[6]-0.3535533905932737*phiNodal[5]+0.4714045207910317*phiNodal[4]+0.4714045207910317*phiNodal[3]-0.3535533905932737*phiNodal[2]+0.4714045207910317*phiNodal[1]-0.3535533905932737*phiNodal[0]; 
  phi[1] = -(0.06804138174397717*phiNodal[19])+0.06804138174397717*phiNodal[17]+0.27216552697590873*phiNodal[16]-0.27216552697590873*phiNodal[15]-0.06804138174397717*phiNodal[14]+0.06804138174397717*phiNodal[12]+0.27216552697590873*phiNodal[11]-0.27216552697590873*phiNodal[10]+0.27216552697590873*phiNodal[9]-0.27216552697590873*phiNodal[8]-0.06804138174397717*phiNodal[7]+0.06804138174397717*phiNodal[5]+0.27216552697590873*phiNodal[4]-0.27216552697590873*phiNodal[3]-0.06804138174397717*phiNodal[2]+0.06804138174397717*phiNodal[0]; 
  phi[2] = -(0.06804138174397717*phiNodal[19])+0.27216552697590873*phiNodal[18]-0.06804138174397717*phiNodal[17]+0.06804138174397717*phiNodal[14]-0.27216552697590873*phiNodal[13]+0.06804138174397717*phiNodal[12]+0.27216552697590873*phiNodal[11]+0.27216552697590873*phiNodal[10]-0.27216552697590873*phiNodal[9]-0.27216552697590873*phiNodal[8]-0.06804138174397717*phiNodal[7]+0.27216552697590873*phiNodal[6]-0.06804138174397717*phiNodal[5]+0.06804138174397717*phiNodal[2]-0.27216552697590873*phiNodal[1]+0.06804138174397717*phiNodal[0]; 
  phi[3] = -(0.06804138174397717*phiNodal[19])+0.27216552697590873*phiNodal[18]-0.06804138174397717*phiNodal[17]+0.27216552697590873*phiNodal[16]+0.27216552697590873*phiNodal[15]-0.06804138174397717*phiNodal[14]+0.27216552697590873*phiNodal[13]-0.06804138174397717*phiNodal[12]+0.06804138174397717*phiNodal[7]-0.27216552697590873*phiNodal[6]+0.06804138174397717*phiNodal[5]-0.27216552697590873*phiNodal[4]-0.27216552697590873*phiNodal[3]+0.06804138174397717*phiNodal[2]-0.27216552697590873*phiNodal[1]+0.06804138174397717*phiNodal[0]; 
  phi[4] = 0.0392837100659193*phiNodal[19]-0.0392837100659193*phiNodal[17]-0.0392837100659193*phiNodal[14]+0.0392837100659193*phiNodal[12]+0.15713484026367722*phiNodal[11]-0.15713484026367722*phiNodal[10]-0.15713484026367722*phiNodal[9]+0.15713484026367722*phiNodal[8]+0.0392837100659193*phiNodal[7]-0.0392837100659193*phiNodal[5]-0.0392837100659193*phiNodal[2]+0.0392837100659193*phiNodal[0]; 
  phi[5] = 0.0392837100659193*phiNodal[19]-0.0392837100659193*phiNodal[17]+0.15713484026367722*phiNodal[16]-0.15713484026367722*phiNodal[15]+0.0392837100659193*phiNodal[14]-0.0392837100659193*phiNodal[12]-0.0392837100659193*phiNodal[7]+0.0392837100659193*phiNodal[5]-0.15713484026367722*phiNodal[4]+0.15713484026367722*phiNodal[3]-0.0392837100659193*phiNodal[2]+0.0392837100659193*phiNodal[0]; 
  phi[6] = 0.0392837100659193*phiNodal[19]+0.15713484026367722*phiNodal[18]+0.0392837100659193*phiNodal[17]-0.0392837100659193*phiNodal[14]-0.15713484026367722*phiNodal[13]-0.0392837100659193*phiNodal[12]-0.0392837100659193*phiNodal[7]-0.15713484026367722*phiNodal[6]-0.0392837100659193*phiNodal[5]+0.0392837100659193*phiNodal[2]+0.15713484026367722*phiNodal[1]+0.0392837100659193*phiNodal[0]; 
  phi[7] = 0.10540925533894596*phiNodal[19]-0.21081851067789195*phiNodal[18]+0.10540925533894596*phiNodal[17]+0.10540925533894596*phiNodal[14]-0.21081851067789195*phiNodal[13]+0.10540925533894596*phiNodal[12]+0.10540925533894596*phiNodal[7]-0.21081851067789195*phiNodal[6]+0.10540925533894596*phiNodal[5]+0.10540925533894596*phiNodal[2]-0.21081851067789195*phiNodal[1]+0.10540925533894596*phiNodal[0]; 
  phi[8] = 0.10540925533894596*phiNodal[19]+0.10540925533894596*phiNodal[17]-0.21081851067789195*phiNodal[16]-0.21081851067789195*phiNodal[15]+0.10540925533894596*phiNodal[14]+0.10540925533894596*phiNodal[12]+0.10540925533894596*phiNodal[7]+0.10540925533894596*phiNodal[5]-0.21081851067789195*phiNodal[4]-0.21081851067789195*phiNodal[3]+0.10540925533894596*phiNodal[2]+0.10540925533894596*phiNodal[0]; 
  phi[9] = 0.10540925533894596*phiNodal[19]+0.10540925533894596*phiNodal[17]+0.10540925533894596*phiNodal[14]+0.10540925533894596*phiNodal[12]-0.21081851067789195*phiNodal[11]-0.21081851067789195*phiNodal[10]-0.21081851067789195*phiNodal[9]-0.21081851067789195*phiNodal[8]+0.10540925533894596*phiNodal[7]+0.10540925533894596*phiNodal[5]+0.10540925533894596*phiNodal[2]+0.10540925533894596*phiNodal[0]; 
  phi[10] = 0.06804138174397717*phiNodal[19]-0.06804138174397717*phiNodal[17]-0.06804138174397717*phiNodal[14]+0.06804138174397717*phiNodal[12]-0.06804138174397717*phiNodal[7]+0.06804138174397717*phiNodal[5]+0.06804138174397717*phiNodal[2]-0.06804138174397717*phiNodal[0]; 
  phi[11] = 0.06085806194501844*phiNodal[19]-0.1217161238900369*phiNodal[18]+0.06085806194501844*phiNodal[17]-0.06085806194501844*phiNodal[14]+0.1217161238900369*phiNodal[13]-0.06085806194501844*phiNodal[12]+0.06085806194501844*phiNodal[7]-0.1217161238900369*phiNodal[6]+0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]+0.1217161238900369*phiNodal[1]-0.06085806194501844*phiNodal[0]; 
  phi[12] = 0.06085806194501844*phiNodal[19]-0.06085806194501844*phiNodal[17]-0.1217161238900369*phiNodal[16]+0.1217161238900369*phiNodal[15]+0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]+0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]-0.1217161238900369*phiNodal[4]+0.1217161238900369*phiNodal[3]+0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[13] = 0.06085806194501844*phiNodal[19]-0.1217161238900369*phiNodal[18]+0.06085806194501844*phiNodal[17]+0.06085806194501844*phiNodal[14]-0.1217161238900369*phiNodal[13]+0.06085806194501844*phiNodal[12]-0.06085806194501844*phiNodal[7]+0.1217161238900369*phiNodal[6]-0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]+0.1217161238900369*phiNodal[1]-0.06085806194501844*phiNodal[0]; 
  phi[14] = 0.06085806194501844*phiNodal[19]+0.06085806194501844*phiNodal[17]-0.1217161238900369*phiNodal[16]-0.1217161238900369*phiNodal[15]+0.06085806194501844*phiNodal[14]+0.06085806194501844*phiNodal[12]-0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]+0.1217161238900369*phiNodal[4]+0.1217161238900369*phiNodal[3]-0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[15] = 0.06085806194501844*phiNodal[19]-0.06085806194501844*phiNodal[17]+0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]-0.1217161238900369*phiNodal[11]+0.1217161238900369*phiNodal[10]-0.1217161238900369*phiNodal[9]+0.1217161238900369*phiNodal[8]+0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]+0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[16] = 0.06085806194501844*phiNodal[19]+0.06085806194501844*phiNodal[17]-0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]-0.1217161238900369*phiNodal[11]-0.1217161238900369*phiNodal[10]+0.1217161238900369*phiNodal[9]+0.1217161238900369*phiNodal[8]+0.06085806194501844*phiNodal[7]+0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[17] = 0.03513641844631532*phiNodal[19]-0.07027283689263064*phiNodal[18]+0.03513641844631532*phiNodal[17]-0.03513641844631532*phiNodal[14]+0.07027283689263064*phiNodal[13]-0.03513641844631532*phiNodal[12]-0.03513641844631532*phiNodal[7]+0.07027283689263064*phiNodal[6]-0.03513641844631532*phiNodal[5]+0.03513641844631532*phiNodal[2]-0.07027283689263064*phiNodal[1]+0.03513641844631532*phiNodal[0]; 
  phi[18] = 0.03513641844631532*phiNodal[19]-0.03513641844631532*phiNodal[17]-0.07027283689263064*phiNodal[16]+0.07027283689263064*phiNodal[15]+0.03513641844631532*phiNodal[14]-0.03513641844631532*phiNodal[12]-0.03513641844631532*phiNodal[7]+0.03513641844631532*phiNodal[5]+0.07027283689263064*phiNodal[4]-0.07027283689263064*phiNodal[3]-0.03513641844631532*phiNodal[2]+0.03513641844631532*phiNodal[0]; 
  phi[19] = 0.03513641844631532*phiNodal[19]-0.03513641844631532*phiNodal[17]-0.03513641844631532*phiNodal[14]+0.03513641844631532*phiNodal[12]-0.07027283689263064*phiNodal[11]+0.07027283689263064*phiNodal[10]+0.07027283689263064*phiNodal[9]-0.07027283689263064*phiNodal[8]+0.03513641844631532*phiNodal[7]-0.03513641844631532*phiNodal[5]-0.03513641844631532*phiNodal[2]+0.03513641844631532*phiNodal[0]; 
 
}


GKYL_CU_DH void sheath_rarefaction_phi_mod_boltzmann_elc_lower_3x_ser_p2(double elem_q, double mElc, double tempElcBoltz, const double *momsElc, double mIon, const double *momsIon, const double *phiWall, double *phi) 
{ 
  // elem_q: elementary charge.
  // mElc: electron mass.
  // tempElcBoltz: electron temperature in Boltzmann electron model.
  // momsElc: m0, m1, m2par (and m2perp, but not used) moments of electrons.
  // mIon: ion mass.
  // momsIon: m0, m1, m2par (and m2perp, but not used) moments of ions.
  // phi: electrostatic potential.

  double phiNodal[20];
  phiNodal[0] = 2.371708245126284*phi[19]+2.371708245126284*phi[18]+2.371708245126284*phi[17]-1.369306393762915*phi[16]-1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]-1.369306393762915*phi[12]-1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]+1.060660171779821*phi[5]+1.060660171779821*phi[4]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[1] = -(1.185854122563142*phi[17])-1.369306393762915*phi[16]-1.369306393762915*phi[14]+0.6846531968814574*phi[13]+0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]+1.060660171779821*phi[6]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[2] = -(2.371708245126284*phi[19])-2.371708245126284*phi[18]+2.371708245126284*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]+1.369306393762915*phi[12]-1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]-1.060660171779821*phi[5]-1.060660171779821*phi[4]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[3] = -(1.185854122563142*phi[18])-1.369306393762915*phi[15]+0.6846531968814574*phi[14]-1.369306393762915*phi[13]+0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[5]-0.6123724356957944*phi[3]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[4] = 1.185854122563142*phi[18]+1.369306393762915*phi[15]+0.6846531968814574*phi[14]-1.369306393762915*phi[13]-0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[5]-0.6123724356957944*phi[3]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[5] = -(2.371708245126284*phi[19])+2.371708245126284*phi[18]-2.371708245126284*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]-1.369306393762915*phi[12]+1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]+1.060660171779821*phi[5]-1.060660171779821*phi[4]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[6] = 1.185854122563142*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[14]+0.6846531968814574*phi[13]-0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]-1.060660171779821*phi[6]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[7] = 2.371708245126284*phi[19]-2.371708245126284*phi[18]-2.371708245126284*phi[17]+1.369306393762915*phi[16]+1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]+1.369306393762915*phi[12]+1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]-1.060660171779821*phi[5]+1.060660171779821*phi[4]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[8] = -(1.185854122563142*phi[19])+0.6846531968814574*phi[16]+0.6846531968814574*phi[15]-1.369306393762915*phi[12]-1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[4]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[9] = 1.185854122563142*phi[19]+0.6846531968814574*phi[16]-0.6846531968814574*phi[15]+1.369306393762915*phi[12]-1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[4]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[10] = 1.185854122563142*phi[19]-0.6846531968814574*phi[16]+0.6846531968814574*phi[15]-1.369306393762915*phi[12]+1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[4]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[11] = -(1.185854122563142*phi[19])-0.6846531968814574*phi[16]-0.6846531968814574*phi[15]+1.369306393762915*phi[12]+1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[4]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[12] = 2.371708245126284*phi[19]-2.371708245126284*phi[18]-2.371708245126284*phi[17]-1.369306393762915*phi[16]-1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]-1.369306393762915*phi[12]-1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]-1.060660171779821*phi[5]+1.060660171779821*phi[4]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[13] = 1.185854122563142*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[14]-0.6846531968814574*phi[13]+0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]-1.060660171779821*phi[6]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[14] = -(2.371708245126284*phi[19])+2.371708245126284*phi[18]-2.371708245126284*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]+1.369306393762915*phi[12]-1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]+1.060660171779821*phi[5]-1.060660171779821*phi[4]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[15] = 1.185854122563142*phi[18]-1.369306393762915*phi[15]-0.6846531968814574*phi[14]+1.369306393762915*phi[13]+0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[5]+0.6123724356957944*phi[3]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[16] = -(1.185854122563142*phi[18])+1.369306393762915*phi[15]-0.6846531968814574*phi[14]+1.369306393762915*phi[13]-0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[5]+0.6123724356957944*phi[3]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[17] = -(2.371708245126284*phi[19])-2.371708245126284*phi[18]+2.371708245126284*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]-1.369306393762915*phi[12]+1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]-1.060660171779821*phi[5]-1.060660171779821*phi[4]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[18] = -(1.185854122563142*phi[17])+1.369306393762915*phi[16]+1.369306393762915*phi[14]-0.6846531968814574*phi[13]-0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]+1.060660171779821*phi[6]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[19] = 2.371708245126284*phi[19]+2.371708245126284*phi[18]+2.371708245126284*phi[17]+1.369306393762915*phi[16]+1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]+1.369306393762915*phi[12]+1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]+1.060660171779821*phi[5]+1.060660171779821*phi[4]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 

  const double *m0Ion = &momsIon[0];
  const double *m1Ion = &momsIon[20];
  const double *m2parIon = &momsIon[40];

  double m0iSurfNodal[8];
  double m1iSurfNodal[8];
  double m2pariSurfNodal[8];
  m0iSurfNodal[0] = 2.371708245126284*m0Ion[19]+2.371708245126284*m0Ion[18]+2.371708245126284*m0Ion[17]-1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[15]-1.369306393762915*m0Ion[14]-1.369306393762915*m0Ion[13]-1.369306393762915*m0Ion[12]-1.369306393762915*m0Ion[11]-1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[6]+1.060660171779821*m0Ion[5]+1.060660171779821*m0Ion[4]-0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[1] = -(1.185854122563142*m0Ion[17])-1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[14]+0.6846531968814574*m0Ion[13]+0.6846531968814574*m0Ion[11]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]-0.3952847075210473*m0Ion[7]+1.060660171779821*m0Ion[6]-0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[2] = -(2.371708245126284*m0Ion[19])-2.371708245126284*m0Ion[18]+2.371708245126284*m0Ion[17]-1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[15]-1.369306393762915*m0Ion[14]-1.369306393762915*m0Ion[13]+1.369306393762915*m0Ion[12]-1.369306393762915*m0Ion[11]+1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[6]-1.060660171779821*m0Ion[5]-1.060660171779821*m0Ion[4]-0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[3] = -(1.185854122563142*m0Ion[18])-1.369306393762915*m0Ion[15]+0.6846531968814574*m0Ion[14]-1.369306393762915*m0Ion[13]+0.6846531968814574*m0Ion[12]+0.7905694150420947*m0Ion[9]-0.3952847075210473*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[5]-0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[4] = 1.185854122563142*m0Ion[18]+1.369306393762915*m0Ion[15]+0.6846531968814574*m0Ion[14]-1.369306393762915*m0Ion[13]-0.6846531968814574*m0Ion[12]+0.7905694150420947*m0Ion[9]-0.3952847075210473*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[5]-0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[5] = -(2.371708245126284*m0Ion[19])+2.371708245126284*m0Ion[18]-2.371708245126284*m0Ion[17]+1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[15]-1.369306393762915*m0Ion[14]-1.369306393762915*m0Ion[13]-1.369306393762915*m0Ion[12]+1.369306393762915*m0Ion[11]+1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[6]+1.060660171779821*m0Ion[5]-1.060660171779821*m0Ion[4]-0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[6] = 1.185854122563142*m0Ion[17]+1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[14]+0.6846531968814574*m0Ion[13]-0.6846531968814574*m0Ion[11]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]-0.3952847075210473*m0Ion[7]-1.060660171779821*m0Ion[6]-0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[7] = 2.371708245126284*m0Ion[19]-2.371708245126284*m0Ion[18]-2.371708245126284*m0Ion[17]+1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[15]-1.369306393762915*m0Ion[14]-1.369306393762915*m0Ion[13]+1.369306393762915*m0Ion[12]+1.369306393762915*m0Ion[11]-1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[6]-1.060660171779821*m0Ion[5]+1.060660171779821*m0Ion[4]-0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m1iSurfNodal[0] = 2.371708245126284*m1Ion[19]+2.371708245126284*m1Ion[18]+2.371708245126284*m1Ion[17]-1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[15]-1.369306393762915*m1Ion[14]-1.369306393762915*m1Ion[13]-1.369306393762915*m1Ion[12]-1.369306393762915*m1Ion[11]-1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[6]+1.060660171779821*m1Ion[5]+1.060660171779821*m1Ion[4]-0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[1] = -(1.185854122563142*m1Ion[17])-1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[14]+0.6846531968814574*m1Ion[13]+0.6846531968814574*m1Ion[11]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]-0.3952847075210473*m1Ion[7]+1.060660171779821*m1Ion[6]-0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[2] = -(2.371708245126284*m1Ion[19])-2.371708245126284*m1Ion[18]+2.371708245126284*m1Ion[17]-1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[15]-1.369306393762915*m1Ion[14]-1.369306393762915*m1Ion[13]+1.369306393762915*m1Ion[12]-1.369306393762915*m1Ion[11]+1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[6]-1.060660171779821*m1Ion[5]-1.060660171779821*m1Ion[4]-0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[3] = -(1.185854122563142*m1Ion[18])-1.369306393762915*m1Ion[15]+0.6846531968814574*m1Ion[14]-1.369306393762915*m1Ion[13]+0.6846531968814574*m1Ion[12]+0.7905694150420947*m1Ion[9]-0.3952847075210473*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[5]-0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[4] = 1.185854122563142*m1Ion[18]+1.369306393762915*m1Ion[15]+0.6846531968814574*m1Ion[14]-1.369306393762915*m1Ion[13]-0.6846531968814574*m1Ion[12]+0.7905694150420947*m1Ion[9]-0.3952847075210473*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[5]-0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[5] = -(2.371708245126284*m1Ion[19])+2.371708245126284*m1Ion[18]-2.371708245126284*m1Ion[17]+1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[15]-1.369306393762915*m1Ion[14]-1.369306393762915*m1Ion[13]-1.369306393762915*m1Ion[12]+1.369306393762915*m1Ion[11]+1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[6]+1.060660171779821*m1Ion[5]-1.060660171779821*m1Ion[4]-0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[6] = 1.185854122563142*m1Ion[17]+1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[14]+0.6846531968814574*m1Ion[13]-0.6846531968814574*m1Ion[11]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]-0.3952847075210473*m1Ion[7]-1.060660171779821*m1Ion[6]-0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[7] = 2.371708245126284*m1Ion[19]-2.371708245126284*m1Ion[18]-2.371708245126284*m1Ion[17]+1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[15]-1.369306393762915*m1Ion[14]-1.369306393762915*m1Ion[13]+1.369306393762915*m1Ion[12]+1.369306393762915*m1Ion[11]-1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[6]-1.060660171779821*m1Ion[5]+1.060660171779821*m1Ion[4]-0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m2pariSurfNodal[0] = 2.371708245126284*m2parIon[19]+2.371708245126284*m2parIon[18]+2.371708245126284*m2parIon[17]-1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[15]-1.369306393762915*m2parIon[14]-1.369306393762915*m2parIon[13]-1.369306393762915*m2parIon[12]-1.369306393762915*m2parIon[11]-1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[6]+1.060660171779821*m2parIon[5]+1.060660171779821*m2parIon[4]-0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[1] = -(1.185854122563142*m2parIon[17])-1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[14]+0.6846531968814574*m2parIon[13]+0.6846531968814574*m2parIon[11]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]-0.3952847075210473*m2parIon[7]+1.060660171779821*m2parIon[6]-0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[2] = -(2.371708245126284*m2parIon[19])-2.371708245126284*m2parIon[18]+2.371708245126284*m2parIon[17]-1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[15]-1.369306393762915*m2parIon[14]-1.369306393762915*m2parIon[13]+1.369306393762915*m2parIon[12]-1.369306393762915*m2parIon[11]+1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[6]-1.060660171779821*m2parIon[5]-1.060660171779821*m2parIon[4]-0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[3] = -(1.185854122563142*m2parIon[18])-1.369306393762915*m2parIon[15]+0.6846531968814574*m2parIon[14]-1.369306393762915*m2parIon[13]+0.6846531968814574*m2parIon[12]+0.7905694150420947*m2parIon[9]-0.3952847075210473*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[5]-0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[4] = 1.185854122563142*m2parIon[18]+1.369306393762915*m2parIon[15]+0.6846531968814574*m2parIon[14]-1.369306393762915*m2parIon[13]-0.6846531968814574*m2parIon[12]+0.7905694150420947*m2parIon[9]-0.3952847075210473*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[5]-0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[5] = -(2.371708245126284*m2parIon[19])+2.371708245126284*m2parIon[18]-2.371708245126284*m2parIon[17]+1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[15]-1.369306393762915*m2parIon[14]-1.369306393762915*m2parIon[13]-1.369306393762915*m2parIon[12]+1.369306393762915*m2parIon[11]+1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[6]+1.060660171779821*m2parIon[5]-1.060660171779821*m2parIon[4]-0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[6] = 1.185854122563142*m2parIon[17]+1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[14]+0.6846531968814574*m2parIon[13]-0.6846531968814574*m2parIon[11]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]-0.3952847075210473*m2parIon[7]-1.060660171779821*m2parIon[6]-0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[7] = 2.371708245126284*m2parIon[19]-2.371708245126284*m2parIon[18]-2.371708245126284*m2parIon[17]+1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[15]-1.369306393762915*m2parIon[14]-1.369306393762915*m2parIon[13]+1.369306393762915*m2parIon[12]+1.369306393762915*m2parIon[11]-1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[6]-1.060660171779821*m2parIon[5]+1.060660171779821*m2parIon[4]-0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 

  double phiWallNodal[8];
  phiWallNodal[0] = -(1.9364916731037085*phiWall[7])-1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]+1.5*phiWall[3]-0.8660254037844386*phiWall[2]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[1] = 0.9682458365518543*phiWall[6]+1.118033988749895*phiWall[5]-0.5590169943749475*phiWall[4]-0.8660254037844386*phiWall[2]+0.5*phiWall[0]; 
  phiWallNodal[2] = 1.9364916731037085*phiWall[7]-1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]-1.5*phiWall[3]-0.8660254037844386*phiWall[2]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[3] = 0.9682458365518543*phiWall[7]-0.5590169943749475*phiWall[5]+1.118033988749895*phiWall[4]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[4] = -(0.9682458365518543*phiWall[7])-0.5590169943749475*phiWall[5]+1.118033988749895*phiWall[4]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[5] = -(1.9364916731037085*phiWall[7])+1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]-1.5*phiWall[3]+0.8660254037844386*phiWall[2]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[6] = -(0.9682458365518543*phiWall[6])+1.118033988749895*phiWall[5]-0.5590169943749475*phiWall[4]+0.8660254037844386*phiWall[2]+0.5*phiWall[0]; 
  phiWallNodal[7] = 1.9364916731037085*phiWall[7]+1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]+1.5*phiWall[3]+0.8660254037844386*phiWall[2]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 

  double upar_i;
  double Tpar_i;
  double Tpar_e = tempElcBoltz;
  double c_s;
  double Delta_phi_r;

  upar_i = m1iSurfNodal[0]/m0iSurfNodal[0];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[0]*mIon*upar_i-1.0*m2pariSurfNodal[0]*mIon))/m0iSurfNodal[0]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[0] = fmax(phiNodal[0] + Delta_phi_r, phiWallNodal[0]);

  upar_i = m1iSurfNodal[1]/m0iSurfNodal[1];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[1]*mIon*upar_i-1.0*m2pariSurfNodal[1]*mIon))/m0iSurfNodal[1]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[1] = fmax(phiNodal[1] + Delta_phi_r, phiWallNodal[1]);

  upar_i = m1iSurfNodal[2]/m0iSurfNodal[2];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[2]*mIon*upar_i-1.0*m2pariSurfNodal[2]*mIon))/m0iSurfNodal[2]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[2] = fmax(phiNodal[2] + Delta_phi_r, phiWallNodal[2]);

  upar_i = m1iSurfNodal[3]/m0iSurfNodal[3];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[3]*mIon*upar_i-1.0*m2pariSurfNodal[3]*mIon))/m0iSurfNodal[3]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[3] = fmax(phiNodal[3] + Delta_phi_r, phiWallNodal[3]);

  upar_i = m1iSurfNodal[4]/m0iSurfNodal[4];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[4]*mIon*upar_i-1.0*m2pariSurfNodal[4]*mIon))/m0iSurfNodal[4]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[4] = fmax(phiNodal[4] + Delta_phi_r, phiWallNodal[4]);

  upar_i = m1iSurfNodal[5]/m0iSurfNodal[5];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[5]*mIon*upar_i-1.0*m2pariSurfNodal[5]*mIon))/m0iSurfNodal[5]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[5] = fmax(phiNodal[5] + Delta_phi_r, phiWallNodal[5]);

  upar_i = m1iSurfNodal[6]/m0iSurfNodal[6];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[6]*mIon*upar_i-1.0*m2pariSurfNodal[6]*mIon))/m0iSurfNodal[6]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[6] = fmax(phiNodal[6] + Delta_phi_r, phiWallNodal[6]);

  upar_i = m1iSurfNodal[7]/m0iSurfNodal[7];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[7]*mIon*upar_i-1.0*m2pariSurfNodal[7]*mIon))/m0iSurfNodal[7]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[7] = fmax(phiNodal[7] + Delta_phi_r, phiWallNodal[7]);

  phi[0] = -(0.3535533905932737*phiNodal[19])+0.4714045207910317*phiNodal[18]-0.3535533905932737*phiNodal[17]+0.4714045207910317*phiNodal[16]+0.4714045207910317*phiNodal[15]-0.3535533905932737*phiNodal[14]+0.4714045207910317*phiNodal[13]-0.3535533905932737*phiNodal[12]+0.4714045207910317*phiNodal[11]+0.4714045207910317*phiNodal[10]+0.4714045207910317*phiNodal[9]+0.4714045207910317*phiNodal[8]-0.3535533905932737*phiNodal[7]+0.4714045207910317*phiNodal[6]-0.3535533905932737*phiNodal[5]+0.4714045207910317*phiNodal[4]+0.4714045207910317*phiNodal[3]-0.3535533905932737*phiNodal[2]+0.4714045207910317*phiNodal[1]-0.3535533905932737*phiNodal[0]; 
  phi[1] = -(0.06804138174397717*phiNodal[19])+0.06804138174397717*phiNodal[17]+0.27216552697590873*phiNodal[16]-0.27216552697590873*phiNodal[15]-0.06804138174397717*phiNodal[14]+0.06804138174397717*phiNodal[12]+0.27216552697590873*phiNodal[11]-0.27216552697590873*phiNodal[10]+0.27216552697590873*phiNodal[9]-0.27216552697590873*phiNodal[8]-0.06804138174397717*phiNodal[7]+0.06804138174397717*phiNodal[5]+0.27216552697590873*phiNodal[4]-0.27216552697590873*phiNodal[3]-0.06804138174397717*phiNodal[2]+0.06804138174397717*phiNodal[0]; 
  phi[2] = -(0.06804138174397717*phiNodal[19])+0.27216552697590873*phiNodal[18]-0.06804138174397717*phiNodal[17]+0.06804138174397717*phiNodal[14]-0.27216552697590873*phiNodal[13]+0.06804138174397717*phiNodal[12]+0.27216552697590873*phiNodal[11]+0.27216552697590873*phiNodal[10]-0.27216552697590873*phiNodal[9]-0.27216552697590873*phiNodal[8]-0.06804138174397717*phiNodal[7]+0.27216552697590873*phiNodal[6]-0.06804138174397717*phiNodal[5]+0.06804138174397717*phiNodal[2]-0.27216552697590873*phiNodal[1]+0.06804138174397717*phiNodal[0]; 
  phi[3] = -(0.06804138174397717*phiNodal[19])+0.27216552697590873*phiNodal[18]-0.06804138174397717*phiNodal[17]+0.27216552697590873*phiNodal[16]+0.27216552697590873*phiNodal[15]-0.06804138174397717*phiNodal[14]+0.27216552697590873*phiNodal[13]-0.06804138174397717*phiNodal[12]+0.06804138174397717*phiNodal[7]-0.27216552697590873*phiNodal[6]+0.06804138174397717*phiNodal[5]-0.27216552697590873*phiNodal[4]-0.27216552697590873*phiNodal[3]+0.06804138174397717*phiNodal[2]-0.27216552697590873*phiNodal[1]+0.06804138174397717*phiNodal[0]; 
  phi[4] = 0.0392837100659193*phiNodal[19]-0.0392837100659193*phiNodal[17]-0.0392837100659193*phiNodal[14]+0.0392837100659193*phiNodal[12]+0.15713484026367722*phiNodal[11]-0.15713484026367722*phiNodal[10]-0.15713484026367722*phiNodal[9]+0.15713484026367722*phiNodal[8]+0.0392837100659193*phiNodal[7]-0.0392837100659193*phiNodal[5]-0.0392837100659193*phiNodal[2]+0.0392837100659193*phiNodal[0]; 
  phi[5] = 0.0392837100659193*phiNodal[19]-0.0392837100659193*phiNodal[17]+0.15713484026367722*phiNodal[16]-0.15713484026367722*phiNodal[15]+0.0392837100659193*phiNodal[14]-0.0392837100659193*phiNodal[12]-0.0392837100659193*phiNodal[7]+0.0392837100659193*phiNodal[5]-0.15713484026367722*phiNodal[4]+0.15713484026367722*phiNodal[3]-0.0392837100659193*phiNodal[2]+0.0392837100659193*phiNodal[0]; 
  phi[6] = 0.0392837100659193*phiNodal[19]+0.15713484026367722*phiNodal[18]+0.0392837100659193*phiNodal[17]-0.0392837100659193*phiNodal[14]-0.15713484026367722*phiNodal[13]-0.0392837100659193*phiNodal[12]-0.0392837100659193*phiNodal[7]-0.15713484026367722*phiNodal[6]-0.0392837100659193*phiNodal[5]+0.0392837100659193*phiNodal[2]+0.15713484026367722*phiNodal[1]+0.0392837100659193*phiNodal[0]; 
  phi[7] = 0.10540925533894596*phiNodal[19]-0.21081851067789195*phiNodal[18]+0.10540925533894596*phiNodal[17]+0.10540925533894596*phiNodal[14]-0.21081851067789195*phiNodal[13]+0.10540925533894596*phiNodal[12]+0.10540925533894596*phiNodal[7]-0.21081851067789195*phiNodal[6]+0.10540925533894596*phiNodal[5]+0.10540925533894596*phiNodal[2]-0.21081851067789195*phiNodal[1]+0.10540925533894596*phiNodal[0]; 
  phi[8] = 0.10540925533894596*phiNodal[19]+0.10540925533894596*phiNodal[17]-0.21081851067789195*phiNodal[16]-0.21081851067789195*phiNodal[15]+0.10540925533894596*phiNodal[14]+0.10540925533894596*phiNodal[12]+0.10540925533894596*phiNodal[7]+0.10540925533894596*phiNodal[5]-0.21081851067789195*phiNodal[4]-0.21081851067789195*phiNodal[3]+0.10540925533894596*phiNodal[2]+0.10540925533894596*phiNodal[0]; 
  phi[9] = 0.10540925533894596*phiNodal[19]+0.10540925533894596*phiNodal[17]+0.10540925533894596*phiNodal[14]+0.10540925533894596*phiNodal[12]-0.21081851067789195*phiNodal[11]-0.21081851067789195*phiNodal[10]-0.21081851067789195*phiNodal[9]-0.21081851067789195*phiNodal[8]+0.10540925533894596*phiNodal[7]+0.10540925533894596*phiNodal[5]+0.10540925533894596*phiNodal[2]+0.10540925533894596*phiNodal[0]; 
  phi[10] = 0.06804138174397717*phiNodal[19]-0.06804138174397717*phiNodal[17]-0.06804138174397717*phiNodal[14]+0.06804138174397717*phiNodal[12]-0.06804138174397717*phiNodal[7]+0.06804138174397717*phiNodal[5]+0.06804138174397717*phiNodal[2]-0.06804138174397717*phiNodal[0]; 
  phi[11] = 0.06085806194501844*phiNodal[19]-0.1217161238900369*phiNodal[18]+0.06085806194501844*phiNodal[17]-0.06085806194501844*phiNodal[14]+0.1217161238900369*phiNodal[13]-0.06085806194501844*phiNodal[12]+0.06085806194501844*phiNodal[7]-0.1217161238900369*phiNodal[6]+0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]+0.1217161238900369*phiNodal[1]-0.06085806194501844*phiNodal[0]; 
  phi[12] = 0.06085806194501844*phiNodal[19]-0.06085806194501844*phiNodal[17]-0.1217161238900369*phiNodal[16]+0.1217161238900369*phiNodal[15]+0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]+0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]-0.1217161238900369*phiNodal[4]+0.1217161238900369*phiNodal[3]+0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[13] = 0.06085806194501844*phiNodal[19]-0.1217161238900369*phiNodal[18]+0.06085806194501844*phiNodal[17]+0.06085806194501844*phiNodal[14]-0.1217161238900369*phiNodal[13]+0.06085806194501844*phiNodal[12]-0.06085806194501844*phiNodal[7]+0.1217161238900369*phiNodal[6]-0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]+0.1217161238900369*phiNodal[1]-0.06085806194501844*phiNodal[0]; 
  phi[14] = 0.06085806194501844*phiNodal[19]+0.06085806194501844*phiNodal[17]-0.1217161238900369*phiNodal[16]-0.1217161238900369*phiNodal[15]+0.06085806194501844*phiNodal[14]+0.06085806194501844*phiNodal[12]-0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]+0.1217161238900369*phiNodal[4]+0.1217161238900369*phiNodal[3]-0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[15] = 0.06085806194501844*phiNodal[19]-0.06085806194501844*phiNodal[17]+0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]-0.1217161238900369*phiNodal[11]+0.1217161238900369*phiNodal[10]-0.1217161238900369*phiNodal[9]+0.1217161238900369*phiNodal[8]+0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]+0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[16] = 0.06085806194501844*phiNodal[19]+0.06085806194501844*phiNodal[17]-0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]-0.1217161238900369*phiNodal[11]-0.1217161238900369*phiNodal[10]+0.1217161238900369*phiNodal[9]+0.1217161238900369*phiNodal[8]+0.06085806194501844*phiNodal[7]+0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[17] = 0.03513641844631532*phiNodal[19]-0.07027283689263064*phiNodal[18]+0.03513641844631532*phiNodal[17]-0.03513641844631532*phiNodal[14]+0.07027283689263064*phiNodal[13]-0.03513641844631532*phiNodal[12]-0.03513641844631532*phiNodal[7]+0.07027283689263064*phiNodal[6]-0.03513641844631532*phiNodal[5]+0.03513641844631532*phiNodal[2]-0.07027283689263064*phiNodal[1]+0.03513641844631532*phiNodal[0]; 
  phi[18] = 0.03513641844631532*phiNodal[19]-0.03513641844631532*phiNodal[17]-0.07027283689263064*phiNodal[16]+0.07027283689263064*phiNodal[15]+0.03513641844631532*phiNodal[14]-0.03513641844631532*phiNodal[12]-0.03513641844631532*phiNodal[7]+0.03513641844631532*phiNodal[5]+0.07027283689263064*phiNodal[4]-0.07027283689263064*phiNodal[3]-0.03513641844631532*phiNodal[2]+0.03513641844631532*phiNodal[0]; 
  phi[19] = 0.03513641844631532*phiNodal[19]-0.03513641844631532*phiNodal[17]-0.03513641844631532*phiNodal[14]+0.03513641844631532*phiNodal[12]-0.07027283689263064*phiNodal[11]+0.07027283689263064*phiNodal[10]+0.07027283689263064*phiNodal[9]-0.07027283689263064*phiNodal[8]+0.03513641844631532*phiNodal[7]-0.03513641844631532*phiNodal[5]-0.03513641844631532*phiNodal[2]+0.03513641844631532*phiNodal[0]; 
 
}

GKYL_CU_DH void sheath_rarefaction_phi_mod_boltzmann_elc_upper_3x_ser_p2(double elem_q, double mElc, double tempElcBoltz, const double *momsElc, double mIon, const double *momsIon, const double *phiWall, double *phi) 
{ 
  // elem_q: elementary charge.
  // mElc: electron mass.
  // tempElcBoltz: electron temperature in Boltzmann electron model.
  // momsElc: m0, m1, m2par (and m2perp, but not used) moments of electrons.
  // mIon: ion mass.
  // momsIon: m0, m1, m2par (and m2perp, but not used) moments of ions.
  // phi: electrostatic potential.

  double phiNodal[20];
  phiNodal[0] = 2.371708245126284*phi[19]+2.371708245126284*phi[18]+2.371708245126284*phi[17]-1.369306393762915*phi[16]-1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]-1.369306393762915*phi[12]-1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]+1.060660171779821*phi[5]+1.060660171779821*phi[4]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[1] = -(1.185854122563142*phi[17])-1.369306393762915*phi[16]-1.369306393762915*phi[14]+0.6846531968814574*phi[13]+0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]+1.060660171779821*phi[6]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[2] = -(2.371708245126284*phi[19])-2.371708245126284*phi[18]+2.371708245126284*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]+1.369306393762915*phi[12]-1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]-1.060660171779821*phi[5]-1.060660171779821*phi[4]-0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[3] = -(1.185854122563142*phi[18])-1.369306393762915*phi[15]+0.6846531968814574*phi[14]-1.369306393762915*phi[13]+0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[5]-0.6123724356957944*phi[3]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[4] = 1.185854122563142*phi[18]+1.369306393762915*phi[15]+0.6846531968814574*phi[14]-1.369306393762915*phi[13]-0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[5]-0.6123724356957944*phi[3]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[5] = -(2.371708245126284*phi[19])+2.371708245126284*phi[18]-2.371708245126284*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]-1.369306393762915*phi[12]+1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]+1.060660171779821*phi[5]-1.060660171779821*phi[4]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[6] = 1.185854122563142*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[14]+0.6846531968814574*phi[13]-0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]-1.060660171779821*phi[6]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[7] = 2.371708245126284*phi[19]-2.371708245126284*phi[18]-2.371708245126284*phi[17]+1.369306393762915*phi[16]+1.369306393762915*phi[15]-1.369306393762915*phi[14]-1.369306393762915*phi[13]+1.369306393762915*phi[12]+1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]-1.060660171779821*phi[5]+1.060660171779821*phi[4]-0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[8] = -(1.185854122563142*phi[19])+0.6846531968814574*phi[16]+0.6846531968814574*phi[15]-1.369306393762915*phi[12]-1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[4]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[9] = 1.185854122563142*phi[19]+0.6846531968814574*phi[16]-0.6846531968814574*phi[15]+1.369306393762915*phi[12]-1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[4]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[10] = 1.185854122563142*phi[19]-0.6846531968814574*phi[16]+0.6846531968814574*phi[15]-1.369306393762915*phi[12]+1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[4]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[11] = -(1.185854122563142*phi[19])-0.6846531968814574*phi[16]-0.6846531968814574*phi[15]+1.369306393762915*phi[12]+1.369306393762915*phi[11]-0.3952847075210473*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[4]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[12] = 2.371708245126284*phi[19]-2.371708245126284*phi[18]-2.371708245126284*phi[17]-1.369306393762915*phi[16]-1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]-1.369306393762915*phi[12]-1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]-1.060660171779821*phi[5]+1.060660171779821*phi[4]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[13] = 1.185854122563142*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[14]-0.6846531968814574*phi[13]+0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]-1.060660171779821*phi[6]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[14] = -(2.371708245126284*phi[19])+2.371708245126284*phi[18]-2.371708245126284*phi[17]-1.369306393762915*phi[16]+1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]+1.369306393762915*phi[12]-1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[6]+1.060660171779821*phi[5]-1.060660171779821*phi[4]+0.6123724356957944*phi[3]-0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[15] = 1.185854122563142*phi[18]-1.369306393762915*phi[15]-0.6846531968814574*phi[14]+1.369306393762915*phi[13]+0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]-1.060660171779821*phi[5]+0.6123724356957944*phi[3]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[16] = -(1.185854122563142*phi[18])+1.369306393762915*phi[15]-0.6846531968814574*phi[14]+1.369306393762915*phi[13]-0.6846531968814574*phi[12]+0.7905694150420947*phi[9]-0.3952847075210473*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[5]+0.6123724356957944*phi[3]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[17] = -(2.371708245126284*phi[19])-2.371708245126284*phi[18]+2.371708245126284*phi[17]+1.369306393762915*phi[16]-1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]-1.369306393762915*phi[12]+1.369306393762915*phi[11]-1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]-1.060660171779821*phi[5]-1.060660171779821*phi[4]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]-0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 
  phiNodal[18] = -(1.185854122563142*phi[17])+1.369306393762915*phi[16]+1.369306393762915*phi[14]-0.6846531968814574*phi[13]-0.6846531968814574*phi[11]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]-0.3952847075210473*phi[7]+1.060660171779821*phi[6]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.3535533905932737*phi[0]; 
  phiNodal[19] = 2.371708245126284*phi[19]+2.371708245126284*phi[18]+2.371708245126284*phi[17]+1.369306393762915*phi[16]+1.369306393762915*phi[15]+1.369306393762915*phi[14]+1.369306393762915*phi[13]+1.369306393762915*phi[12]+1.369306393762915*phi[11]+1.837117307087383*phi[10]+0.7905694150420947*phi[9]+0.7905694150420947*phi[8]+0.7905694150420947*phi[7]+1.060660171779821*phi[6]+1.060660171779821*phi[5]+1.060660171779821*phi[4]+0.6123724356957944*phi[3]+0.6123724356957944*phi[2]+0.6123724356957944*phi[1]+0.3535533905932737*phi[0]; 

  const double *m0Ion = &momsIon[0];
  const double *m1Ion = &momsIon[20];
  const double *m2parIon = &momsIon[40];

  double m0iSurfNodal[8];
  double m1iSurfNodal[8];
  double m2pariSurfNodal[8];
  m0iSurfNodal[0] = 2.371708245126284*m0Ion[19]-2.371708245126284*m0Ion[18]-2.371708245126284*m0Ion[17]-1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[15]+1.369306393762915*m0Ion[14]+1.369306393762915*m0Ion[13]-1.369306393762915*m0Ion[12]-1.369306393762915*m0Ion[11]+1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[6]-1.060660171779821*m0Ion[5]+1.060660171779821*m0Ion[4]+0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[1] = 1.185854122563142*m0Ion[17]-1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[14]-0.6846531968814574*m0Ion[13]+0.6846531968814574*m0Ion[11]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]-0.3952847075210473*m0Ion[7]-1.060660171779821*m0Ion[6]+0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[2] = -(2.371708245126284*m0Ion[19])+2.371708245126284*m0Ion[18]-2.371708245126284*m0Ion[17]-1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[15]+1.369306393762915*m0Ion[14]+1.369306393762915*m0Ion[13]+1.369306393762915*m0Ion[12]-1.369306393762915*m0Ion[11]-1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[6]+1.060660171779821*m0Ion[5]-1.060660171779821*m0Ion[4]+0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[2]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[3] = 1.185854122563142*m0Ion[18]-1.369306393762915*m0Ion[15]-0.6846531968814574*m0Ion[14]+1.369306393762915*m0Ion[13]+0.6846531968814574*m0Ion[12]+0.7905694150420947*m0Ion[9]-0.3952847075210473*m0Ion[8]+0.7905694150420947*m0Ion[7]-1.060660171779821*m0Ion[5]+0.6123724356957944*m0Ion[3]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[4] = -(1.185854122563142*m0Ion[18])+1.369306393762915*m0Ion[15]-0.6846531968814574*m0Ion[14]+1.369306393762915*m0Ion[13]-0.6846531968814574*m0Ion[12]+0.7905694150420947*m0Ion[9]-0.3952847075210473*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[5]+0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[5] = -(2.371708245126284*m0Ion[19])-2.371708245126284*m0Ion[18]+2.371708245126284*m0Ion[17]+1.369306393762915*m0Ion[16]-1.369306393762915*m0Ion[15]+1.369306393762915*m0Ion[14]+1.369306393762915*m0Ion[13]-1.369306393762915*m0Ion[12]+1.369306393762915*m0Ion[11]-1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[6]-1.060660171779821*m0Ion[5]-1.060660171779821*m0Ion[4]+0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]-0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[6] = -(1.185854122563142*m0Ion[17])+1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[14]-0.6846531968814574*m0Ion[13]-0.6846531968814574*m0Ion[11]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]-0.3952847075210473*m0Ion[7]+1.060660171779821*m0Ion[6]+0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]+0.3535533905932737*m0Ion[0]; 
  m0iSurfNodal[7] = 2.371708245126284*m0Ion[19]+2.371708245126284*m0Ion[18]+2.371708245126284*m0Ion[17]+1.369306393762915*m0Ion[16]+1.369306393762915*m0Ion[15]+1.369306393762915*m0Ion[14]+1.369306393762915*m0Ion[13]+1.369306393762915*m0Ion[12]+1.369306393762915*m0Ion[11]+1.837117307087383*m0Ion[10]+0.7905694150420947*m0Ion[9]+0.7905694150420947*m0Ion[8]+0.7905694150420947*m0Ion[7]+1.060660171779821*m0Ion[6]+1.060660171779821*m0Ion[5]+1.060660171779821*m0Ion[4]+0.6123724356957944*m0Ion[3]+0.6123724356957944*m0Ion[2]+0.6123724356957944*m0Ion[1]+0.3535533905932737*m0Ion[0]; 
  m1iSurfNodal[0] = 2.371708245126284*m1Ion[19]-2.371708245126284*m1Ion[18]-2.371708245126284*m1Ion[17]-1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[15]+1.369306393762915*m1Ion[14]+1.369306393762915*m1Ion[13]-1.369306393762915*m1Ion[12]-1.369306393762915*m1Ion[11]+1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[6]-1.060660171779821*m1Ion[5]+1.060660171779821*m1Ion[4]+0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[1] = 1.185854122563142*m1Ion[17]-1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[14]-0.6846531968814574*m1Ion[13]+0.6846531968814574*m1Ion[11]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]-0.3952847075210473*m1Ion[7]-1.060660171779821*m1Ion[6]+0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[2] = -(2.371708245126284*m1Ion[19])+2.371708245126284*m1Ion[18]-2.371708245126284*m1Ion[17]-1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[15]+1.369306393762915*m1Ion[14]+1.369306393762915*m1Ion[13]+1.369306393762915*m1Ion[12]-1.369306393762915*m1Ion[11]-1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[6]+1.060660171779821*m1Ion[5]-1.060660171779821*m1Ion[4]+0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[2]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[3] = 1.185854122563142*m1Ion[18]-1.369306393762915*m1Ion[15]-0.6846531968814574*m1Ion[14]+1.369306393762915*m1Ion[13]+0.6846531968814574*m1Ion[12]+0.7905694150420947*m1Ion[9]-0.3952847075210473*m1Ion[8]+0.7905694150420947*m1Ion[7]-1.060660171779821*m1Ion[5]+0.6123724356957944*m1Ion[3]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[4] = -(1.185854122563142*m1Ion[18])+1.369306393762915*m1Ion[15]-0.6846531968814574*m1Ion[14]+1.369306393762915*m1Ion[13]-0.6846531968814574*m1Ion[12]+0.7905694150420947*m1Ion[9]-0.3952847075210473*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[5]+0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[5] = -(2.371708245126284*m1Ion[19])-2.371708245126284*m1Ion[18]+2.371708245126284*m1Ion[17]+1.369306393762915*m1Ion[16]-1.369306393762915*m1Ion[15]+1.369306393762915*m1Ion[14]+1.369306393762915*m1Ion[13]-1.369306393762915*m1Ion[12]+1.369306393762915*m1Ion[11]-1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[6]-1.060660171779821*m1Ion[5]-1.060660171779821*m1Ion[4]+0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]-0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[6] = -(1.185854122563142*m1Ion[17])+1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[14]-0.6846531968814574*m1Ion[13]-0.6846531968814574*m1Ion[11]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]-0.3952847075210473*m1Ion[7]+1.060660171779821*m1Ion[6]+0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]+0.3535533905932737*m1Ion[0]; 
  m1iSurfNodal[7] = 2.371708245126284*m1Ion[19]+2.371708245126284*m1Ion[18]+2.371708245126284*m1Ion[17]+1.369306393762915*m1Ion[16]+1.369306393762915*m1Ion[15]+1.369306393762915*m1Ion[14]+1.369306393762915*m1Ion[13]+1.369306393762915*m1Ion[12]+1.369306393762915*m1Ion[11]+1.837117307087383*m1Ion[10]+0.7905694150420947*m1Ion[9]+0.7905694150420947*m1Ion[8]+0.7905694150420947*m1Ion[7]+1.060660171779821*m1Ion[6]+1.060660171779821*m1Ion[5]+1.060660171779821*m1Ion[4]+0.6123724356957944*m1Ion[3]+0.6123724356957944*m1Ion[2]+0.6123724356957944*m1Ion[1]+0.3535533905932737*m1Ion[0]; 
  m2pariSurfNodal[0] = 2.371708245126284*m2parIon[19]-2.371708245126284*m2parIon[18]-2.371708245126284*m2parIon[17]-1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[15]+1.369306393762915*m2parIon[14]+1.369306393762915*m2parIon[13]-1.369306393762915*m2parIon[12]-1.369306393762915*m2parIon[11]+1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[6]-1.060660171779821*m2parIon[5]+1.060660171779821*m2parIon[4]+0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[1] = 1.185854122563142*m2parIon[17]-1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[14]-0.6846531968814574*m2parIon[13]+0.6846531968814574*m2parIon[11]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]-0.3952847075210473*m2parIon[7]-1.060660171779821*m2parIon[6]+0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[2] = -(2.371708245126284*m2parIon[19])+2.371708245126284*m2parIon[18]-2.371708245126284*m2parIon[17]-1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[15]+1.369306393762915*m2parIon[14]+1.369306393762915*m2parIon[13]+1.369306393762915*m2parIon[12]-1.369306393762915*m2parIon[11]-1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[6]+1.060660171779821*m2parIon[5]-1.060660171779821*m2parIon[4]+0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[2]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[3] = 1.185854122563142*m2parIon[18]-1.369306393762915*m2parIon[15]-0.6846531968814574*m2parIon[14]+1.369306393762915*m2parIon[13]+0.6846531968814574*m2parIon[12]+0.7905694150420947*m2parIon[9]-0.3952847075210473*m2parIon[8]+0.7905694150420947*m2parIon[7]-1.060660171779821*m2parIon[5]+0.6123724356957944*m2parIon[3]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[4] = -(1.185854122563142*m2parIon[18])+1.369306393762915*m2parIon[15]-0.6846531968814574*m2parIon[14]+1.369306393762915*m2parIon[13]-0.6846531968814574*m2parIon[12]+0.7905694150420947*m2parIon[9]-0.3952847075210473*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[5]+0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[5] = -(2.371708245126284*m2parIon[19])-2.371708245126284*m2parIon[18]+2.371708245126284*m2parIon[17]+1.369306393762915*m2parIon[16]-1.369306393762915*m2parIon[15]+1.369306393762915*m2parIon[14]+1.369306393762915*m2parIon[13]-1.369306393762915*m2parIon[12]+1.369306393762915*m2parIon[11]-1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[6]-1.060660171779821*m2parIon[5]-1.060660171779821*m2parIon[4]+0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]-0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[6] = -(1.185854122563142*m2parIon[17])+1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[14]-0.6846531968814574*m2parIon[13]-0.6846531968814574*m2parIon[11]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]-0.3952847075210473*m2parIon[7]+1.060660171779821*m2parIon[6]+0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]+0.3535533905932737*m2parIon[0]; 
  m2pariSurfNodal[7] = 2.371708245126284*m2parIon[19]+2.371708245126284*m2parIon[18]+2.371708245126284*m2parIon[17]+1.369306393762915*m2parIon[16]+1.369306393762915*m2parIon[15]+1.369306393762915*m2parIon[14]+1.369306393762915*m2parIon[13]+1.369306393762915*m2parIon[12]+1.369306393762915*m2parIon[11]+1.837117307087383*m2parIon[10]+0.7905694150420947*m2parIon[9]+0.7905694150420947*m2parIon[8]+0.7905694150420947*m2parIon[7]+1.060660171779821*m2parIon[6]+1.060660171779821*m2parIon[5]+1.060660171779821*m2parIon[4]+0.6123724356957944*m2parIon[3]+0.6123724356957944*m2parIon[2]+0.6123724356957944*m2parIon[1]+0.3535533905932737*m2parIon[0]; 

  double phiWallNodal[8];
  phiWallNodal[0] = -(1.9364916731037085*phiWall[7])-1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]+1.5*phiWall[3]-0.8660254037844386*phiWall[2]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[1] = 0.9682458365518543*phiWall[6]+1.118033988749895*phiWall[5]-0.5590169943749475*phiWall[4]-0.8660254037844386*phiWall[2]+0.5*phiWall[0]; 
  phiWallNodal[2] = 1.9364916731037085*phiWall[7]-1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]-1.5*phiWall[3]-0.8660254037844386*phiWall[2]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[3] = 0.9682458365518543*phiWall[7]-0.5590169943749475*phiWall[5]+1.118033988749895*phiWall[4]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[4] = -(0.9682458365518543*phiWall[7])-0.5590169943749475*phiWall[5]+1.118033988749895*phiWall[4]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[5] = -(1.9364916731037085*phiWall[7])+1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]-1.5*phiWall[3]+0.8660254037844386*phiWall[2]-0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 
  phiWallNodal[6] = -(0.9682458365518543*phiWall[6])+1.118033988749895*phiWall[5]-0.5590169943749475*phiWall[4]+0.8660254037844386*phiWall[2]+0.5*phiWall[0]; 
  phiWallNodal[7] = 1.9364916731037085*phiWall[7]+1.9364916731037085*phiWall[6]+1.118033988749895*phiWall[5]+1.118033988749895*phiWall[4]+1.5*phiWall[3]+0.8660254037844386*phiWall[2]+0.8660254037844386*phiWall[1]+0.5*phiWall[0]; 

  double upar_i;
  double Tpar_i;
  double Tpar_e = tempElcBoltz;
  double c_s;
  double Delta_phi_r;

  upar_i = m1iSurfNodal[0]/m0iSurfNodal[0];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[0]*mIon*upar_i-1.0*m2pariSurfNodal[0]*mIon))/m0iSurfNodal[0]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[12] = fmax(phiNodal[12] + Delta_phi_r, phiWallNodal[0]);

  upar_i = m1iSurfNodal[1]/m0iSurfNodal[1];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[1]*mIon*upar_i-1.0*m2pariSurfNodal[1]*mIon))/m0iSurfNodal[1]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[13] = fmax(phiNodal[13] + Delta_phi_r, phiWallNodal[1]);

  upar_i = m1iSurfNodal[2]/m0iSurfNodal[2];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[2]*mIon*upar_i-1.0*m2pariSurfNodal[2]*mIon))/m0iSurfNodal[2]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[14] = fmax(phiNodal[14] + Delta_phi_r, phiWallNodal[2]);

  upar_i = m1iSurfNodal[3]/m0iSurfNodal[3];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[3]*mIon*upar_i-1.0*m2pariSurfNodal[3]*mIon))/m0iSurfNodal[3]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[15] = fmax(phiNodal[15] + Delta_phi_r, phiWallNodal[3]);

  upar_i = m1iSurfNodal[4]/m0iSurfNodal[4];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[4]*mIon*upar_i-1.0*m2pariSurfNodal[4]*mIon))/m0iSurfNodal[4]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[16] = fmax(phiNodal[16] + Delta_phi_r, phiWallNodal[4]);

  upar_i = m1iSurfNodal[5]/m0iSurfNodal[5];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[5]*mIon*upar_i-1.0*m2pariSurfNodal[5]*mIon))/m0iSurfNodal[5]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[17] = fmax(phiNodal[17] + Delta_phi_r, phiWallNodal[5]);

  upar_i = m1iSurfNodal[6]/m0iSurfNodal[6];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[6]*mIon*upar_i-1.0*m2pariSurfNodal[6]*mIon))/m0iSurfNodal[6]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[18] = fmax(phiNodal[18] + Delta_phi_r, phiWallNodal[6]);

  upar_i = m1iSurfNodal[7]/m0iSurfNodal[7];
  Tpar_i = fmax(0.0, -((1.0*(m1iSurfNodal[7]*mIon*upar_i-1.0*m2pariSurfNodal[7]*mIon))/m0iSurfNodal[7]));

  c_s = sqrt((3.0*Tpar_i+Tpar_e)/mIon);
  if (c_s > 0.0)
    Delta_phi_r = ((fmin(1.0,fabs(upar_i)/c_s)-1.0)*Tpar_e)/elem_q;
  else
    Delta_phi_r = 0.0;

  phiNodal[19] = fmax(phiNodal[19] + Delta_phi_r, phiWallNodal[7]);

  phi[0] = -(0.3535533905932737*phiNodal[19])+0.4714045207910317*phiNodal[18]-0.3535533905932737*phiNodal[17]+0.4714045207910317*phiNodal[16]+0.4714045207910317*phiNodal[15]-0.3535533905932737*phiNodal[14]+0.4714045207910317*phiNodal[13]-0.3535533905932737*phiNodal[12]+0.4714045207910317*phiNodal[11]+0.4714045207910317*phiNodal[10]+0.4714045207910317*phiNodal[9]+0.4714045207910317*phiNodal[8]-0.3535533905932737*phiNodal[7]+0.4714045207910317*phiNodal[6]-0.3535533905932737*phiNodal[5]+0.4714045207910317*phiNodal[4]+0.4714045207910317*phiNodal[3]-0.3535533905932737*phiNodal[2]+0.4714045207910317*phiNodal[1]-0.3535533905932737*phiNodal[0]; 
  phi[1] = -(0.06804138174397717*phiNodal[19])+0.06804138174397717*phiNodal[17]+0.27216552697590873*phiNodal[16]-0.27216552697590873*phiNodal[15]-0.06804138174397717*phiNodal[14]+0.06804138174397717*phiNodal[12]+0.27216552697590873*phiNodal[11]-0.27216552697590873*phiNodal[10]+0.27216552697590873*phiNodal[9]-0.27216552697590873*phiNodal[8]-0.06804138174397717*phiNodal[7]+0.06804138174397717*phiNodal[5]+0.27216552697590873*phiNodal[4]-0.27216552697590873*phiNodal[3]-0.06804138174397717*phiNodal[2]+0.06804138174397717*phiNodal[0]; 
  phi[2] = -(0.06804138174397717*phiNodal[19])+0.27216552697590873*phiNodal[18]-0.06804138174397717*phiNodal[17]+0.06804138174397717*phiNodal[14]-0.27216552697590873*phiNodal[13]+0.06804138174397717*phiNodal[12]+0.27216552697590873*phiNodal[11]+0.27216552697590873*phiNodal[10]-0.27216552697590873*phiNodal[9]-0.27216552697590873*phiNodal[8]-0.06804138174397717*phiNodal[7]+0.27216552697590873*phiNodal[6]-0.06804138174397717*phiNodal[5]+0.06804138174397717*phiNodal[2]-0.27216552697590873*phiNodal[1]+0.06804138174397717*phiNodal[0]; 
  phi[3] = -(0.06804138174397717*phiNodal[19])+0.27216552697590873*phiNodal[18]-0.06804138174397717*phiNodal[17]+0.27216552697590873*phiNodal[16]+0.27216552697590873*phiNodal[15]-0.06804138174397717*phiNodal[14]+0.27216552697590873*phiNodal[13]-0.06804138174397717*phiNodal[12]+0.06804138174397717*phiNodal[7]-0.27216552697590873*phiNodal[6]+0.06804138174397717*phiNodal[5]-0.27216552697590873*phiNodal[4]-0.27216552697590873*phiNodal[3]+0.06804138174397717*phiNodal[2]-0.27216552697590873*phiNodal[1]+0.06804138174397717*phiNodal[0]; 
  phi[4] = 0.0392837100659193*phiNodal[19]-0.0392837100659193*phiNodal[17]-0.0392837100659193*phiNodal[14]+0.0392837100659193*phiNodal[12]+0.15713484026367722*phiNodal[11]-0.15713484026367722*phiNodal[10]-0.15713484026367722*phiNodal[9]+0.15713484026367722*phiNodal[8]+0.0392837100659193*phiNodal[7]-0.0392837100659193*phiNodal[5]-0.0392837100659193*phiNodal[2]+0.0392837100659193*phiNodal[0]; 
  phi[5] = 0.0392837100659193*phiNodal[19]-0.0392837100659193*phiNodal[17]+0.15713484026367722*phiNodal[16]-0.15713484026367722*phiNodal[15]+0.0392837100659193*phiNodal[14]-0.0392837100659193*phiNodal[12]-0.0392837100659193*phiNodal[7]+0.0392837100659193*phiNodal[5]-0.15713484026367722*phiNodal[4]+0.15713484026367722*phiNodal[3]-0.0392837100659193*phiNodal[2]+0.0392837100659193*phiNodal[0]; 
  phi[6] = 0.0392837100659193*phiNodal[19]+0.15713484026367722*phiNodal[18]+0.0392837100659193*phiNodal[17]-0.0392837100659193*phiNodal[14]-0.15713484026367722*phiNodal[13]-0.0392837100659193*phiNodal[12]-0.0392837100659193*phiNodal[7]-0.15713484026367722*phiNodal[6]-0.0392837100659193*phiNodal[5]+0.0392837100659193*phiNodal[2]+0.15713484026367722*phiNodal[1]+0.0392837100659193*phiNodal[0]; 
  phi[7] = 0.10540925533894596*phiNodal[19]-0.21081851067789195*phiNodal[18]+0.10540925533894596*phiNodal[17]+0.10540925533894596*phiNodal[14]-0.21081851067789195*phiNodal[13]+0.10540925533894596*phiNodal[12]+0.10540925533894596*phiNodal[7]-0.21081851067789195*phiNodal[6]+0.10540925533894596*phiNodal[5]+0.10540925533894596*phiNodal[2]-0.21081851067789195*phiNodal[1]+0.10540925533894596*phiNodal[0]; 
  phi[8] = 0.10540925533894596*phiNodal[19]+0.10540925533894596*phiNodal[17]-0.21081851067789195*phiNodal[16]-0.21081851067789195*phiNodal[15]+0.10540925533894596*phiNodal[14]+0.10540925533894596*phiNodal[12]+0.10540925533894596*phiNodal[7]+0.10540925533894596*phiNodal[5]-0.21081851067789195*phiNodal[4]-0.21081851067789195*phiNodal[3]+0.10540925533894596*phiNodal[2]+0.10540925533894596*phiNodal[0]; 
  phi[9] = 0.10540925533894596*phiNodal[19]+0.10540925533894596*phiNodal[17]+0.10540925533894596*phiNodal[14]+0.10540925533894596*phiNodal[12]-0.21081851067789195*phiNodal[11]-0.21081851067789195*phiNodal[10]-0.21081851067789195*phiNodal[9]-0.21081851067789195*phiNodal[8]+0.10540925533894596*phiNodal[7]+0.10540925533894596*phiNodal[5]+0.10540925533894596*phiNodal[2]+0.10540925533894596*phiNodal[0]; 
  phi[10] = 0.06804138174397717*phiNodal[19]-0.06804138174397717*phiNodal[17]-0.06804138174397717*phiNodal[14]+0.06804138174397717*phiNodal[12]-0.06804138174397717*phiNodal[7]+0.06804138174397717*phiNodal[5]+0.06804138174397717*phiNodal[2]-0.06804138174397717*phiNodal[0]; 
  phi[11] = 0.06085806194501844*phiNodal[19]-0.1217161238900369*phiNodal[18]+0.06085806194501844*phiNodal[17]-0.06085806194501844*phiNodal[14]+0.1217161238900369*phiNodal[13]-0.06085806194501844*phiNodal[12]+0.06085806194501844*phiNodal[7]-0.1217161238900369*phiNodal[6]+0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]+0.1217161238900369*phiNodal[1]-0.06085806194501844*phiNodal[0]; 
  phi[12] = 0.06085806194501844*phiNodal[19]-0.06085806194501844*phiNodal[17]-0.1217161238900369*phiNodal[16]+0.1217161238900369*phiNodal[15]+0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]+0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]-0.1217161238900369*phiNodal[4]+0.1217161238900369*phiNodal[3]+0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[13] = 0.06085806194501844*phiNodal[19]-0.1217161238900369*phiNodal[18]+0.06085806194501844*phiNodal[17]+0.06085806194501844*phiNodal[14]-0.1217161238900369*phiNodal[13]+0.06085806194501844*phiNodal[12]-0.06085806194501844*phiNodal[7]+0.1217161238900369*phiNodal[6]-0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]+0.1217161238900369*phiNodal[1]-0.06085806194501844*phiNodal[0]; 
  phi[14] = 0.06085806194501844*phiNodal[19]+0.06085806194501844*phiNodal[17]-0.1217161238900369*phiNodal[16]-0.1217161238900369*phiNodal[15]+0.06085806194501844*phiNodal[14]+0.06085806194501844*phiNodal[12]-0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]+0.1217161238900369*phiNodal[4]+0.1217161238900369*phiNodal[3]-0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[15] = 0.06085806194501844*phiNodal[19]-0.06085806194501844*phiNodal[17]+0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]-0.1217161238900369*phiNodal[11]+0.1217161238900369*phiNodal[10]-0.1217161238900369*phiNodal[9]+0.1217161238900369*phiNodal[8]+0.06085806194501844*phiNodal[7]-0.06085806194501844*phiNodal[5]+0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[16] = 0.06085806194501844*phiNodal[19]+0.06085806194501844*phiNodal[17]-0.06085806194501844*phiNodal[14]-0.06085806194501844*phiNodal[12]-0.1217161238900369*phiNodal[11]-0.1217161238900369*phiNodal[10]+0.1217161238900369*phiNodal[9]+0.1217161238900369*phiNodal[8]+0.06085806194501844*phiNodal[7]+0.06085806194501844*phiNodal[5]-0.06085806194501844*phiNodal[2]-0.06085806194501844*phiNodal[0]; 
  phi[17] = 0.03513641844631532*phiNodal[19]-0.07027283689263064*phiNodal[18]+0.03513641844631532*phiNodal[17]-0.03513641844631532*phiNodal[14]+0.07027283689263064*phiNodal[13]-0.03513641844631532*phiNodal[12]-0.03513641844631532*phiNodal[7]+0.07027283689263064*phiNodal[6]-0.03513641844631532*phiNodal[5]+0.03513641844631532*phiNodal[2]-0.07027283689263064*phiNodal[1]+0.03513641844631532*phiNodal[0]; 
  phi[18] = 0.03513641844631532*phiNodal[19]-0.03513641844631532*phiNodal[17]-0.07027283689263064*phiNodal[16]+0.07027283689263064*phiNodal[15]+0.03513641844631532*phiNodal[14]-0.03513641844631532*phiNodal[12]-0.03513641844631532*phiNodal[7]+0.03513641844631532*phiNodal[5]+0.07027283689263064*phiNodal[4]-0.07027283689263064*phiNodal[3]-0.03513641844631532*phiNodal[2]+0.03513641844631532*phiNodal[0]; 
  phi[19] = 0.03513641844631532*phiNodal[19]-0.03513641844631532*phiNodal[17]-0.03513641844631532*phiNodal[14]+0.03513641844631532*phiNodal[12]-0.07027283689263064*phiNodal[11]+0.07027283689263064*phiNodal[10]+0.07027283689263064*phiNodal[9]-0.07027283689263064*phiNodal[8]+0.03513641844631532*phiNodal[7]-0.03513641844631532*phiNodal[5]-0.03513641844631532*phiNodal[2]+0.03513641844631532*phiNodal[0]; 
 
}

