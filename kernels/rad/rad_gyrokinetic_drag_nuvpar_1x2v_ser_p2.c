#include <gkyl_rad_gyrokinetic_kernels.h> 
GKYL_CU_DH void rad_gyrokinetic_drag_nuvpar_1x2v_ser_p2(const double *w, const double *dxv, 
  double charge, double mass, double a, double alpha, double beta, double gamma, double v0, 
  const double *bmag, double* GKYL_RESTRICT drag_rad_nu_surf, double* GKYL_RESTRICT drag_rad_nu) 
{ 
  // w[NDIM]: cell-center.
  // dxv[NDIM]: cell length.
  // charge: elementary charge.
  // mass: mass of electron.
  // a, alpha, beta, gamma, v0: Radiation fitting parameters.
  // bmag: magnetic field amplitude.
  // drag_rad_nu_surf: Radiation drag in direction dir at corresponding surfaces.
  //                   Note: Each cell owns their *lower* edge surface evaluation.
  // drag_rad_nu: Radiation drag direction dir volume expansion.

  const double wvpar = w[1], dvpar = dxv[1]; 
  const double wvmu = w[2], dvmu = dxv[2]; 
  const double wvpar_sq = wvpar*wvpar, dvpar_sq = dvpar*dvpar; 

  double scaled_v0 = v0/sqrt(mass/(2.0*fabs(charge)));
  double c_const = 8.0*fabs(charge)/sqrt(M_PI)*pow(2*fabs(charge)/mass,gamma/2.0); 
  double const_mult = a*(alpha+beta)/c_const;
  double vmag = 0.0;
  double vmag_surf = 0.0;

  double vpar_p[2] = {0.0};
  double vpar_sq_p[3] = {0.0};
  double mu_p[2] = {0.0};
  vpar_p[0] = 1.414213562373095*wvpar; 
  vpar_p[1] = 0.408248290463863*dvpar; 
  vpar_sq_p[0] = 1.414213562373095*wvpar_sq+0.1178511301977578*dvpar_sq; 
  vpar_sq_p[1] = 0.8164965809277262*dvpar*wvpar; 
  vpar_sq_p[2] = 0.1054092553389459*dvpar_sq; 
  mu_p[0] = 1.414213562373095*wvmu; 
  mu_p[1] = 0.408248290463863*dvmu; 

  double vnu_surf_nodal[9] = {0.0};
  double vnu_nodal[27] = {0.0};
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_surf_nodal[0] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_surf_nodal[1] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_surf_nodal[2] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_surf_nodal[3] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_surf_nodal[4] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_surf_nodal[5] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_surf_nodal[6] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_surf_nodal[7] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));
  vmag_surf = sqrt((1.581138830084189*vpar_sq_p[2]-1.224744871391589*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_surf_nodal[8] = (0.7071067811865475*vpar_p[0]-1.224744871391589*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag_surf,gamma))/(beta*pow(vmag_surf/scaled_v0,-alpha)+alpha*pow(vmag_surf/scaled_v0,beta)));

  drag_rad_nu_surf[0] = 0.1543209876543209*vnu_surf_nodal[8]+0.2469135802469135*vnu_surf_nodal[7]+0.1543209876543209*vnu_surf_nodal[6]+0.2469135802469135*vnu_surf_nodal[5]+0.3950617283950617*vnu_surf_nodal[4]+0.2469135802469135*vnu_surf_nodal[3]+0.1543209876543209*vnu_surf_nodal[2]+0.2469135802469135*vnu_surf_nodal[1]+0.1543209876543209*vnu_surf_nodal[0]; 
  drag_rad_nu_surf[1] = 0.2070433312499805*vnu_surf_nodal[8]+0.3312693299999688*vnu_surf_nodal[7]+0.2070433312499805*vnu_surf_nodal[6]-0.2070433312499805*vnu_surf_nodal[2]-0.3312693299999688*vnu_surf_nodal[1]-0.2070433312499805*vnu_surf_nodal[0]; 
  drag_rad_nu_surf[2] = 0.2070433312499805*vnu_surf_nodal[8]-0.2070433312499805*vnu_surf_nodal[6]+0.3312693299999688*vnu_surf_nodal[5]-0.3312693299999688*vnu_surf_nodal[3]+0.2070433312499805*vnu_surf_nodal[2]-0.2070433312499805*vnu_surf_nodal[0]; 
  drag_rad_nu_surf[3] = 0.2777777777777778*vnu_surf_nodal[8]-0.2777777777777778*vnu_surf_nodal[6]-0.2777777777777778*vnu_surf_nodal[2]+0.2777777777777778*vnu_surf_nodal[0]; 
  drag_rad_nu_surf[4] = 0.138028887499987*vnu_surf_nodal[8]+0.2208462199999792*vnu_surf_nodal[7]+0.138028887499987*vnu_surf_nodal[6]-0.2760577749999741*vnu_surf_nodal[5]-0.4416924399999584*vnu_surf_nodal[4]-0.2760577749999741*vnu_surf_nodal[3]+0.138028887499987*vnu_surf_nodal[2]+0.2208462199999792*vnu_surf_nodal[1]+0.138028887499987*vnu_surf_nodal[0]; 
  drag_rad_nu_surf[5] = 0.138028887499987*vnu_surf_nodal[8]-0.2760577749999741*vnu_surf_nodal[7]+0.138028887499987*vnu_surf_nodal[6]+0.2208462199999792*vnu_surf_nodal[5]-0.4416924399999584*vnu_surf_nodal[4]+0.2208462199999792*vnu_surf_nodal[3]+0.138028887499987*vnu_surf_nodal[2]-0.2760577749999741*vnu_surf_nodal[1]+0.138028887499987*vnu_surf_nodal[0]; 
  drag_rad_nu_surf[6] = 0.1851851851851852*vnu_surf_nodal[8]-0.1851851851851852*vnu_surf_nodal[6]-0.3703703703703705*vnu_surf_nodal[5]+0.3703703703703705*vnu_surf_nodal[3]+0.1851851851851852*vnu_surf_nodal[2]-0.1851851851851852*vnu_surf_nodal[0]; 
  drag_rad_nu_surf[7] = 0.1851851851851852*vnu_surf_nodal[8]-0.3703703703703705*vnu_surf_nodal[7]+0.1851851851851852*vnu_surf_nodal[6]-0.1851851851851852*vnu_surf_nodal[2]+0.3703703703703705*vnu_surf_nodal[1]-0.1851851851851852*vnu_surf_nodal[0]; 

  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[0] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[1] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[2] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[3] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*(0.7071067811865475*mu_p[0]*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[4] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[5] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[6] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[7] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.6324555320336759*bmag[2]-0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[8] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[9] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[10] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[11] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[12] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*(0.7071067811865475*mu_p[0]*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[13] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[14] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[15] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[16] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.7071067811865475*bmag[0]-0.7905694150420947*bmag[2]))/mass);
  vnu_nodal[17] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[18] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[19] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]-0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[20] = (0.7071067811865475*vpar_p[0]-0.9486832980505137*vpar_p[1])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[21] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*(0.7071067811865475*mu_p[0]*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[22] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.7071067811865475*vpar_sq_p[0]-0.7905694150420947*vpar_sq_p[2])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[23] = (0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.7071067811865475*mu_p[0]-0.9486832980505137*mu_p[1])*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[24] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*(0.7071067811865475*mu_p[0]*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[25] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));
  vmag = sqrt((0.6324555320336759*vpar_sq_p[2]+0.9486832980505137*vpar_sq_p[1]+0.7071067811865475*vpar_sq_p[0])+2.0*((0.9486832980505137*mu_p[1]+0.7071067811865475*mu_p[0])*(0.6324555320336759*bmag[2]+0.9486832980505137*bmag[1]+0.7071067811865475*bmag[0]))/mass);
  vnu_nodal[26] = (0.9486832980505137*vpar_p[1]+0.7071067811865475*vpar_p[0])*((a/c_const*(alpha+beta)*pow(vmag,gamma))/(beta*pow(vmag/scaled_v0,-alpha)+alpha*pow(vmag/scaled_v0,beta)));

  drag_rad_nu[0] = 0.06062300936098657*vnu_nodal[26]+0.09699681497757856*vnu_nodal[25]+0.06062300936098657*vnu_nodal[24]+0.09699681497757856*vnu_nodal[23]+0.1551949039641258*vnu_nodal[22]+0.09699681497757856*vnu_nodal[21]+0.06062300936098657*vnu_nodal[20]+0.09699681497757856*vnu_nodal[19]+0.06062300936098657*vnu_nodal[18]+0.09699681497757856*vnu_nodal[17]+0.1551949039641258*vnu_nodal[16]+0.09699681497757856*vnu_nodal[15]+0.1551949039641258*vnu_nodal[14]+0.2483118463426014*vnu_nodal[13]+0.1551949039641258*vnu_nodal[12]+0.09699681497757856*vnu_nodal[11]+0.1551949039641258*vnu_nodal[10]+0.09699681497757856*vnu_nodal[9]+0.06062300936098657*vnu_nodal[8]+0.09699681497757856*vnu_nodal[7]+0.06062300936098657*vnu_nodal[6]+0.09699681497757856*vnu_nodal[5]+0.1551949039641258*vnu_nodal[4]+0.09699681497757856*vnu_nodal[3]+0.06062300936098657*vnu_nodal[2]+0.09699681497757856*vnu_nodal[1]+0.06062300936098657*vnu_nodal[0]; 
  drag_rad_nu[1] = 0.08133430195906329*vnu_nodal[26]+0.1301348831345012*vnu_nodal[25]+0.08133430195906329*vnu_nodal[24]+0.1301348831345012*vnu_nodal[23]+0.2082158130152021*vnu_nodal[22]+0.1301348831345012*vnu_nodal[21]+0.08133430195906329*vnu_nodal[20]+0.1301348831345012*vnu_nodal[19]+0.08133430195906329*vnu_nodal[18]-0.08133430195906329*vnu_nodal[8]-0.1301348831345012*vnu_nodal[7]-0.08133430195906329*vnu_nodal[6]-0.1301348831345012*vnu_nodal[5]-0.2082158130152021*vnu_nodal[4]-0.1301348831345012*vnu_nodal[3]-0.08133430195906329*vnu_nodal[2]-0.1301348831345012*vnu_nodal[1]-0.08133430195906329*vnu_nodal[0]; 
  drag_rad_nu[2] = 0.08133430195906329*vnu_nodal[26]+0.1301348831345012*vnu_nodal[25]+0.08133430195906329*vnu_nodal[24]-0.08133430195906329*vnu_nodal[20]-0.1301348831345012*vnu_nodal[19]-0.08133430195906329*vnu_nodal[18]+0.1301348831345012*vnu_nodal[17]+0.2082158130152021*vnu_nodal[16]+0.1301348831345012*vnu_nodal[15]-0.1301348831345012*vnu_nodal[11]-0.2082158130152021*vnu_nodal[10]-0.1301348831345012*vnu_nodal[9]+0.08133430195906329*vnu_nodal[8]+0.1301348831345012*vnu_nodal[7]+0.08133430195906329*vnu_nodal[6]-0.08133430195906329*vnu_nodal[2]-0.1301348831345012*vnu_nodal[1]-0.08133430195906329*vnu_nodal[0]; 
  drag_rad_nu[3] = 0.08133430195906329*vnu_nodal[26]-0.08133430195906329*vnu_nodal[24]+0.1301348831345012*vnu_nodal[23]-0.1301348831345012*vnu_nodal[21]+0.08133430195906329*vnu_nodal[20]-0.08133430195906329*vnu_nodal[18]+0.1301348831345012*vnu_nodal[17]-0.1301348831345012*vnu_nodal[15]+0.2082158130152021*vnu_nodal[14]-0.2082158130152021*vnu_nodal[12]+0.1301348831345012*vnu_nodal[11]-0.1301348831345012*vnu_nodal[9]+0.08133430195906329*vnu_nodal[8]-0.08133430195906329*vnu_nodal[6]+0.1301348831345012*vnu_nodal[5]-0.1301348831345012*vnu_nodal[3]+0.08133430195906329*vnu_nodal[2]-0.08133430195906329*vnu_nodal[0]; 
  drag_rad_nu[4] = 0.1091214168497758*vnu_nodal[26]+0.1745942669596414*vnu_nodal[25]+0.1091214168497758*vnu_nodal[24]-0.1091214168497758*vnu_nodal[20]-0.1745942669596414*vnu_nodal[19]-0.1091214168497758*vnu_nodal[18]-0.1091214168497758*vnu_nodal[8]-0.1745942669596414*vnu_nodal[7]-0.1091214168497758*vnu_nodal[6]+0.1091214168497758*vnu_nodal[2]+0.1745942669596414*vnu_nodal[1]+0.1091214168497758*vnu_nodal[0]; 
  drag_rad_nu[5] = 0.1091214168497758*vnu_nodal[26]-0.1091214168497758*vnu_nodal[24]+0.1745942669596414*vnu_nodal[23]-0.1745942669596414*vnu_nodal[21]+0.1091214168497758*vnu_nodal[20]-0.1091214168497758*vnu_nodal[18]-0.1091214168497758*vnu_nodal[8]+0.1091214168497758*vnu_nodal[6]-0.1745942669596414*vnu_nodal[5]+0.1745942669596414*vnu_nodal[3]-0.1091214168497758*vnu_nodal[2]+0.1091214168497758*vnu_nodal[0]; 
  drag_rad_nu[6] = 0.1091214168497758*vnu_nodal[26]-0.1091214168497758*vnu_nodal[24]-0.1091214168497758*vnu_nodal[20]+0.1091214168497758*vnu_nodal[18]+0.1745942669596414*vnu_nodal[17]-0.1745942669596414*vnu_nodal[15]-0.1745942669596414*vnu_nodal[11]+0.1745942669596414*vnu_nodal[9]+0.1091214168497758*vnu_nodal[8]-0.1091214168497758*vnu_nodal[6]-0.1091214168497758*vnu_nodal[2]+0.1091214168497758*vnu_nodal[0]; 
  drag_rad_nu[7] = 0.05422286797270885*vnu_nodal[26]+0.0867565887563342*vnu_nodal[25]+0.05422286797270885*vnu_nodal[24]+0.0867565887563342*vnu_nodal[23]+0.1388105420101347*vnu_nodal[22]+0.0867565887563342*vnu_nodal[21]+0.05422286797270885*vnu_nodal[20]+0.0867565887563342*vnu_nodal[19]+0.05422286797270885*vnu_nodal[18]-0.1084457359454177*vnu_nodal[17]-0.1735131775126684*vnu_nodal[16]-0.1084457359454177*vnu_nodal[15]-0.1735131775126684*vnu_nodal[14]-0.2776210840202696*vnu_nodal[13]-0.1735131775126684*vnu_nodal[12]-0.1084457359454177*vnu_nodal[11]-0.1735131775126684*vnu_nodal[10]-0.1084457359454177*vnu_nodal[9]+0.05422286797270885*vnu_nodal[8]+0.0867565887563342*vnu_nodal[7]+0.05422286797270885*vnu_nodal[6]+0.0867565887563342*vnu_nodal[5]+0.1388105420101347*vnu_nodal[4]+0.0867565887563342*vnu_nodal[3]+0.05422286797270885*vnu_nodal[2]+0.0867565887563342*vnu_nodal[1]+0.05422286797270885*vnu_nodal[0]; 
  drag_rad_nu[8] = 0.05422286797270885*vnu_nodal[26]+0.0867565887563342*vnu_nodal[25]+0.05422286797270885*vnu_nodal[24]-0.1084457359454177*vnu_nodal[23]-0.1735131775126684*vnu_nodal[22]-0.1084457359454177*vnu_nodal[21]+0.05422286797270885*vnu_nodal[20]+0.0867565887563342*vnu_nodal[19]+0.05422286797270885*vnu_nodal[18]+0.0867565887563342*vnu_nodal[17]+0.1388105420101347*vnu_nodal[16]+0.0867565887563342*vnu_nodal[15]-0.1735131775126684*vnu_nodal[14]-0.2776210840202696*vnu_nodal[13]-0.1735131775126684*vnu_nodal[12]+0.0867565887563342*vnu_nodal[11]+0.1388105420101347*vnu_nodal[10]+0.0867565887563342*vnu_nodal[9]+0.05422286797270885*vnu_nodal[8]+0.0867565887563342*vnu_nodal[7]+0.05422286797270885*vnu_nodal[6]-0.1084457359454177*vnu_nodal[5]-0.1735131775126684*vnu_nodal[4]-0.1084457359454177*vnu_nodal[3]+0.05422286797270885*vnu_nodal[2]+0.0867565887563342*vnu_nodal[1]+0.05422286797270885*vnu_nodal[0]; 
  drag_rad_nu[9] = 0.05422286797270885*vnu_nodal[26]-0.1084457359454177*vnu_nodal[25]+0.05422286797270885*vnu_nodal[24]+0.0867565887563342*vnu_nodal[23]-0.1735131775126684*vnu_nodal[22]+0.0867565887563342*vnu_nodal[21]+0.05422286797270885*vnu_nodal[20]-0.1084457359454177*vnu_nodal[19]+0.05422286797270885*vnu_nodal[18]+0.0867565887563342*vnu_nodal[17]-0.1735131775126684*vnu_nodal[16]+0.0867565887563342*vnu_nodal[15]+0.1388105420101347*vnu_nodal[14]-0.2776210840202696*vnu_nodal[13]+0.1388105420101347*vnu_nodal[12]+0.0867565887563342*vnu_nodal[11]-0.1735131775126684*vnu_nodal[10]+0.0867565887563342*vnu_nodal[9]+0.05422286797270885*vnu_nodal[8]-0.1084457359454177*vnu_nodal[7]+0.05422286797270885*vnu_nodal[6]+0.0867565887563342*vnu_nodal[5]-0.1735131775126684*vnu_nodal[4]+0.0867565887563342*vnu_nodal[3]+0.05422286797270885*vnu_nodal[2]-0.1084457359454177*vnu_nodal[1]+0.05422286797270885*vnu_nodal[0]; 
  drag_rad_nu[10] = 0.1464017435263138*vnu_nodal[26]-0.1464017435263138*vnu_nodal[24]-0.1464017435263138*vnu_nodal[20]+0.1464017435263138*vnu_nodal[18]-0.1464017435263138*vnu_nodal[8]+0.1464017435263138*vnu_nodal[6]+0.1464017435263138*vnu_nodal[2]-0.1464017435263138*vnu_nodal[0]; 
  drag_rad_nu[11] = 0.07274761123318395*vnu_nodal[26]+0.1163961779730943*vnu_nodal[25]+0.07274761123318395*vnu_nodal[24]-0.07274761123318395*vnu_nodal[20]-0.1163961779730943*vnu_nodal[19]-0.07274761123318395*vnu_nodal[18]-0.1454952224663679*vnu_nodal[17]-0.2327923559461887*vnu_nodal[16]-0.1454952224663679*vnu_nodal[15]+0.1454952224663679*vnu_nodal[11]+0.2327923559461887*vnu_nodal[10]+0.1454952224663679*vnu_nodal[9]+0.07274761123318395*vnu_nodal[8]+0.1163961779730943*vnu_nodal[7]+0.07274761123318395*vnu_nodal[6]-0.07274761123318395*vnu_nodal[2]-0.1163961779730943*vnu_nodal[1]-0.07274761123318395*vnu_nodal[0]; 
  drag_rad_nu[12] = 0.07274761123318395*vnu_nodal[26]+0.1163961779730943*vnu_nodal[25]+0.07274761123318395*vnu_nodal[24]-0.1454952224663679*vnu_nodal[23]-0.2327923559461887*vnu_nodal[22]-0.1454952224663679*vnu_nodal[21]+0.07274761123318395*vnu_nodal[20]+0.1163961779730943*vnu_nodal[19]+0.07274761123318395*vnu_nodal[18]-0.07274761123318395*vnu_nodal[8]-0.1163961779730943*vnu_nodal[7]-0.07274761123318395*vnu_nodal[6]+0.1454952224663679*vnu_nodal[5]+0.2327923559461887*vnu_nodal[4]+0.1454952224663679*vnu_nodal[3]-0.07274761123318395*vnu_nodal[2]-0.1163961779730943*vnu_nodal[1]-0.07274761123318395*vnu_nodal[0]; 
  drag_rad_nu[13] = 0.07274761123318395*vnu_nodal[26]-0.07274761123318395*vnu_nodal[24]+0.1163961779730943*vnu_nodal[23]-0.1163961779730943*vnu_nodal[21]+0.07274761123318395*vnu_nodal[20]-0.07274761123318395*vnu_nodal[18]-0.1454952224663679*vnu_nodal[17]+0.1454952224663679*vnu_nodal[15]-0.2327923559461887*vnu_nodal[14]+0.2327923559461887*vnu_nodal[12]-0.1454952224663679*vnu_nodal[11]+0.1454952224663679*vnu_nodal[9]+0.07274761123318395*vnu_nodal[8]-0.07274761123318395*vnu_nodal[6]+0.1163961779730943*vnu_nodal[5]-0.1163961779730943*vnu_nodal[3]+0.07274761123318395*vnu_nodal[2]-0.07274761123318395*vnu_nodal[0]; 
  drag_rad_nu[14] = 0.07274761123318395*vnu_nodal[26]-0.07274761123318395*vnu_nodal[24]-0.1454952224663679*vnu_nodal[23]+0.1454952224663679*vnu_nodal[21]+0.07274761123318395*vnu_nodal[20]-0.07274761123318395*vnu_nodal[18]+0.1163961779730943*vnu_nodal[17]-0.1163961779730943*vnu_nodal[15]-0.2327923559461887*vnu_nodal[14]+0.2327923559461887*vnu_nodal[12]+0.1163961779730943*vnu_nodal[11]-0.1163961779730943*vnu_nodal[9]+0.07274761123318395*vnu_nodal[8]-0.07274761123318395*vnu_nodal[6]-0.1454952224663679*vnu_nodal[5]+0.1454952224663679*vnu_nodal[3]+0.07274761123318395*vnu_nodal[2]-0.07274761123318395*vnu_nodal[0]; 
  drag_rad_nu[15] = 0.07274761123318395*vnu_nodal[26]-0.1454952224663679*vnu_nodal[25]+0.07274761123318395*vnu_nodal[24]+0.1163961779730943*vnu_nodal[23]-0.2327923559461887*vnu_nodal[22]+0.1163961779730943*vnu_nodal[21]+0.07274761123318395*vnu_nodal[20]-0.1454952224663679*vnu_nodal[19]+0.07274761123318395*vnu_nodal[18]-0.07274761123318395*vnu_nodal[8]+0.1454952224663679*vnu_nodal[7]-0.07274761123318395*vnu_nodal[6]-0.1163961779730943*vnu_nodal[5]+0.2327923559461887*vnu_nodal[4]-0.1163961779730943*vnu_nodal[3]-0.07274761123318395*vnu_nodal[2]+0.1454952224663679*vnu_nodal[1]-0.07274761123318395*vnu_nodal[0]; 
  drag_rad_nu[16] = 0.07274761123318395*vnu_nodal[26]-0.1454952224663679*vnu_nodal[25]+0.07274761123318395*vnu_nodal[24]-0.07274761123318395*vnu_nodal[20]+0.1454952224663679*vnu_nodal[19]-0.07274761123318395*vnu_nodal[18]+0.1163961779730943*vnu_nodal[17]-0.2327923559461887*vnu_nodal[16]+0.1163961779730943*vnu_nodal[15]-0.1163961779730943*vnu_nodal[11]+0.2327923559461887*vnu_nodal[10]-0.1163961779730943*vnu_nodal[9]+0.07274761123318395*vnu_nodal[8]-0.1454952224663679*vnu_nodal[7]+0.07274761123318395*vnu_nodal[6]-0.07274761123318395*vnu_nodal[2]+0.1454952224663679*vnu_nodal[1]-0.07274761123318395*vnu_nodal[0]; 
  drag_rad_nu[17] = 0.09760116235087592*vnu_nodal[26]-0.09760116235087592*vnu_nodal[24]-0.09760116235087592*vnu_nodal[20]+0.09760116235087592*vnu_nodal[18]-0.1952023247017518*vnu_nodal[17]+0.1952023247017518*vnu_nodal[15]+0.1952023247017518*vnu_nodal[11]-0.1952023247017518*vnu_nodal[9]+0.09760116235087592*vnu_nodal[8]-0.09760116235087592*vnu_nodal[6]-0.09760116235087592*vnu_nodal[2]+0.09760116235087592*vnu_nodal[0]; 
  drag_rad_nu[18] = 0.09760116235087592*vnu_nodal[26]-0.09760116235087592*vnu_nodal[24]-0.1952023247017518*vnu_nodal[23]+0.1952023247017518*vnu_nodal[21]+0.09760116235087592*vnu_nodal[20]-0.09760116235087592*vnu_nodal[18]-0.09760116235087592*vnu_nodal[8]+0.09760116235087592*vnu_nodal[6]+0.1952023247017518*vnu_nodal[5]-0.1952023247017518*vnu_nodal[3]-0.09760116235087592*vnu_nodal[2]+0.09760116235087592*vnu_nodal[0]; 
  drag_rad_nu[19] = 0.09760116235087592*vnu_nodal[26]-0.1952023247017518*vnu_nodal[25]+0.09760116235087592*vnu_nodal[24]-0.09760116235087592*vnu_nodal[20]+0.1952023247017518*vnu_nodal[19]-0.09760116235087592*vnu_nodal[18]-0.09760116235087592*vnu_nodal[8]+0.1952023247017518*vnu_nodal[7]-0.09760116235087592*vnu_nodal[6]+0.09760116235087592*vnu_nodal[2]-0.1952023247017518*vnu_nodal[1]+0.09760116235087592*vnu_nodal[0]; 

} 
