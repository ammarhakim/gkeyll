#include <gkyl_rad_gyrokinetic_kernels.h> 
GKYL_CU_DH double rad_gyrokinetic_boundary_surfvpar_1x2v_ser_p2(const double *w, const double *dxv, 
  const double *nvnu_edge, const double *nvnu_skin, const double *nvsqnu_edge, const double *nvsqnu_skin, 
  const int edge, const double *fedge, const double *fskin, double* GKYL_RESTRICT out) 
{ 
  // w[3]:     cell-center coordinates. 
  // dxv[3]:   cell spacing. 
  // nvnu_edge: Surface expansion sum_s n_s*nu_s(v) in vparallel direction on the lower edges of the edge cell.
  // nvnu_skin: Surface expansion sum_s n_s*nu_s(v) in vparallel direction on the lower edges of the skin cell.
  // nvsqnu_edge: Surface expansion sum_s n_s*nu_s(v) in mu direction on the lower edges of the edge cell.
  // nvsqnu_skin: Surface expansion sum_s n_s*nu_s(v) in mu direction on the lower edges of the edge skin.
  // edge: determines if the update is for the left edge (-1) or right edge (+1).
  // fskin,fedge: distribution function in skin cell/last edge cell.
  // out: output increment in center cell.

  double rdv2 = 2.0/dxv[1]; 

  if (edge == -1) { 

  double Ghat_r[8] = {0.0}; 
  if (w[1]>0) {

  Ghat_r[0] = (-0.6123724356957944*nvnu_edge[7]*fedge[19])+0.7905694150420947*nvnu_edge[3]*fedge[18]-0.6123724356957944*(nvnu_edge[6]*fedge[17]+nvnu_edge[5]*fedge[16])+0.3535533905932737*nvnu_edge[7]*fedge[15]+0.7905694150420948*nvnu_edge[2]*fedge[14]+0.3535533905932737*nvnu_edge[6]*fedge[13]+0.7905694150420948*nvnu_edge[1]*fedge[12]-0.6123724356957944*(nvnu_edge[4]*fedge[11]+nvnu_edge[3]*fedge[10])+0.3535533905932737*nvnu_edge[5]*fedge[9]+0.7905694150420947*nvnu_edge[0]*fedge[8]+0.3535533905932737*nvnu_edge[4]*fedge[7]-0.6123724356957944*nvnu_edge[2]*fedge[6]+0.3535533905932737*nvnu_edge[3]*fedge[5]-0.6123724356957944*nvnu_edge[1]*fedge[4]+0.3535533905932737*nvnu_edge[2]*fedge[3]-0.6123724356957944*nvnu_edge[0]*fedge[2]+0.3535533905932737*(fedge[1]*nvnu_edge[1]+fedge[0]*nvnu_edge[0]); 
  Ghat_r[1] = (-0.6123724356957944*nvnu_edge[5]*fedge[19])+(0.7071067811865475*nvnu_edge[6]+0.7905694150420947*nvnu_edge[2])*fedge[18]-0.5477225575051661*nvnu_edge[3]*fedge[17]-0.6123724356957944*nvnu_edge[7]*fedge[16]+0.3535533905932737*nvnu_edge[5]*fedge[15]+nvnu_edge[3]*(0.7905694150420948*fedge[14]+0.3162277660168379*fedge[13])+(0.7071067811865475*nvnu_edge[4]+0.7905694150420948*nvnu_edge[0])*fedge[12]-0.5477225575051661*nvnu_edge[1]*fedge[11]+((-0.5477225575051661*nvnu_edge[6])-0.6123724356957944*nvnu_edge[2])*fedge[10]+0.3535533905932737*nvnu_edge[7]*fedge[9]+nvnu_edge[1]*(0.7905694150420947*fedge[8]+0.3162277660168379*fedge[7])+0.3162277660168379*fedge[5]*nvnu_edge[6]-0.6123724356957944*nvnu_edge[3]*fedge[6]+0.3535533905932737*nvnu_edge[2]*fedge[5]+(0.3162277660168379*fedge[1]-0.5477225575051661*fedge[4])*nvnu_edge[4]-0.6123724356957944*nvnu_edge[0]*fedge[4]+0.3535533905932737*fedge[3]*nvnu_edge[3]-0.6123724356957944*nvnu_edge[1]*fedge[2]+0.3535533905932737*(fedge[0]*nvnu_edge[1]+nvnu_edge[0]*fedge[1]); 
  Ghat_r[2] = (-0.5477225575051661*nvnu_edge[3]*fedge[19])+(0.7071067811865475*nvnu_edge[7]+0.7905694150420947*nvnu_edge[1])*fedge[18]-0.6123724356957944*nvnu_edge[4]*fedge[17]-0.5477225575051661*nvnu_edge[2]*fedge[16]+0.3162277660168379*nvnu_edge[3]*fedge[15]+(0.7071067811865475*nvnu_edge[5]+0.7905694150420948*nvnu_edge[0])*fedge[14]+0.3535533905932737*nvnu_edge[4]*fedge[13]+0.7905694150420948*nvnu_edge[3]*fedge[12]-0.6123724356957944*nvnu_edge[6]*fedge[11]+((-0.5477225575051661*nvnu_edge[7])-0.6123724356957944*nvnu_edge[1])*fedge[10]+nvnu_edge[2]*(0.3162277660168379*fedge[9]+0.7905694150420947*fedge[8])+0.3162277660168379*fedge[5]*nvnu_edge[7]+0.3535533905932737*nvnu_edge[6]*fedge[7]+((-0.5477225575051661*nvnu_edge[5])-0.6123724356957944*nvnu_edge[0])*fedge[6]+0.3162277660168379*fedge[3]*nvnu_edge[5]+0.3535533905932737*nvnu_edge[1]*fedge[5]-0.6123724356957944*nvnu_edge[3]*fedge[4]+0.3535533905932737*(fedge[1]*nvnu_edge[3]+nvnu_edge[0]*fedge[3])+(0.3535533905932737*fedge[0]-0.6123724356957944*fedge[2])*nvnu_edge[2]; 
  Ghat_r[3] = ((-0.4898979485566356*nvnu_edge[6])-0.5477225575051661*nvnu_edge[2])*fedge[19]+(0.7071067811865475*(nvnu_edge[5]+nvnu_edge[4])+0.7905694150420947*nvnu_edge[0])*fedge[18]-0.4898979485566356*nvnu_edge[7]*fedge[17]-0.5477225575051661*(nvnu_edge[1]*fedge[17]+nvnu_edge[3]*fedge[16])+(0.2828427124746191*nvnu_edge[6]+0.3162277660168379*nvnu_edge[2])*fedge[15]+(0.7071067811865475*nvnu_edge[7]+0.7905694150420948*nvnu_edge[1])*fedge[14]+(0.2828427124746191*nvnu_edge[7]+0.3162277660168379*nvnu_edge[1])*fedge[13]+(0.7071067811865475*nvnu_edge[6]+0.7905694150420948*nvnu_edge[2])*fedge[12]-0.5477225575051661*nvnu_edge[3]*fedge[11]+((-0.5477225575051661*(nvnu_edge[5]+nvnu_edge[4]))-0.6123724356957944*nvnu_edge[0])*fedge[10]+nvnu_edge[3]*(0.3162277660168379*fedge[9]+0.7905694150420947*fedge[8])+(0.3162277660168379*fedge[3]-0.5477225575051661*fedge[6])*nvnu_edge[7]+0.3162277660168379*nvnu_edge[3]*fedge[7]+(0.3162277660168379*fedge[1]-0.5477225575051661*fedge[4])*nvnu_edge[6]-0.6123724356957944*nvnu_edge[1]*fedge[6]+fedge[5]*(0.3162277660168379*(nvnu_edge[5]+nvnu_edge[4])+0.3535533905932737*nvnu_edge[0])-0.6123724356957944*(nvnu_edge[2]*fedge[4]+fedge[2]*nvnu_edge[3])+0.3535533905932737*(fedge[0]*nvnu_edge[3]+nvnu_edge[1]*fedge[3]+fedge[1]*nvnu_edge[2]); 
  Ghat_r[4] = (-0.5477225575051661*nvnu_edge[7]*fedge[19])+0.7071067811865475*nvnu_edge[3]*fedge[18]+((-0.3912303982179757*nvnu_edge[6])-0.6123724356957944*nvnu_edge[2])*fedge[17]+0.3162277660168379*nvnu_edge[7]*fedge[15]+0.7905694150420947*nvnu_edge[6]*fedge[14]+(0.2258769757263128*nvnu_edge[6]+0.3535533905932737*nvnu_edge[2])*fedge[13]+0.7071067811865475*nvnu_edge[1]*fedge[12]+((-0.3912303982179757*nvnu_edge[4])-0.6123724356957944*nvnu_edge[0])*fedge[11]-0.5477225575051661*nvnu_edge[3]*fedge[10]+0.7905694150420947*nvnu_edge[4]*fedge[8]+(0.2258769757263128*nvnu_edge[4]+0.3535533905932737*nvnu_edge[0])*fedge[7]+(0.3535533905932737*fedge[3]-0.6123724356957944*fedge[6])*nvnu_edge[6]+0.3162277660168379*nvnu_edge[3]*fedge[5]+(0.3535533905932737*fedge[0]-0.6123724356957944*fedge[2])*nvnu_edge[4]+nvnu_edge[1]*(0.3162277660168379*fedge[1]-0.5477225575051661*fedge[4]); 
  Ghat_r[5] = ((-0.3912303982179757*nvnu_edge[7])-0.6123724356957944*nvnu_edge[1])*fedge[19]+0.7071067811865475*nvnu_edge[3]*fedge[18]-0.5477225575051661*nvnu_edge[6]*fedge[17]+((-0.3912303982179757*nvnu_edge[5])-0.6123724356957944*nvnu_edge[0])*fedge[16]+(0.2258769757263128*nvnu_edge[7]+0.3535533905932737*nvnu_edge[1])*fedge[15]+0.7071067811865475*nvnu_edge[2]*fedge[14]+0.3162277660168379*nvnu_edge[6]*fedge[13]+0.7905694150420947*nvnu_edge[7]*fedge[12]-0.5477225575051661*nvnu_edge[3]*fedge[10]+(0.2258769757263128*nvnu_edge[5]+0.3535533905932737*nvnu_edge[0])*fedge[9]+0.7905694150420947*nvnu_edge[5]*fedge[8]+(0.3535533905932737*fedge[1]-0.6123724356957944*fedge[4])*nvnu_edge[7]-0.5477225575051661*nvnu_edge[2]*fedge[6]+(0.3535533905932737*fedge[0]-0.6123724356957944*fedge[2])*nvnu_edge[5]+0.3162277660168379*(nvnu_edge[3]*fedge[5]+nvnu_edge[2]*fedge[3]); 
  Ghat_r[6] = (-0.4898979485566356*nvnu_edge[3]*fedge[19])+(0.6324555320336759*nvnu_edge[7]+0.7071067811865475*nvnu_edge[1])*fedge[18]+((-0.5477225575051661*nvnu_edge[5])-0.3912303982179757*nvnu_edge[4]-0.6123724356957944*nvnu_edge[0])*fedge[17]-0.5477225575051661*nvnu_edge[6]*fedge[16]+0.2828427124746191*nvnu_edge[3]*fedge[15]+0.7905694150420947*nvnu_edge[4]*fedge[14]+(0.3162277660168379*nvnu_edge[5]+0.2258769757263128*nvnu_edge[4]+0.3535533905932737*nvnu_edge[0])*fedge[13]+0.7071067811865475*nvnu_edge[3]*fedge[12]+((-0.3912303982179757*nvnu_edge[6])-0.6123724356957944*nvnu_edge[2])*fedge[11]+((-0.4898979485566357*nvnu_edge[7])-0.5477225575051661*nvnu_edge[1])*fedge[10]+nvnu_edge[6]*(0.3162277660168379*fedge[9]+0.7905694150420947*fedge[8])+0.2828427124746191*fedge[5]*nvnu_edge[7]+(0.2258769757263128*nvnu_edge[6]+0.3535533905932737*nvnu_edge[2])*fedge[7]+(0.3535533905932737*fedge[0]-0.6123724356957944*fedge[2])*nvnu_edge[6]-0.6123724356957944*nvnu_edge[4]*fedge[6]+0.3162277660168379*nvnu_edge[1]*fedge[5]+0.3535533905932737*fedge[3]*nvnu_edge[4]+nvnu_edge[3]*(0.3162277660168379*fedge[1]-0.5477225575051661*fedge[4]); 
  Ghat_r[7] = ((-0.3912303982179757*nvnu_edge[5])-0.5477225575051661*nvnu_edge[4]-0.6123724356957944*nvnu_edge[0])*fedge[19]+(0.6324555320336759*nvnu_edge[6]+0.7071067811865475*nvnu_edge[2])*fedge[18]-0.4898979485566356*nvnu_edge[3]*fedge[17]+((-0.3912303982179757*nvnu_edge[7])-0.6123724356957944*nvnu_edge[1])*fedge[16]+(0.2258769757263128*nvnu_edge[5]+0.3162277660168379*nvnu_edge[4]+0.3535533905932737*nvnu_edge[0])*fedge[15]+nvnu_edge[3]*(0.7071067811865475*fedge[14]+0.2828427124746191*fedge[13])+0.7905694150420947*nvnu_edge[5]*fedge[12]-0.5477225575051661*nvnu_edge[7]*fedge[11]+((-0.4898979485566357*nvnu_edge[6])-0.5477225575051661*nvnu_edge[2])*fedge[10]+(0.2258769757263128*nvnu_edge[7]+0.3535533905932737*nvnu_edge[1])*fedge[9]+nvnu_edge[7]*(0.7905694150420947*fedge[8]+0.3162277660168379*fedge[7]-0.6123724356957944*fedge[2]+0.3535533905932737*fedge[0])+0.2828427124746191*fedge[5]*nvnu_edge[6]-0.5477225575051661*nvnu_edge[3]*fedge[6]+(0.3535533905932737*fedge[1]-0.6123724356957944*fedge[4])*nvnu_edge[5]+0.3162277660168379*(nvnu_edge[2]*fedge[5]+fedge[3]*nvnu_edge[3]); 

  } else { 

  Ghat_r[0] = 0.6123724356957944*nvnu_edge[7]*fskin[19]+0.7905694150420947*nvnu_edge[3]*fskin[18]+0.6123724356957944*(nvnu_edge[6]*fskin[17]+nvnu_edge[5]*fskin[16])+0.3535533905932737*nvnu_edge[7]*fskin[15]+0.7905694150420948*nvnu_edge[2]*fskin[14]+0.3535533905932737*nvnu_edge[6]*fskin[13]+0.7905694150420948*nvnu_edge[1]*fskin[12]+0.6123724356957944*(nvnu_edge[4]*fskin[11]+nvnu_edge[3]*fskin[10])+0.3535533905932737*nvnu_edge[5]*fskin[9]+0.7905694150420947*nvnu_edge[0]*fskin[8]+0.3535533905932737*nvnu_edge[4]*fskin[7]+0.6123724356957944*nvnu_edge[2]*fskin[6]+0.3535533905932737*nvnu_edge[3]*fskin[5]+0.6123724356957944*nvnu_edge[1]*fskin[4]+0.3535533905932737*nvnu_edge[2]*fskin[3]+0.6123724356957944*nvnu_edge[0]*fskin[2]+0.3535533905932737*(fskin[1]*nvnu_edge[1]+fskin[0]*nvnu_edge[0]); 
  Ghat_r[1] = 0.6123724356957944*nvnu_edge[5]*fskin[19]+(0.7071067811865475*nvnu_edge[6]+0.7905694150420947*nvnu_edge[2])*fskin[18]+0.5477225575051661*nvnu_edge[3]*fskin[17]+0.6123724356957944*nvnu_edge[7]*fskin[16]+0.3535533905932737*nvnu_edge[5]*fskin[15]+nvnu_edge[3]*(0.7905694150420948*fskin[14]+0.3162277660168379*fskin[13])+(0.7071067811865475*nvnu_edge[4]+0.7905694150420948*nvnu_edge[0])*fskin[12]+0.5477225575051661*nvnu_edge[1]*fskin[11]+(0.5477225575051661*nvnu_edge[6]+0.6123724356957944*nvnu_edge[2])*fskin[10]+0.3535533905932737*nvnu_edge[7]*fskin[9]+nvnu_edge[1]*(0.7905694150420947*fskin[8]+0.3162277660168379*fskin[7])+0.3162277660168379*fskin[5]*nvnu_edge[6]+0.6123724356957944*nvnu_edge[3]*fskin[6]+0.3535533905932737*nvnu_edge[2]*fskin[5]+(0.5477225575051661*fskin[4]+0.3162277660168379*fskin[1])*nvnu_edge[4]+0.6123724356957944*nvnu_edge[0]*fskin[4]+0.3535533905932737*fskin[3]*nvnu_edge[3]+0.6123724356957944*nvnu_edge[1]*fskin[2]+0.3535533905932737*(fskin[0]*nvnu_edge[1]+nvnu_edge[0]*fskin[1]); 
  Ghat_r[2] = 0.5477225575051661*nvnu_edge[3]*fskin[19]+(0.7071067811865475*nvnu_edge[7]+0.7905694150420947*nvnu_edge[1])*fskin[18]+0.6123724356957944*nvnu_edge[4]*fskin[17]+0.5477225575051661*nvnu_edge[2]*fskin[16]+0.3162277660168379*nvnu_edge[3]*fskin[15]+(0.7071067811865475*nvnu_edge[5]+0.7905694150420948*nvnu_edge[0])*fskin[14]+0.3535533905932737*nvnu_edge[4]*fskin[13]+0.7905694150420948*nvnu_edge[3]*fskin[12]+0.6123724356957944*nvnu_edge[6]*fskin[11]+(0.5477225575051661*nvnu_edge[7]+0.6123724356957944*nvnu_edge[1])*fskin[10]+nvnu_edge[2]*(0.3162277660168379*fskin[9]+0.7905694150420947*fskin[8])+0.3162277660168379*fskin[5]*nvnu_edge[7]+0.3535533905932737*nvnu_edge[6]*fskin[7]+(0.5477225575051661*nvnu_edge[5]+0.6123724356957944*nvnu_edge[0])*fskin[6]+0.3162277660168379*fskin[3]*nvnu_edge[5]+0.3535533905932737*nvnu_edge[1]*fskin[5]+0.6123724356957944*nvnu_edge[3]*fskin[4]+0.3535533905932737*(fskin[1]*nvnu_edge[3]+nvnu_edge[0]*fskin[3])+(0.6123724356957944*fskin[2]+0.3535533905932737*fskin[0])*nvnu_edge[2]; 
  Ghat_r[3] = (0.4898979485566356*nvnu_edge[6]+0.5477225575051661*nvnu_edge[2])*fskin[19]+(0.7071067811865475*(nvnu_edge[5]+nvnu_edge[4])+0.7905694150420947*nvnu_edge[0])*fskin[18]+0.4898979485566356*nvnu_edge[7]*fskin[17]+0.5477225575051661*(nvnu_edge[1]*fskin[17]+nvnu_edge[3]*fskin[16])+(0.2828427124746191*nvnu_edge[6]+0.3162277660168379*nvnu_edge[2])*fskin[15]+(0.7071067811865475*nvnu_edge[7]+0.7905694150420948*nvnu_edge[1])*fskin[14]+(0.2828427124746191*nvnu_edge[7]+0.3162277660168379*nvnu_edge[1])*fskin[13]+(0.7071067811865475*nvnu_edge[6]+0.7905694150420948*nvnu_edge[2])*fskin[12]+0.5477225575051661*nvnu_edge[3]*fskin[11]+(0.5477225575051661*(nvnu_edge[5]+nvnu_edge[4])+0.6123724356957944*nvnu_edge[0])*fskin[10]+nvnu_edge[3]*(0.3162277660168379*fskin[9]+0.7905694150420947*fskin[8])+(0.5477225575051661*fskin[6]+0.3162277660168379*fskin[3])*nvnu_edge[7]+0.3162277660168379*nvnu_edge[3]*fskin[7]+(0.5477225575051661*fskin[4]+0.3162277660168379*fskin[1])*nvnu_edge[6]+0.6123724356957944*nvnu_edge[1]*fskin[6]+fskin[5]*(0.3162277660168379*(nvnu_edge[5]+nvnu_edge[4])+0.3535533905932737*nvnu_edge[0])+0.6123724356957944*(nvnu_edge[2]*fskin[4]+fskin[2]*nvnu_edge[3])+0.3535533905932737*(fskin[0]*nvnu_edge[3]+nvnu_edge[1]*fskin[3]+fskin[1]*nvnu_edge[2]); 
  Ghat_r[4] = 0.5477225575051661*nvnu_edge[7]*fskin[19]+0.7071067811865475*nvnu_edge[3]*fskin[18]+(0.3912303982179757*nvnu_edge[6]+0.6123724356957944*nvnu_edge[2])*fskin[17]+0.3162277660168379*nvnu_edge[7]*fskin[15]+0.7905694150420947*nvnu_edge[6]*fskin[14]+(0.2258769757263128*nvnu_edge[6]+0.3535533905932737*nvnu_edge[2])*fskin[13]+0.7071067811865475*nvnu_edge[1]*fskin[12]+(0.3912303982179757*nvnu_edge[4]+0.6123724356957944*nvnu_edge[0])*fskin[11]+0.5477225575051661*nvnu_edge[3]*fskin[10]+0.7905694150420947*nvnu_edge[4]*fskin[8]+(0.2258769757263128*nvnu_edge[4]+0.3535533905932737*nvnu_edge[0])*fskin[7]+(0.6123724356957944*fskin[6]+0.3535533905932737*fskin[3])*nvnu_edge[6]+0.3162277660168379*nvnu_edge[3]*fskin[5]+(0.6123724356957944*fskin[2]+0.3535533905932737*fskin[0])*nvnu_edge[4]+nvnu_edge[1]*(0.5477225575051661*fskin[4]+0.3162277660168379*fskin[1]); 
  Ghat_r[5] = (0.3912303982179757*nvnu_edge[7]+0.6123724356957944*nvnu_edge[1])*fskin[19]+0.7071067811865475*nvnu_edge[3]*fskin[18]+0.5477225575051661*nvnu_edge[6]*fskin[17]+(0.3912303982179757*nvnu_edge[5]+0.6123724356957944*nvnu_edge[0])*fskin[16]+(0.2258769757263128*nvnu_edge[7]+0.3535533905932737*nvnu_edge[1])*fskin[15]+0.7071067811865475*nvnu_edge[2]*fskin[14]+0.3162277660168379*nvnu_edge[6]*fskin[13]+0.7905694150420947*nvnu_edge[7]*fskin[12]+0.5477225575051661*nvnu_edge[3]*fskin[10]+(0.2258769757263128*nvnu_edge[5]+0.3535533905932737*nvnu_edge[0])*fskin[9]+0.7905694150420947*nvnu_edge[5]*fskin[8]+(0.6123724356957944*fskin[4]+0.3535533905932737*fskin[1])*nvnu_edge[7]+0.5477225575051661*nvnu_edge[2]*fskin[6]+(0.6123724356957944*fskin[2]+0.3535533905932737*fskin[0])*nvnu_edge[5]+0.3162277660168379*(nvnu_edge[3]*fskin[5]+nvnu_edge[2]*fskin[3]); 
  Ghat_r[6] = 0.4898979485566356*nvnu_edge[3]*fskin[19]+(0.6324555320336759*nvnu_edge[7]+0.7071067811865475*nvnu_edge[1])*fskin[18]+(0.5477225575051661*nvnu_edge[5]+0.3912303982179757*nvnu_edge[4]+0.6123724356957944*nvnu_edge[0])*fskin[17]+0.5477225575051661*nvnu_edge[6]*fskin[16]+0.2828427124746191*nvnu_edge[3]*fskin[15]+0.7905694150420947*nvnu_edge[4]*fskin[14]+(0.3162277660168379*nvnu_edge[5]+0.2258769757263128*nvnu_edge[4]+0.3535533905932737*nvnu_edge[0])*fskin[13]+0.7071067811865475*nvnu_edge[3]*fskin[12]+(0.3912303982179757*nvnu_edge[6]+0.6123724356957944*nvnu_edge[2])*fskin[11]+(0.4898979485566357*nvnu_edge[7]+0.5477225575051661*nvnu_edge[1])*fskin[10]+nvnu_edge[6]*(0.3162277660168379*fskin[9]+0.7905694150420947*fskin[8])+0.2828427124746191*fskin[5]*nvnu_edge[7]+(0.2258769757263128*nvnu_edge[6]+0.3535533905932737*nvnu_edge[2])*fskin[7]+(0.6123724356957944*fskin[2]+0.3535533905932737*fskin[0])*nvnu_edge[6]+0.6123724356957944*nvnu_edge[4]*fskin[6]+0.3162277660168379*nvnu_edge[1]*fskin[5]+0.3535533905932737*fskin[3]*nvnu_edge[4]+nvnu_edge[3]*(0.5477225575051661*fskin[4]+0.3162277660168379*fskin[1]); 
  Ghat_r[7] = (0.3912303982179757*nvnu_edge[5]+0.5477225575051661*nvnu_edge[4]+0.6123724356957944*nvnu_edge[0])*fskin[19]+(0.6324555320336759*nvnu_edge[6]+0.7071067811865475*nvnu_edge[2])*fskin[18]+0.4898979485566356*nvnu_edge[3]*fskin[17]+(0.3912303982179757*nvnu_edge[7]+0.6123724356957944*nvnu_edge[1])*fskin[16]+(0.2258769757263128*nvnu_edge[5]+0.3162277660168379*nvnu_edge[4]+0.3535533905932737*nvnu_edge[0])*fskin[15]+nvnu_edge[3]*(0.7071067811865475*fskin[14]+0.2828427124746191*fskin[13])+0.7905694150420947*nvnu_edge[5]*fskin[12]+0.5477225575051661*nvnu_edge[7]*fskin[11]+(0.4898979485566357*nvnu_edge[6]+0.5477225575051661*nvnu_edge[2])*fskin[10]+(0.2258769757263128*nvnu_edge[7]+0.3535533905932737*nvnu_edge[1])*fskin[9]+nvnu_edge[7]*(0.7905694150420947*fskin[8]+0.3162277660168379*fskin[7]+0.6123724356957944*fskin[2]+0.3535533905932737*fskin[0])+0.2828427124746191*fskin[5]*nvnu_edge[6]+0.5477225575051661*nvnu_edge[3]*fskin[6]+(0.6123724356957944*fskin[4]+0.3535533905932737*fskin[1])*nvnu_edge[5]+0.3162277660168379*(nvnu_edge[2]*fskin[5]+fskin[3]*nvnu_edge[3]); 

  } 
  out[0] += 0.7071067811865475*Ghat_r[0]*rdv2; 
  out[1] += 0.7071067811865475*Ghat_r[1]*rdv2; 
  out[2] += 1.224744871391589*Ghat_r[0]*rdv2; 
  out[3] += 0.7071067811865475*Ghat_r[2]*rdv2; 
  out[4] += 1.224744871391589*Ghat_r[1]*rdv2; 
  out[5] += 0.7071067811865475*Ghat_r[3]*rdv2; 
  out[6] += 1.224744871391589*Ghat_r[2]*rdv2; 
  out[7] += 0.7071067811865475*Ghat_r[4]*rdv2; 
  out[8] += 1.58113883008419*Ghat_r[0]*rdv2; 
  out[9] += 0.7071067811865475*Ghat_r[5]*rdv2; 
  out[10] += 1.224744871391589*Ghat_r[3]*rdv2; 
  out[11] += 1.224744871391589*Ghat_r[4]*rdv2; 
  out[12] += 1.58113883008419*Ghat_r[1]*rdv2; 
  out[13] += 0.7071067811865475*Ghat_r[6]*rdv2; 
  out[14] += 1.58113883008419*Ghat_r[2]*rdv2; 
  out[15] += 0.7071067811865475*Ghat_r[7]*rdv2; 
  out[16] += 1.224744871391589*Ghat_r[5]*rdv2; 
  out[17] += 1.224744871391589*Ghat_r[6]*rdv2; 
  out[18] += 1.58113883008419*Ghat_r[3]*rdv2; 
  out[19] += 1.224744871391589*Ghat_r[7]*rdv2; 

  } else { 

  double Ghat_l[8] = {0.0}; 
  if (w[1]>0) {

  Ghat_l[0] = (-0.6123724356957944*nvnu_skin[7]*fskin[19])+0.7905694150420947*nvnu_skin[3]*fskin[18]-0.6123724356957944*(nvnu_skin[6]*fskin[17]+nvnu_skin[5]*fskin[16])+0.3535533905932737*nvnu_skin[7]*fskin[15]+0.7905694150420948*nvnu_skin[2]*fskin[14]+0.3535533905932737*nvnu_skin[6]*fskin[13]+0.7905694150420948*nvnu_skin[1]*fskin[12]-0.6123724356957944*(nvnu_skin[4]*fskin[11]+nvnu_skin[3]*fskin[10])+0.3535533905932737*nvnu_skin[5]*fskin[9]+0.7905694150420947*nvnu_skin[0]*fskin[8]+0.3535533905932737*nvnu_skin[4]*fskin[7]-0.6123724356957944*nvnu_skin[2]*fskin[6]+0.3535533905932737*nvnu_skin[3]*fskin[5]-0.6123724356957944*nvnu_skin[1]*fskin[4]+0.3535533905932737*nvnu_skin[2]*fskin[3]-0.6123724356957944*nvnu_skin[0]*fskin[2]+0.3535533905932737*(fskin[1]*nvnu_skin[1]+fskin[0]*nvnu_skin[0]); 
  Ghat_l[1] = (-0.6123724356957944*nvnu_skin[5]*fskin[19])+(0.7071067811865475*nvnu_skin[6]+0.7905694150420947*nvnu_skin[2])*fskin[18]-0.5477225575051661*nvnu_skin[3]*fskin[17]-0.6123724356957944*nvnu_skin[7]*fskin[16]+0.3535533905932737*nvnu_skin[5]*fskin[15]+nvnu_skin[3]*(0.7905694150420948*fskin[14]+0.3162277660168379*fskin[13])+(0.7071067811865475*nvnu_skin[4]+0.7905694150420948*nvnu_skin[0])*fskin[12]-0.5477225575051661*nvnu_skin[1]*fskin[11]+((-0.5477225575051661*nvnu_skin[6])-0.6123724356957944*nvnu_skin[2])*fskin[10]+0.3535533905932737*nvnu_skin[7]*fskin[9]+nvnu_skin[1]*(0.7905694150420947*fskin[8]+0.3162277660168379*fskin[7])+0.3162277660168379*fskin[5]*nvnu_skin[6]-0.6123724356957944*nvnu_skin[3]*fskin[6]+0.3535533905932737*nvnu_skin[2]*fskin[5]+(0.3162277660168379*fskin[1]-0.5477225575051661*fskin[4])*nvnu_skin[4]-0.6123724356957944*nvnu_skin[0]*fskin[4]+0.3535533905932737*fskin[3]*nvnu_skin[3]-0.6123724356957944*nvnu_skin[1]*fskin[2]+0.3535533905932737*(fskin[0]*nvnu_skin[1]+nvnu_skin[0]*fskin[1]); 
  Ghat_l[2] = (-0.5477225575051661*nvnu_skin[3]*fskin[19])+(0.7071067811865475*nvnu_skin[7]+0.7905694150420947*nvnu_skin[1])*fskin[18]-0.6123724356957944*nvnu_skin[4]*fskin[17]-0.5477225575051661*nvnu_skin[2]*fskin[16]+0.3162277660168379*nvnu_skin[3]*fskin[15]+(0.7071067811865475*nvnu_skin[5]+0.7905694150420948*nvnu_skin[0])*fskin[14]+0.3535533905932737*nvnu_skin[4]*fskin[13]+0.7905694150420948*nvnu_skin[3]*fskin[12]-0.6123724356957944*nvnu_skin[6]*fskin[11]+((-0.5477225575051661*nvnu_skin[7])-0.6123724356957944*nvnu_skin[1])*fskin[10]+nvnu_skin[2]*(0.3162277660168379*fskin[9]+0.7905694150420947*fskin[8])+0.3162277660168379*fskin[5]*nvnu_skin[7]+0.3535533905932737*nvnu_skin[6]*fskin[7]+((-0.5477225575051661*nvnu_skin[5])-0.6123724356957944*nvnu_skin[0])*fskin[6]+0.3162277660168379*fskin[3]*nvnu_skin[5]+0.3535533905932737*nvnu_skin[1]*fskin[5]-0.6123724356957944*nvnu_skin[3]*fskin[4]+0.3535533905932737*(fskin[1]*nvnu_skin[3]+nvnu_skin[0]*fskin[3])+(0.3535533905932737*fskin[0]-0.6123724356957944*fskin[2])*nvnu_skin[2]; 
  Ghat_l[3] = ((-0.4898979485566356*nvnu_skin[6])-0.5477225575051661*nvnu_skin[2])*fskin[19]+(0.7071067811865475*(nvnu_skin[5]+nvnu_skin[4])+0.7905694150420947*nvnu_skin[0])*fskin[18]-0.4898979485566356*nvnu_skin[7]*fskin[17]-0.5477225575051661*(nvnu_skin[1]*fskin[17]+nvnu_skin[3]*fskin[16])+(0.2828427124746191*nvnu_skin[6]+0.3162277660168379*nvnu_skin[2])*fskin[15]+(0.7071067811865475*nvnu_skin[7]+0.7905694150420948*nvnu_skin[1])*fskin[14]+(0.2828427124746191*nvnu_skin[7]+0.3162277660168379*nvnu_skin[1])*fskin[13]+(0.7071067811865475*nvnu_skin[6]+0.7905694150420948*nvnu_skin[2])*fskin[12]-0.5477225575051661*nvnu_skin[3]*fskin[11]+((-0.5477225575051661*(nvnu_skin[5]+nvnu_skin[4]))-0.6123724356957944*nvnu_skin[0])*fskin[10]+nvnu_skin[3]*(0.3162277660168379*fskin[9]+0.7905694150420947*fskin[8])+(0.3162277660168379*fskin[3]-0.5477225575051661*fskin[6])*nvnu_skin[7]+0.3162277660168379*nvnu_skin[3]*fskin[7]+(0.3162277660168379*fskin[1]-0.5477225575051661*fskin[4])*nvnu_skin[6]-0.6123724356957944*nvnu_skin[1]*fskin[6]+fskin[5]*(0.3162277660168379*(nvnu_skin[5]+nvnu_skin[4])+0.3535533905932737*nvnu_skin[0])-0.6123724356957944*(nvnu_skin[2]*fskin[4]+fskin[2]*nvnu_skin[3])+0.3535533905932737*(fskin[0]*nvnu_skin[3]+nvnu_skin[1]*fskin[3]+fskin[1]*nvnu_skin[2]); 
  Ghat_l[4] = (-0.5477225575051661*nvnu_skin[7]*fskin[19])+0.7071067811865475*nvnu_skin[3]*fskin[18]+((-0.3912303982179757*nvnu_skin[6])-0.6123724356957944*nvnu_skin[2])*fskin[17]+0.3162277660168379*nvnu_skin[7]*fskin[15]+0.7905694150420947*nvnu_skin[6]*fskin[14]+(0.2258769757263128*nvnu_skin[6]+0.3535533905932737*nvnu_skin[2])*fskin[13]+0.7071067811865475*nvnu_skin[1]*fskin[12]+((-0.3912303982179757*nvnu_skin[4])-0.6123724356957944*nvnu_skin[0])*fskin[11]-0.5477225575051661*nvnu_skin[3]*fskin[10]+0.7905694150420947*nvnu_skin[4]*fskin[8]+(0.2258769757263128*nvnu_skin[4]+0.3535533905932737*nvnu_skin[0])*fskin[7]+(0.3535533905932737*fskin[3]-0.6123724356957944*fskin[6])*nvnu_skin[6]+0.3162277660168379*nvnu_skin[3]*fskin[5]+(0.3535533905932737*fskin[0]-0.6123724356957944*fskin[2])*nvnu_skin[4]+nvnu_skin[1]*(0.3162277660168379*fskin[1]-0.5477225575051661*fskin[4]); 
  Ghat_l[5] = ((-0.3912303982179757*nvnu_skin[7])-0.6123724356957944*nvnu_skin[1])*fskin[19]+0.7071067811865475*nvnu_skin[3]*fskin[18]-0.5477225575051661*nvnu_skin[6]*fskin[17]+((-0.3912303982179757*nvnu_skin[5])-0.6123724356957944*nvnu_skin[0])*fskin[16]+(0.2258769757263128*nvnu_skin[7]+0.3535533905932737*nvnu_skin[1])*fskin[15]+0.7071067811865475*nvnu_skin[2]*fskin[14]+0.3162277660168379*nvnu_skin[6]*fskin[13]+0.7905694150420947*nvnu_skin[7]*fskin[12]-0.5477225575051661*nvnu_skin[3]*fskin[10]+(0.2258769757263128*nvnu_skin[5]+0.3535533905932737*nvnu_skin[0])*fskin[9]+0.7905694150420947*nvnu_skin[5]*fskin[8]+(0.3535533905932737*fskin[1]-0.6123724356957944*fskin[4])*nvnu_skin[7]-0.5477225575051661*nvnu_skin[2]*fskin[6]+(0.3535533905932737*fskin[0]-0.6123724356957944*fskin[2])*nvnu_skin[5]+0.3162277660168379*(nvnu_skin[3]*fskin[5]+nvnu_skin[2]*fskin[3]); 
  Ghat_l[6] = (-0.4898979485566356*nvnu_skin[3]*fskin[19])+(0.6324555320336759*nvnu_skin[7]+0.7071067811865475*nvnu_skin[1])*fskin[18]+((-0.5477225575051661*nvnu_skin[5])-0.3912303982179757*nvnu_skin[4]-0.6123724356957944*nvnu_skin[0])*fskin[17]-0.5477225575051661*nvnu_skin[6]*fskin[16]+0.2828427124746191*nvnu_skin[3]*fskin[15]+0.7905694150420947*nvnu_skin[4]*fskin[14]+(0.3162277660168379*nvnu_skin[5]+0.2258769757263128*nvnu_skin[4]+0.3535533905932737*nvnu_skin[0])*fskin[13]+0.7071067811865475*nvnu_skin[3]*fskin[12]+((-0.3912303982179757*nvnu_skin[6])-0.6123724356957944*nvnu_skin[2])*fskin[11]+((-0.4898979485566357*nvnu_skin[7])-0.5477225575051661*nvnu_skin[1])*fskin[10]+nvnu_skin[6]*(0.3162277660168379*fskin[9]+0.7905694150420947*fskin[8])+0.2828427124746191*fskin[5]*nvnu_skin[7]+(0.2258769757263128*nvnu_skin[6]+0.3535533905932737*nvnu_skin[2])*fskin[7]+(0.3535533905932737*fskin[0]-0.6123724356957944*fskin[2])*nvnu_skin[6]-0.6123724356957944*nvnu_skin[4]*fskin[6]+0.3162277660168379*nvnu_skin[1]*fskin[5]+0.3535533905932737*fskin[3]*nvnu_skin[4]+nvnu_skin[3]*(0.3162277660168379*fskin[1]-0.5477225575051661*fskin[4]); 
  Ghat_l[7] = ((-0.3912303982179757*nvnu_skin[5])-0.5477225575051661*nvnu_skin[4]-0.6123724356957944*nvnu_skin[0])*fskin[19]+(0.6324555320336759*nvnu_skin[6]+0.7071067811865475*nvnu_skin[2])*fskin[18]-0.4898979485566356*nvnu_skin[3]*fskin[17]+((-0.3912303982179757*nvnu_skin[7])-0.6123724356957944*nvnu_skin[1])*fskin[16]+(0.2258769757263128*nvnu_skin[5]+0.3162277660168379*nvnu_skin[4]+0.3535533905932737*nvnu_skin[0])*fskin[15]+nvnu_skin[3]*(0.7071067811865475*fskin[14]+0.2828427124746191*fskin[13])+0.7905694150420947*nvnu_skin[5]*fskin[12]-0.5477225575051661*nvnu_skin[7]*fskin[11]+((-0.4898979485566357*nvnu_skin[6])-0.5477225575051661*nvnu_skin[2])*fskin[10]+(0.2258769757263128*nvnu_skin[7]+0.3535533905932737*nvnu_skin[1])*fskin[9]+nvnu_skin[7]*(0.7905694150420947*fskin[8]+0.3162277660168379*fskin[7]-0.6123724356957944*fskin[2]+0.3535533905932737*fskin[0])+0.2828427124746191*fskin[5]*nvnu_skin[6]-0.5477225575051661*nvnu_skin[3]*fskin[6]+(0.3535533905932737*fskin[1]-0.6123724356957944*fskin[4])*nvnu_skin[5]+0.3162277660168379*(nvnu_skin[2]*fskin[5]+fskin[3]*nvnu_skin[3]); 

  } else { 

  Ghat_l[0] = 0.6123724356957944*nvnu_skin[7]*fedge[19]+0.7905694150420947*nvnu_skin[3]*fedge[18]+0.6123724356957944*(nvnu_skin[6]*fedge[17]+nvnu_skin[5]*fedge[16])+0.3535533905932737*nvnu_skin[7]*fedge[15]+0.7905694150420948*nvnu_skin[2]*fedge[14]+0.3535533905932737*nvnu_skin[6]*fedge[13]+0.7905694150420948*nvnu_skin[1]*fedge[12]+0.6123724356957944*(nvnu_skin[4]*fedge[11]+nvnu_skin[3]*fedge[10])+0.3535533905932737*nvnu_skin[5]*fedge[9]+0.7905694150420947*nvnu_skin[0]*fedge[8]+0.3535533905932737*nvnu_skin[4]*fedge[7]+0.6123724356957944*nvnu_skin[2]*fedge[6]+0.3535533905932737*nvnu_skin[3]*fedge[5]+0.6123724356957944*nvnu_skin[1]*fedge[4]+0.3535533905932737*nvnu_skin[2]*fedge[3]+0.6123724356957944*nvnu_skin[0]*fedge[2]+0.3535533905932737*(fedge[1]*nvnu_skin[1]+fedge[0]*nvnu_skin[0]); 
  Ghat_l[1] = 0.6123724356957944*nvnu_skin[5]*fedge[19]+(0.7071067811865475*nvnu_skin[6]+0.7905694150420947*nvnu_skin[2])*fedge[18]+0.5477225575051661*nvnu_skin[3]*fedge[17]+0.6123724356957944*nvnu_skin[7]*fedge[16]+0.3535533905932737*nvnu_skin[5]*fedge[15]+nvnu_skin[3]*(0.7905694150420948*fedge[14]+0.3162277660168379*fedge[13])+(0.7071067811865475*nvnu_skin[4]+0.7905694150420948*nvnu_skin[0])*fedge[12]+0.5477225575051661*nvnu_skin[1]*fedge[11]+(0.5477225575051661*nvnu_skin[6]+0.6123724356957944*nvnu_skin[2])*fedge[10]+0.3535533905932737*nvnu_skin[7]*fedge[9]+nvnu_skin[1]*(0.7905694150420947*fedge[8]+0.3162277660168379*fedge[7])+0.3162277660168379*fedge[5]*nvnu_skin[6]+0.6123724356957944*nvnu_skin[3]*fedge[6]+0.3535533905932737*nvnu_skin[2]*fedge[5]+(0.5477225575051661*fedge[4]+0.3162277660168379*fedge[1])*nvnu_skin[4]+0.6123724356957944*nvnu_skin[0]*fedge[4]+0.3535533905932737*fedge[3]*nvnu_skin[3]+0.6123724356957944*nvnu_skin[1]*fedge[2]+0.3535533905932737*(fedge[0]*nvnu_skin[1]+nvnu_skin[0]*fedge[1]); 
  Ghat_l[2] = 0.5477225575051661*nvnu_skin[3]*fedge[19]+(0.7071067811865475*nvnu_skin[7]+0.7905694150420947*nvnu_skin[1])*fedge[18]+0.6123724356957944*nvnu_skin[4]*fedge[17]+0.5477225575051661*nvnu_skin[2]*fedge[16]+0.3162277660168379*nvnu_skin[3]*fedge[15]+(0.7071067811865475*nvnu_skin[5]+0.7905694150420948*nvnu_skin[0])*fedge[14]+0.3535533905932737*nvnu_skin[4]*fedge[13]+0.7905694150420948*nvnu_skin[3]*fedge[12]+0.6123724356957944*nvnu_skin[6]*fedge[11]+(0.5477225575051661*nvnu_skin[7]+0.6123724356957944*nvnu_skin[1])*fedge[10]+nvnu_skin[2]*(0.3162277660168379*fedge[9]+0.7905694150420947*fedge[8])+0.3162277660168379*fedge[5]*nvnu_skin[7]+0.3535533905932737*nvnu_skin[6]*fedge[7]+(0.5477225575051661*nvnu_skin[5]+0.6123724356957944*nvnu_skin[0])*fedge[6]+0.3162277660168379*fedge[3]*nvnu_skin[5]+0.3535533905932737*nvnu_skin[1]*fedge[5]+0.6123724356957944*nvnu_skin[3]*fedge[4]+0.3535533905932737*(fedge[1]*nvnu_skin[3]+nvnu_skin[0]*fedge[3])+(0.6123724356957944*fedge[2]+0.3535533905932737*fedge[0])*nvnu_skin[2]; 
  Ghat_l[3] = (0.4898979485566356*nvnu_skin[6]+0.5477225575051661*nvnu_skin[2])*fedge[19]+(0.7071067811865475*(nvnu_skin[5]+nvnu_skin[4])+0.7905694150420947*nvnu_skin[0])*fedge[18]+0.4898979485566356*nvnu_skin[7]*fedge[17]+0.5477225575051661*(nvnu_skin[1]*fedge[17]+nvnu_skin[3]*fedge[16])+(0.2828427124746191*nvnu_skin[6]+0.3162277660168379*nvnu_skin[2])*fedge[15]+(0.7071067811865475*nvnu_skin[7]+0.7905694150420948*nvnu_skin[1])*fedge[14]+(0.2828427124746191*nvnu_skin[7]+0.3162277660168379*nvnu_skin[1])*fedge[13]+(0.7071067811865475*nvnu_skin[6]+0.7905694150420948*nvnu_skin[2])*fedge[12]+0.5477225575051661*nvnu_skin[3]*fedge[11]+(0.5477225575051661*(nvnu_skin[5]+nvnu_skin[4])+0.6123724356957944*nvnu_skin[0])*fedge[10]+nvnu_skin[3]*(0.3162277660168379*fedge[9]+0.7905694150420947*fedge[8])+(0.5477225575051661*fedge[6]+0.3162277660168379*fedge[3])*nvnu_skin[7]+0.3162277660168379*nvnu_skin[3]*fedge[7]+(0.5477225575051661*fedge[4]+0.3162277660168379*fedge[1])*nvnu_skin[6]+0.6123724356957944*nvnu_skin[1]*fedge[6]+fedge[5]*(0.3162277660168379*(nvnu_skin[5]+nvnu_skin[4])+0.3535533905932737*nvnu_skin[0])+0.6123724356957944*(nvnu_skin[2]*fedge[4]+fedge[2]*nvnu_skin[3])+0.3535533905932737*(fedge[0]*nvnu_skin[3]+nvnu_skin[1]*fedge[3]+fedge[1]*nvnu_skin[2]); 
  Ghat_l[4] = 0.5477225575051661*nvnu_skin[7]*fedge[19]+0.7071067811865475*nvnu_skin[3]*fedge[18]+(0.3912303982179757*nvnu_skin[6]+0.6123724356957944*nvnu_skin[2])*fedge[17]+0.3162277660168379*nvnu_skin[7]*fedge[15]+0.7905694150420947*nvnu_skin[6]*fedge[14]+(0.2258769757263128*nvnu_skin[6]+0.3535533905932737*nvnu_skin[2])*fedge[13]+0.7071067811865475*nvnu_skin[1]*fedge[12]+(0.3912303982179757*nvnu_skin[4]+0.6123724356957944*nvnu_skin[0])*fedge[11]+0.5477225575051661*nvnu_skin[3]*fedge[10]+0.7905694150420947*nvnu_skin[4]*fedge[8]+(0.2258769757263128*nvnu_skin[4]+0.3535533905932737*nvnu_skin[0])*fedge[7]+(0.6123724356957944*fedge[6]+0.3535533905932737*fedge[3])*nvnu_skin[6]+0.3162277660168379*nvnu_skin[3]*fedge[5]+(0.6123724356957944*fedge[2]+0.3535533905932737*fedge[0])*nvnu_skin[4]+nvnu_skin[1]*(0.5477225575051661*fedge[4]+0.3162277660168379*fedge[1]); 
  Ghat_l[5] = (0.3912303982179757*nvnu_skin[7]+0.6123724356957944*nvnu_skin[1])*fedge[19]+0.7071067811865475*nvnu_skin[3]*fedge[18]+0.5477225575051661*nvnu_skin[6]*fedge[17]+(0.3912303982179757*nvnu_skin[5]+0.6123724356957944*nvnu_skin[0])*fedge[16]+(0.2258769757263128*nvnu_skin[7]+0.3535533905932737*nvnu_skin[1])*fedge[15]+0.7071067811865475*nvnu_skin[2]*fedge[14]+0.3162277660168379*nvnu_skin[6]*fedge[13]+0.7905694150420947*nvnu_skin[7]*fedge[12]+0.5477225575051661*nvnu_skin[3]*fedge[10]+(0.2258769757263128*nvnu_skin[5]+0.3535533905932737*nvnu_skin[0])*fedge[9]+0.7905694150420947*nvnu_skin[5]*fedge[8]+(0.6123724356957944*fedge[4]+0.3535533905932737*fedge[1])*nvnu_skin[7]+0.5477225575051661*nvnu_skin[2]*fedge[6]+(0.6123724356957944*fedge[2]+0.3535533905932737*fedge[0])*nvnu_skin[5]+0.3162277660168379*(nvnu_skin[3]*fedge[5]+nvnu_skin[2]*fedge[3]); 
  Ghat_l[6] = 0.4898979485566356*nvnu_skin[3]*fedge[19]+(0.6324555320336759*nvnu_skin[7]+0.7071067811865475*nvnu_skin[1])*fedge[18]+(0.5477225575051661*nvnu_skin[5]+0.3912303982179757*nvnu_skin[4]+0.6123724356957944*nvnu_skin[0])*fedge[17]+0.5477225575051661*nvnu_skin[6]*fedge[16]+0.2828427124746191*nvnu_skin[3]*fedge[15]+0.7905694150420947*nvnu_skin[4]*fedge[14]+(0.3162277660168379*nvnu_skin[5]+0.2258769757263128*nvnu_skin[4]+0.3535533905932737*nvnu_skin[0])*fedge[13]+0.7071067811865475*nvnu_skin[3]*fedge[12]+(0.3912303982179757*nvnu_skin[6]+0.6123724356957944*nvnu_skin[2])*fedge[11]+(0.4898979485566357*nvnu_skin[7]+0.5477225575051661*nvnu_skin[1])*fedge[10]+nvnu_skin[6]*(0.3162277660168379*fedge[9]+0.7905694150420947*fedge[8])+0.2828427124746191*fedge[5]*nvnu_skin[7]+(0.2258769757263128*nvnu_skin[6]+0.3535533905932737*nvnu_skin[2])*fedge[7]+(0.6123724356957944*fedge[2]+0.3535533905932737*fedge[0])*nvnu_skin[6]+0.6123724356957944*nvnu_skin[4]*fedge[6]+0.3162277660168379*nvnu_skin[1]*fedge[5]+0.3535533905932737*fedge[3]*nvnu_skin[4]+nvnu_skin[3]*(0.5477225575051661*fedge[4]+0.3162277660168379*fedge[1]); 
  Ghat_l[7] = (0.3912303982179757*nvnu_skin[5]+0.5477225575051661*nvnu_skin[4]+0.6123724356957944*nvnu_skin[0])*fedge[19]+(0.6324555320336759*nvnu_skin[6]+0.7071067811865475*nvnu_skin[2])*fedge[18]+0.4898979485566356*nvnu_skin[3]*fedge[17]+(0.3912303982179757*nvnu_skin[7]+0.6123724356957944*nvnu_skin[1])*fedge[16]+(0.2258769757263128*nvnu_skin[5]+0.3162277660168379*nvnu_skin[4]+0.3535533905932737*nvnu_skin[0])*fedge[15]+nvnu_skin[3]*(0.7071067811865475*fedge[14]+0.2828427124746191*fedge[13])+0.7905694150420947*nvnu_skin[5]*fedge[12]+0.5477225575051661*nvnu_skin[7]*fedge[11]+(0.4898979485566357*nvnu_skin[6]+0.5477225575051661*nvnu_skin[2])*fedge[10]+(0.2258769757263128*nvnu_skin[7]+0.3535533905932737*nvnu_skin[1])*fedge[9]+nvnu_skin[7]*(0.7905694150420947*fedge[8]+0.3162277660168379*fedge[7]+0.6123724356957944*fedge[2]+0.3535533905932737*fedge[0])+0.2828427124746191*fedge[5]*nvnu_skin[6]+0.5477225575051661*nvnu_skin[3]*fedge[6]+(0.6123724356957944*fedge[4]+0.3535533905932737*fedge[1])*nvnu_skin[5]+0.3162277660168379*(nvnu_skin[2]*fedge[5]+fedge[3]*nvnu_skin[3]); 

  } 
  out[0] += -0.7071067811865475*Ghat_l[0]*rdv2; 
  out[1] += -0.7071067811865475*Ghat_l[1]*rdv2; 
  out[2] += 1.224744871391589*Ghat_l[0]*rdv2; 
  out[3] += -0.7071067811865475*Ghat_l[2]*rdv2; 
  out[4] += 1.224744871391589*Ghat_l[1]*rdv2; 
  out[5] += -0.7071067811865475*Ghat_l[3]*rdv2; 
  out[6] += 1.224744871391589*Ghat_l[2]*rdv2; 
  out[7] += -0.7071067811865475*Ghat_l[4]*rdv2; 
  out[8] += -1.58113883008419*Ghat_l[0]*rdv2; 
  out[9] += -0.7071067811865475*Ghat_l[5]*rdv2; 
  out[10] += 1.224744871391589*Ghat_l[3]*rdv2; 
  out[11] += 1.224744871391589*Ghat_l[4]*rdv2; 
  out[12] += -1.58113883008419*Ghat_l[1]*rdv2; 
  out[13] += -0.7071067811865475*Ghat_l[6]*rdv2; 
  out[14] += -1.58113883008419*Ghat_l[2]*rdv2; 
  out[15] += -0.7071067811865475*Ghat_l[7]*rdv2; 
  out[16] += 1.224744871391589*Ghat_l[5]*rdv2; 
  out[17] += 1.224744871391589*Ghat_l[6]*rdv2; 
  out[18] += -1.58113883008419*Ghat_l[3]*rdv2; 
  out[19] += 1.224744871391589*Ghat_l[7]*rdv2; 

  } 

  double cflFreq = fmax(fabs(nvnu_edge[0]), fabs(nvnu_skin[0])); 
  return 1.25*rdv2*cflFreq; 

} 
