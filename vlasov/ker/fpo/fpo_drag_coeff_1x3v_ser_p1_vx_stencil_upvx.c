#include <gkyl_fpo_vlasov_kernels.h> 

GKYL_CU_DH void fpo_drag_coeff_1x3v_vx_ser_p1_upvx(const double *dxv, const double *gamma, 
    const double* fpo_h_stencil[3], const double* fpo_dhdv_surf, double *drag_coeff, 
    double *drag_coeff_surf) {
  // dxv[NDIM]: Cell spacing in each direction. 
  // gamma: Scalar factor gamma. 
  // fpo_h_stencil[3]: 3 cell stencil of Rosenbluth potential H. 
  // fpo_dhdv_surf: Surface projection of dH/dv in center cell. 
  // drag_coeff: Output array for drag coefficient. 
  // drag_coeff_surf: Surface projection of drag coefficient at lower boundary.

  // Use cell-average value for gamma. 
  double gamma_avg = gamma[0]/sqrt(pow(2, 1)); 
  double dv1 = 2.0/dxv[1]; 

  const double* H_L = fpo_h_stencil[0]; 
  const double* H_C = fpo_h_stencil[1]; 
  const double* H_R = fpo_h_stencil[2]; 
  
  const double *dHdv_surf_C = &fpo_dhdv_surf[0]; 
  
  double *out = &drag_coeff[0]; 
  double *out_surf = &drag_coeff_surf[0]; 
  
  out[0] = (-(0.8441156615061707*H_L[16])+2.01805134969356*H_C[16]-1.1691342951089918*H_L[2]+1.6454482671904334*H_C[2]-0.8125*H_L[0]+0.8125*H_C[0])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[0]*gamma_avg; 
  out[1] = (-(0.8441156615061707*H_L[17])+2.0180513496935606*H_C[17]-1.1691342951089916*H_L[5]+1.6454482671904334*H_C[5]-0.8125*H_L[1]+0.8125*H_C[1])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[1]*gamma_avg; 
  out[2] = (0.232379000772445*H_L[16]+5.189797683917939*H_C[16]+0.41250000000000003*H_L[2]+0.41250000000000003*H_C[2]+0.32475952641916445*H_L[0]-0.32475952641916445*H_C[0])*dv1*gamma_avg+0.24494897427831794*dHdv_surf_C[0]*gamma_avg; 
  out[3] = (-(0.8441156615061707*H_L[18])+2.0180513496935606*H_C[18]-1.1691342951089916*H_L[7]+1.6454482671904334*H_C[7]-0.8125*H_L[3]+0.8125*H_C[3])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[2]*gamma_avg; 
  out[4] = (-(0.8441156615061707*H_L[19])+2.0180513496935606*H_C[19]-1.1691342951089916*H_L[9]+1.6454482671904334*H_C[9]-0.8125*H_L[4]+0.8125*H_C[4])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[3]*gamma_avg; 
  out[5] = (0.232379000772445*H_L[17]+5.189797683917939*H_C[17]+0.41250000000000003*H_L[5]+0.41250000000000003*H_C[5]+0.32475952641916445*H_L[1]-0.32475952641916445*H_C[1])*dv1*gamma_avg+0.24494897427831794*dHdv_surf_C[1]*gamma_avg; 
  out[6] = (-(0.8441156615061707*H_L[20])+2.01805134969356*H_C[20]-1.1691342951089918*H_L[11]+1.6454482671904334*H_C[11]-0.8125*H_L[6]+0.8125*H_C[6])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[4]*gamma_avg; 
  out[7] = (0.232379000772445*H_L[18]+5.189797683917939*H_C[18]+0.41250000000000003*H_L[7]+0.41250000000000003*H_C[7]+0.32475952641916445*H_L[3]-0.32475952641916445*H_C[3])*dv1*gamma_avg+0.24494897427831794*dHdv_surf_C[2]*gamma_avg; 
  out[8] = (-(0.8441156615061707*H_L[21])+2.01805134969356*H_C[21]-1.1691342951089918*H_L[12]+1.6454482671904334*H_C[12]-0.8125*H_L[8]+0.8125*H_C[8])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[5]*gamma_avg; 
  out[9] = (0.232379000772445*H_L[19]+5.189797683917939*H_C[19]+0.41250000000000003*H_L[9]+0.41250000000000003*H_C[9]+0.32475952641916445*H_L[4]-0.32475952641916445*H_C[4])*dv1*gamma_avg+0.24494897427831794*dHdv_surf_C[3]*gamma_avg; 
  out[10] = (-(0.8441156615061707*H_L[22])+2.01805134969356*H_C[22]-1.1691342951089918*H_L[14]+1.6454482671904334*H_C[14]-0.8125*H_L[10]+0.8125*H_C[10])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[6]*gamma_avg; 
  out[11] = (0.232379000772445*H_L[20]+5.189797683917939*H_C[20]+0.41250000000000003*H_L[11]+0.41250000000000003*H_C[11]+0.32475952641916445*H_L[6]-0.32475952641916445*H_C[6])*dv1*gamma_avg+0.24494897427831794*dHdv_surf_C[4]*gamma_avg; 
  out[12] = (0.232379000772445*H_L[21]+5.189797683917939*H_C[21]+0.41250000000000003*H_L[12]+0.41250000000000003*H_C[12]+0.32475952641916445*H_L[8]-0.32475952641916445*H_C[8])*dv1*gamma_avg+0.24494897427831794*dHdv_surf_C[5]*gamma_avg; 
  out[13] = (-(0.8441156615061707*H_L[23])+2.0180513496935606*H_C[23]-1.1691342951089916*H_L[15]+1.6454482671904334*H_C[15]-0.8125*H_L[13]+0.8125*H_C[13])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[7]*gamma_avg; 
  out[14] = (0.232379000772445*H_L[22]+5.189797683917939*H_C[22]+0.41250000000000003*H_L[14]+0.41250000000000003*H_C[14]+0.32475952641916445*H_L[10]-0.32475952641916445*H_C[10])*dv1*gamma_avg+0.24494897427831794*dHdv_surf_C[6]*gamma_avg; 
  out[15] = (0.232379000772445*H_L[23]+5.189797683917939*H_C[23]+0.41250000000000003*H_L[15]+0.41250000000000003*H_C[15]+0.32475952641916445*H_L[13]-0.32475952641916445*H_C[13])*dv1*gamma_avg+0.24494897427831794*dHdv_surf_C[7]*gamma_avg; 
  out[16] = (-(1.8875000000000002*H_L[16])+4.5125*H_C[16]-2.6142637586900057*H_L[2]-4.066632513517788*H_C[2]-1.8168052317185797*H_L[0]+1.8168052317185797*H_C[0])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[0]*gamma_avg; 
  out[17] = (-(1.8875*H_L[17])+4.5125*H_C[17]-2.6142637586900066*H_L[5]-4.066632513517788*H_C[5]-1.816805231718579*H_L[1]+1.816805231718579*H_C[1])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[1]*gamma_avg; 
  out[18] = (-(1.8875*H_L[18])+4.5125*H_C[18]-2.6142637586900066*H_L[7]-4.066632513517788*H_C[7]-1.816805231718579*H_L[3]+1.816805231718579*H_C[3])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[2]*gamma_avg; 
  out[19] = (-(1.8875*H_L[19])+4.5125*H_C[19]-2.6142637586900066*H_L[9]-4.066632513517788*H_C[9]-1.816805231718579*H_L[4]+1.816805231718579*H_C[4])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[3]*gamma_avg; 
  out[20] = (-(1.8875000000000002*H_L[20])+4.5125*H_C[20]-2.6142637586900057*H_L[11]-4.066632513517788*H_C[11]-1.8168052317185797*H_L[6]+1.8168052317185797*H_C[6])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[4]*gamma_avg; 
  out[21] = (-(1.8875000000000002*H_L[21])+4.5125*H_C[21]-2.6142637586900057*H_L[12]-4.066632513517788*H_C[12]-1.8168052317185797*H_L[8]+1.8168052317185797*H_C[8])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[5]*gamma_avg; 
  out[22] = (-(1.8875000000000002*H_L[22])+4.5125*H_C[22]-2.6142637586900057*H_L[14]-4.066632513517788*H_C[14]-1.8168052317185797*H_L[10]+1.8168052317185797*H_C[10])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[6]*gamma_avg; 
  out[23] = (-(1.8875*H_L[23])+4.5125*H_C[23]-2.6142637586900066*H_L[15]-4.066632513517788*H_C[15]-1.816805231718579*H_L[13]+1.816805231718579*H_C[13])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[7]*gamma_avg; 
  out[24] = (-(1.1691342951089922*H_L[26])+1.6454482671904336*H_C[26]-0.8125*H_L[24]+0.8125*H_C[24])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[8]*gamma_avg; 
  out[25] = (-(1.1691342951089922*H_L[28])+1.6454482671904336*H_C[28]-0.8125*H_L[25]+0.8125*H_C[25])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[9]*gamma_avg; 
  out[26] = (0.41250000000000003*H_L[26]+0.41250000000000003*H_C[26]+0.32475952641916456*H_L[24]-0.32475952641916456*H_C[24])*dv1*gamma_avg+0.24494897427831797*dHdv_surf_C[8]*gamma_avg; 
  out[27] = (-(1.1691342951089922*H_L[30])+1.6454482671904336*H_C[30]-0.8125*H_L[27]+0.8125*H_C[27])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[10]*gamma_avg; 
  out[28] = (0.41250000000000003*H_L[28]+0.41250000000000003*H_C[28]+0.32475952641916456*H_L[25]-0.32475952641916456*H_C[25])*dv1*gamma_avg+0.24494897427831797*dHdv_surf_C[9]*gamma_avg; 
  out[29] = (-(1.1691342951089922*H_L[31])+1.6454482671904336*H_C[31]-0.8125*H_L[29]+0.8125*H_C[29])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[11]*gamma_avg; 
  out[30] = (0.41250000000000003*H_L[30]+0.41250000000000003*H_C[30]+0.32475952641916456*H_L[27]-0.32475952641916456*H_C[27])*dv1*gamma_avg+0.24494897427831797*dHdv_surf_C[10]*gamma_avg; 
  out[31] = (0.41250000000000003*H_L[31]+0.41250000000000003*H_C[31]+0.32475952641916456*H_L[29]-0.32475952641916456*H_C[29])*dv1*gamma_avg+0.24494897427831797*dHdv_surf_C[11]*gamma_avg; 
  out[32] = (-(1.1691342951089922*H_L[34])+1.6454482671904336*H_C[34]-0.8125*H_L[32]+0.8125*H_C[32])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[12]*gamma_avg; 
  out[33] = (-(1.1691342951089922*H_L[36])+1.6454482671904336*H_C[36]-0.8125*H_L[33]+0.8125*H_C[33])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[13]*gamma_avg; 
  out[34] = (0.41250000000000003*H_L[34]+0.41250000000000003*H_C[34]+0.32475952641916456*H_L[32]-0.32475952641916456*H_C[32])*dv1*gamma_avg+0.24494897427831797*dHdv_surf_C[12]*gamma_avg; 
  out[35] = (-(1.1691342951089922*H_L[38])+1.6454482671904336*H_C[38]-0.8125*H_L[35]+0.8125*H_C[35])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[14]*gamma_avg; 
  out[36] = (0.41250000000000003*H_L[36]+0.41250000000000003*H_C[36]+0.32475952641916456*H_L[33]-0.32475952641916456*H_C[33])*dv1*gamma_avg+0.24494897427831797*dHdv_surf_C[13]*gamma_avg; 
  out[37] = (-(1.1691342951089922*H_L[39])+1.6454482671904336*H_C[39]-0.8125*H_L[37]+0.8125*H_C[37])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[15]*gamma_avg; 
  out[38] = (0.41250000000000003*H_L[38]+0.41250000000000003*H_C[38]+0.32475952641916456*H_L[35]-0.32475952641916456*H_C[35])*dv1*gamma_avg+0.24494897427831797*dHdv_surf_C[14]*gamma_avg; 
  out[39] = (0.41250000000000003*H_L[39]+0.41250000000000003*H_C[39]+0.32475952641916456*H_L[37]-0.32475952641916456*H_C[37])*dv1*gamma_avg+0.24494897427831797*dHdv_surf_C[15]*gamma_avg; 

  out_surf[0] = -(0.03535533905932736*(53.665631459994955*H_L[16]-53.665631459994955*H_C[16]+95.26279441628824*H_L[2]+95.26279441628824*H_C[2]+75.0*H_L[0]-75.0*H_C[0])*dv1*gamma_avg); 
  out_surf[1] = -(0.03535533905932736*(53.66563145999495*H_L[17]-53.66563145999495*H_C[17]+95.26279441628824*H_L[5]+95.26279441628824*H_C[5]+75.0*H_L[1]-75.0*H_C[1])*dv1*gamma_avg); 
  out_surf[2] = -(0.03535533905932736*(53.66563145999495*H_L[18]-53.66563145999495*H_C[18]+95.26279441628824*H_L[7]+95.26279441628824*H_C[7]+75.0*H_L[3]-75.0*H_C[3])*dv1*gamma_avg); 
  out_surf[3] = -(0.03535533905932736*(53.66563145999495*H_L[19]-53.66563145999495*H_C[19]+95.26279441628824*H_L[9]+95.26279441628824*H_C[9]+75.0*H_L[4]-75.0*H_C[4])*dv1*gamma_avg); 
  out_surf[4] = -(0.03535533905932736*(53.665631459994955*H_L[20]-53.665631459994955*H_C[20]+95.26279441628824*H_L[11]+95.26279441628824*H_C[11]+75.0*H_L[6]-75.0*H_C[6])*dv1*gamma_avg); 
  out_surf[5] = -(0.03535533905932736*(53.665631459994955*H_L[21]-53.665631459994955*H_C[21]+95.26279441628824*H_L[12]+95.26279441628824*H_C[12]+75.0*H_L[8]-75.0*H_C[8])*dv1*gamma_avg); 
  out_surf[6] = -(0.03535533905932736*(53.665631459994955*H_L[22]-53.665631459994955*H_C[22]+95.26279441628824*H_L[14]+95.26279441628824*H_C[14]+75.0*H_L[10]-75.0*H_C[10])*dv1*gamma_avg); 
  out_surf[7] = -(0.03535533905932736*(53.66563145999495*H_L[23]-53.66563145999495*H_C[23]+95.26279441628824*H_L[15]+95.26279441628824*H_C[15]+75.0*H_L[13]-75.0*H_C[13])*dv1*gamma_avg); 
  out_surf[8] = -(0.03535533905932736*(95.26279441628826*H_L[26]+95.26279441628826*H_C[26]+75.0*H_L[24]-75.0*H_C[24])*dv1*gamma_avg); 
  out_surf[9] = -(0.03535533905932736*(95.26279441628826*H_L[28]+95.26279441628826*H_C[28]+75.0*H_L[25]-75.0*H_C[25])*dv1*gamma_avg); 
  out_surf[10] = -(0.03535533905932736*(95.26279441628826*H_L[30]+95.26279441628826*H_C[30]+75.0*H_L[27]-75.0*H_C[27])*dv1*gamma_avg); 
  out_surf[11] = -(0.03535533905932736*(95.26279441628826*H_L[31]+95.26279441628826*H_C[31]+75.0*H_L[29]-75.0*H_C[29])*dv1*gamma_avg); 
  out_surf[12] = -(0.03535533905932736*(95.26279441628826*H_L[34]+95.26279441628826*H_C[34]+75.0*H_L[32]-75.0*H_C[32])*dv1*gamma_avg); 
  out_surf[13] = -(0.03535533905932736*(95.26279441628826*H_L[36]+95.26279441628826*H_C[36]+75.0*H_L[33]-75.0*H_C[33])*dv1*gamma_avg); 
  out_surf[14] = -(0.03535533905932736*(95.26279441628826*H_L[38]+95.26279441628826*H_C[38]+75.0*H_L[35]-75.0*H_C[35])*dv1*gamma_avg); 
  out_surf[15] = -(0.03535533905932736*(95.26279441628826*H_L[39]+95.26279441628826*H_C[39]+75.0*H_L[37]-75.0*H_C[37])*dv1*gamma_avg); 
}

