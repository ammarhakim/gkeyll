#include <gkyl_fpo_vlasov_kernels.h> 

GKYL_CU_DH void fpo_drag_coeff_1x3v_vz_ser_p1_lovz(const double *dxv, const double *gamma, 
    const double* fpo_h_stencil[3], const double* fpo_dhdv_surf, double *drag_coeff, 
    double *drag_coeff_surf) {
  // dxv[NDIM]: Cell spacing in each direction. 
  // gamma: Scalar factor gamma. 
  // fpo_h_stencil[3]: 3 cell stencil of Rosenbluth potential H. 
  // fpo_dhdv_surf: Surface projection of dH/dv in center cell. 
  // drag_coeff: Output array for drag coefficient. 
  // drag_coeff_surf: Surface projection of drag coefficient at lower boundary.

  // Use cell-average value for gamma. 
  double gamma_avg = gamma[0]/sqrt(pow(2, 1)); 
  double dv1 = 2.0/dxv[3]; 

  const double* H_L = fpo_h_stencil[0]; 
  const double* H_C = fpo_h_stencil[1]; 
  const double* H_R = fpo_h_stencil[2]; 
  
  const double *dHdv_surf_C = &fpo_dhdv_surf[32]; 
  
  double *out = &drag_coeff[80]; 
  double *out_surf = &drag_coeff_surf[32]; 
  
  out[0] = (0.8441156615061707*H_R[32]-2.01805134969356*H_C[32]-1.1691342951089918*H_R[4]+1.6454482671904334*H_C[4]+0.8125*H_R[0]-0.8125*H_C[0])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[0]*gamma_avg; 
  out[1] = (0.8441156615061707*H_R[33]-2.0180513496935606*H_C[33]-1.1691342951089916*H_R[8]+1.6454482671904334*H_C[8]+0.8125*H_R[1]-0.8125*H_C[1])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[1]*gamma_avg; 
  out[2] = (0.8441156615061707*H_R[34]-2.0180513496935606*H_C[34]-1.1691342951089916*H_R[9]+1.6454482671904334*H_C[9]+0.8125*H_R[2]-0.8125*H_C[2])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[2]*gamma_avg; 
  out[3] = (0.8441156615061707*H_R[35]-2.0180513496935606*H_C[35]-1.1691342951089916*H_R[10]+1.6454482671904334*H_C[10]+0.8125*H_R[3]-0.8125*H_C[3])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[3]*gamma_avg; 
  out[4] = (0.232379000772445*H_R[32]+5.189797683917939*H_C[32]-0.41250000000000003*H_R[4]-0.41250000000000003*H_C[4]+0.32475952641916445*H_R[0]-0.32475952641916445*H_C[0])*dv1*gamma_avg-0.24494897427831794*dHdv_surf_C[0]*gamma_avg; 
  out[5] = (0.8441156615061707*H_R[36]-2.01805134969356*H_C[36]-1.1691342951089918*H_R[12]+1.6454482671904334*H_C[12]+0.8125*H_R[5]-0.8125*H_C[5])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[4]*gamma_avg; 
  out[6] = (0.8441156615061707*H_R[37]-2.01805134969356*H_C[37]-1.1691342951089918*H_R[13]+1.6454482671904334*H_C[13]+0.8125*H_R[6]-0.8125*H_C[6])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[5]*gamma_avg; 
  out[7] = (0.8441156615061707*H_R[38]-2.01805134969356*H_C[38]-1.1691342951089918*H_R[14]+1.6454482671904334*H_C[14]+0.8125*H_R[7]-0.8125*H_C[7])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[6]*gamma_avg; 
  out[8] = (0.232379000772445*H_R[33]+5.189797683917939*H_C[33]-0.41250000000000003*H_R[8]-0.41250000000000003*H_C[8]+0.32475952641916445*H_R[1]-0.32475952641916445*H_C[1])*dv1*gamma_avg-0.24494897427831794*dHdv_surf_C[1]*gamma_avg; 
  out[9] = (0.232379000772445*H_R[34]+5.189797683917939*H_C[34]-0.41250000000000003*H_R[9]-0.41250000000000003*H_C[9]+0.32475952641916445*H_R[2]-0.32475952641916445*H_C[2])*dv1*gamma_avg-0.24494897427831794*dHdv_surf_C[2]*gamma_avg; 
  out[10] = (0.232379000772445*H_R[35]+5.189797683917939*H_C[35]-0.41250000000000003*H_R[10]-0.41250000000000003*H_C[10]+0.32475952641916445*H_R[3]-0.32475952641916445*H_C[3])*dv1*gamma_avg-0.24494897427831794*dHdv_surf_C[3]*gamma_avg; 
  out[11] = (0.8441156615061707*H_R[39]-2.0180513496935606*H_C[39]-1.1691342951089916*H_R[15]+1.6454482671904334*H_C[15]+0.8125*H_R[11]-0.8125*H_C[11])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[7]*gamma_avg; 
  out[12] = (0.232379000772445*H_R[36]+5.189797683917939*H_C[36]-0.41250000000000003*H_R[12]-0.41250000000000003*H_C[12]+0.32475952641916445*H_R[5]-0.32475952641916445*H_C[5])*dv1*gamma_avg-0.24494897427831794*dHdv_surf_C[4]*gamma_avg; 
  out[13] = (0.232379000772445*H_R[37]+5.189797683917939*H_C[37]-0.41250000000000003*H_R[13]-0.41250000000000003*H_C[13]+0.32475952641916445*H_R[6]-0.32475952641916445*H_C[6])*dv1*gamma_avg-0.24494897427831794*dHdv_surf_C[5]*gamma_avg; 
  out[14] = (0.232379000772445*H_R[38]+5.189797683917939*H_C[38]-0.41250000000000003*H_R[14]-0.41250000000000003*H_C[14]+0.32475952641916445*H_R[7]-0.32475952641916445*H_C[7])*dv1*gamma_avg-0.24494897427831794*dHdv_surf_C[6]*gamma_avg; 
  out[15] = (0.232379000772445*H_R[39]+5.189797683917939*H_C[39]-0.41250000000000003*H_R[15]-0.41250000000000003*H_C[15]+0.32475952641916445*H_R[11]-0.32475952641916445*H_C[11])*dv1*gamma_avg-0.24494897427831794*dHdv_surf_C[7]*gamma_avg; 
  out[16] = (-(1.1691342951089922*H_R[19])+1.6454482671904336*H_C[19]+0.8125*H_R[16]-0.8125*H_C[16])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[8]*gamma_avg; 
  out[17] = (-(1.1691342951089922*H_R[21])+1.6454482671904336*H_C[21]+0.8125*H_R[17]-0.8125*H_C[17])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[9]*gamma_avg; 
  out[18] = (-(1.1691342951089922*H_R[22])+1.6454482671904336*H_C[22]+0.8125*H_R[18]-0.8125*H_C[18])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[10]*gamma_avg; 
  out[19] = (-(0.41250000000000003*H_R[19])-0.41250000000000003*H_C[19]+0.32475952641916456*H_R[16]-0.32475952641916456*H_C[16])*dv1*gamma_avg-0.24494897427831797*dHdv_surf_C[8]*gamma_avg; 
  out[20] = (-(1.1691342951089922*H_R[23])+1.6454482671904336*H_C[23]+0.8125*H_R[20]-0.8125*H_C[20])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[11]*gamma_avg; 
  out[21] = (-(0.41250000000000003*H_R[21])-0.41250000000000003*H_C[21]+0.32475952641916456*H_R[17]-0.32475952641916456*H_C[17])*dv1*gamma_avg-0.24494897427831797*dHdv_surf_C[9]*gamma_avg; 
  out[22] = (-(0.41250000000000003*H_R[22])-0.41250000000000003*H_C[22]+0.32475952641916456*H_R[18]-0.32475952641916456*H_C[18])*dv1*gamma_avg-0.24494897427831797*dHdv_surf_C[10]*gamma_avg; 
  out[23] = (-(0.41250000000000003*H_R[23])-0.41250000000000003*H_C[23]+0.32475952641916456*H_R[20]-0.32475952641916456*H_C[20])*dv1*gamma_avg-0.24494897427831797*dHdv_surf_C[11]*gamma_avg; 
  out[24] = (-(1.1691342951089922*H_R[27])+1.6454482671904336*H_C[27]+0.8125*H_R[24]-0.8125*H_C[24])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[12]*gamma_avg; 
  out[25] = (-(1.1691342951089922*H_R[29])+1.6454482671904336*H_C[29]+0.8125*H_R[25]-0.8125*H_C[25])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[13]*gamma_avg; 
  out[26] = (-(1.1691342951089922*H_R[30])+1.6454482671904336*H_C[30]+0.8125*H_R[26]-0.8125*H_C[26])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[14]*gamma_avg; 
  out[27] = (-(0.41250000000000003*H_R[27])-0.41250000000000003*H_C[27]+0.32475952641916456*H_R[24]-0.32475952641916456*H_C[24])*dv1*gamma_avg-0.24494897427831797*dHdv_surf_C[12]*gamma_avg; 
  out[28] = (-(1.1691342951089922*H_R[31])+1.6454482671904336*H_C[31]+0.8125*H_R[28]-0.8125*H_C[28])*dv1*gamma_avg+0.1414213562373096*dHdv_surf_C[15]*gamma_avg; 
  out[29] = (-(0.41250000000000003*H_R[29])-0.41250000000000003*H_C[29]+0.32475952641916456*H_R[25]-0.32475952641916456*H_C[25])*dv1*gamma_avg-0.24494897427831797*dHdv_surf_C[13]*gamma_avg; 
  out[30] = (-(0.41250000000000003*H_R[30])-0.41250000000000003*H_C[30]+0.32475952641916456*H_R[26]-0.32475952641916456*H_C[26])*dv1*gamma_avg-0.24494897427831797*dHdv_surf_C[14]*gamma_avg; 
  out[31] = (-(0.41250000000000003*H_R[31])-0.41250000000000003*H_C[31]+0.32475952641916456*H_R[28]-0.32475952641916456*H_C[28])*dv1*gamma_avg-0.24494897427831797*dHdv_surf_C[15]*gamma_avg; 
  out[32] = (1.8875000000000002*H_R[32]-4.5125*H_C[32]-2.6142637586900057*H_R[4]-4.066632513517788*H_C[4]+1.8168052317185797*H_R[0]-1.8168052317185797*H_C[0])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[0]*gamma_avg; 
  out[33] = (1.8875*H_R[33]-4.5125*H_C[33]-2.6142637586900066*H_R[8]-4.066632513517788*H_C[8]+1.816805231718579*H_R[1]-1.816805231718579*H_C[1])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[1]*gamma_avg; 
  out[34] = (1.8875*H_R[34]-4.5125*H_C[34]-2.6142637586900066*H_R[9]-4.066632513517788*H_C[9]+1.816805231718579*H_R[2]-1.816805231718579*H_C[2])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[2]*gamma_avg; 
  out[35] = (1.8875*H_R[35]-4.5125*H_C[35]-2.6142637586900066*H_R[10]-4.066632513517788*H_C[10]+1.816805231718579*H_R[3]-1.816805231718579*H_C[3])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[3]*gamma_avg; 
  out[36] = (1.8875000000000002*H_R[36]-4.5125*H_C[36]-2.6142637586900057*H_R[12]-4.066632513517788*H_C[12]+1.8168052317185797*H_R[5]-1.8168052317185797*H_C[5])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[4]*gamma_avg; 
  out[37] = (1.8875000000000002*H_R[37]-4.5125*H_C[37]-2.6142637586900057*H_R[13]-4.066632513517788*H_C[13]+1.8168052317185797*H_R[6]-1.8168052317185797*H_C[6])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[5]*gamma_avg; 
  out[38] = (1.8875000000000002*H_R[38]-4.5125*H_C[38]-2.6142637586900057*H_R[14]-4.066632513517788*H_C[14]+1.8168052317185797*H_R[7]-1.8168052317185797*H_C[7])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[6]*gamma_avg; 
  out[39] = (1.8875*H_R[39]-4.5125*H_C[39]-2.6142637586900066*H_R[15]-4.066632513517788*H_C[15]+1.816805231718579*H_R[11]-1.816805231718579*H_C[11])*dv1*gamma_avg+0.3162277660168381*dHdv_surf_C[7]*gamma_avg; 

  out_surf[0] = 0.0; 
  out_surf[1] = 0.0; 
  out_surf[2] = 0.0; 
  out_surf[3] = 0.0; 
  out_surf[4] = 0.0; 
  out_surf[5] = 0.0; 
  out_surf[6] = 0.0; 
  out_surf[7] = 0.0; 
  out_surf[8] = 0.0; 
  out_surf[9] = 0.0; 
  out_surf[10] = 0.0; 
  out_surf[11] = 0.0; 
  out_surf[12] = 0.0; 
  out_surf[13] = 0.0; 
  out_surf[14] = 0.0; 
  out_surf[15] = 0.0; 
}

